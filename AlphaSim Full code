rm(list = ls())

library(AlphaSimR)

#Define trait architecture parameters################################################################
Founders=2000 ; fabachr=6 ; segSites= fabasegSites= 1000
fabaQtl=300 ; minSnpFreq= fabaSnpFreq= 0.1 
a= 50 ; mean=b=0 ; c=0.3 ; d=0.1 ; e=0.3 
f=0.5 #A new variable for the residual error
#Define variable parameters################################################################
selection1=40 ; selectedSeeds1=50 ; fabaSelf1=0.25
number_of_simulations=100 ;set.seed(12345)
##################################################################################

#Simulate founder population and add trait
founderPop = runMacs(nInd=Founders,nChr=fabachr,segSites=fabasegSites,
                     inbred=FALSE) 
SP = SimParam$new(founderPop)
SP$restrSegSites(maxQtl = fabaQtl,  overlap = FALSE, minSnpFreq = fabaSnpFreq, force = FALSE)
SP$addTraitAG(nQtlPerChr=a, mean=b, var=c, varEnv=d, varGxE = e, gamma = TRUE, shape = 0.5)

######Scenario 1 for selection1 of 40 best plants in each cycle with 50 seeds per plant to GenAerate a pop of 2000 for the nexAt cyAcle#####

BasePop1=newPop(founderPop)
x= meanG(BasePop1)
y= genicVarG(BasePop1)
x
y
n = number_of_simulations
x=rep(0,n); y=rep(0,n)

xA1 = rep(0,n); yA1=rep(0,n)
xA2 = rep(0,n); yA2=rep(0,n)
xA3 = rep(0,n); yA3=rep(0,n)
xA4 = rep(0,n); yA4=rep(0,n)
xA5 = rep(0,n); yA5=rep(0,n)
xA6 = rep(0,n); yA6=rep(0,n)
xA7 = rep(0,n); yA7=rep(0,n)
xA8 = rep(0,n); yA8=rep(0,n)
xA9 = rep(0,n); yA9=rep(0,n)
xA10 = rep(0,n); yA10=rep(0,n)
xA11 = rep(0,n); yA11=rep(0,n)
xA12 = rep(0,n); yA12=rep(0,n)
xA13 = rep(0,n); yA13=rep(0,n)
xA14 = rep(0,n); yA14=rep(0,n)
xA15 = rep(0,n); yA15=rep(0,n)
xA16 = rep(0,n); yA16=rep(0,n)
xA17 = rep(0,n); yA17=rep(0,n)
xA18 = rep(0,n); yA18=rep(0,n)
xA19 = rep(0,n); yA19=rep(0,n)
xA20 = rep(0,n); yA20=rep(0,n)
xA21 = rep(0,n); yA21=rep(0,n)
xA22 = rep(0,n); yA22=rep(0,n)
xA23 = rep(0,n); yA23=rep(0,n)
xA24 = rep(0,n); yA24=rep(0,n)
xA25 = rep(0,n); yA25=rep(0,n)
xA26 = rep(0,n); yA26=rep(0,n)
xA27 = rep(0,n); yA27=rep(0,n)
xA28 = rep(0,n); yA28=rep(0,n)
xA29 = rep(0,n); yA29=rep(0,n)
xA30 = rep(0,n); yA30=rep(0,n)
for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA1 = selectOP(BasePop1,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA1[j]= meanG(GenA1)
  yA1[j]= genicVarG(GenA1)
  
  GenA1 = setPheno(GenA1, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA2 = selectOP(GenA1,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA2[j]= meanG(GenA2)
  yA2[j]= genicVarG(GenA2)
  
  GenA2 = setPheno(GenA2, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA3 = selectOP(GenA2,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA3[j]=meanG(GenA3)
  yA3[j]= genicVarG(GenA3)
  
  GenA3 = setPheno(GenA3, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA4 = selectOP(GenA3,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA4[j]=meanG(GenA4)
  yA4[j]= genicVarG(GenA4)
  
  GenA4 = setPheno(GenA4, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA5 = selectOP(GenA4,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA5[j]= meanG(GenA5)
  yA5[j]= genicVarG(GenA5)
  
  GenA5 = setPheno(GenA5, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA6 = selectOP(GenA5,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA6[j]= meanG(GenA6)
  yA6[j]= genicVarG(GenA6)
  
  GenA6 = setPheno(GenA6, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA7 = selectOP(GenA6,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA7[j]= meanG(GenA7)
  yA7[j]= genicVarG(GenA7)
  
  GenA7 = setPheno(GenA7, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA8 = selectOP(GenA7,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA8[j]= meanG(GenA8)
  yA8[j]= genicVarG(GenA8)
  
  GenA8 = setPheno(GenA8, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA9 = selectOP(GenA8,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA9[j]= meanG(GenA9)
  yA9[j]= genicVarG(GenA9)
  
  GenA9 = setPheno(GenA9, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA10 = selectOP(GenA9,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA10[j]= meanG(GenA10)
  yA10[j]= genicVarG(GenA10)
  
  GenA10 = setPheno(GenA10, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA11 = selectOP(GenA10,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA11[j]= meanG(GenA11)
  yA11[j]= genicVarG(GenA11)
  
  GenA11 = setPheno(GenA11, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA12 = selectOP(GenA11,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA12[j]= meanG(GenA12)
  yA12[j]= genicVarG(GenA12)
  
  GenA12 = setPheno(GenA12, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA13 = selectOP(GenA12,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA13[j]= meanG(GenA13)
  yA13[j]= genicVarG(GenA13)
  
  GenA13 = setPheno(GenA13, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA14 = selectOP(GenA13,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA14[j]= meanG(GenA14)
  yA14[j]= genicVarG(GenA14)
  
  GenA14 = setPheno(GenA14, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA15 = selectOP(GenA14,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA15[j]= meanG(GenA15)
  yA15[j]= genicVarG(GenA15)
  
  GenA15 = setPheno(GenA15, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA16 = selectOP(GenA15,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA16[j]= meanG(GenA16)
  yA16[j]= genicVarG(GenA16)
  
  GenA16 = setPheno(GenA16, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA17 = selectOP(GenA16,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA17[j]=meanG(GenA17)
  yA17[j]= genicVarG(GenA17)
  
  GenA17 = setPheno(GenA17, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA18 = selectOP(GenA17,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA18[j]= meanG(GenA18)
  yA18[j]= genicVarG(GenA18)
  
  GenA18 = setPheno(GenA18, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA19 = selectOP(GenA18,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA19[j]= meanG(GenA19)
  yA19[j]= genicVarG(GenA19)
  
  GenA19 = setPheno(GenA19, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA20 = selectOP(GenA19,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA20[j]= meanG(GenA20)
  yA20[j]= genicVarG(GenA20)
  
  GenA20 = setPheno(GenA20, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA21 = selectOP(GenA20,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA21[j]= meanG(GenA21)
  yA21[j]= genicVarG(GenA21)
  
  GenA21 = setPheno(GenA21, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA22 = selectOP(GenA21,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA22[j]= meanG(GenA22)
  yA22[j]= genicVarG(GenA22)
  
  GenA22 = setPheno(GenA22, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA23 = selectOP(GenA22,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA23[j]= meanG(GenA23)
  yA23[j]= genicVarG(GenA23)
  
  GenA23 = setPheno(GenA23, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA24 = selectOP(GenA23,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA24[j]= meanG(GenA24)
  yA24[j]= genicVarG(GenA24)
  
  GenA24 = setPheno(GenA24, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA25 = selectOP(GenA24,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA25[j]= meanG(GenA25)
  yA25[j]= genicVarG(GenA25)
  
  GenA25 = setPheno(GenA25, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA26 = selectOP(GenA25,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA26[j]= meanG(GenA26)
  yA26[j]= genicVarG(GenA26)
  
  GenA26 = setPheno(GenA26, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA27 = selectOP(GenA26,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA27[j]= meanG(GenA27)
  yA27[j]= genicVarG(GenA27)
  
  GenA27 = setPheno(GenA27, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA28 = selectOP(GenA27, nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA28[j]= meanG(GenA28)
  yA28[j]= genicVarG(GenA28)
  
  GenA28 = setPheno(GenA28, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA29 = selectOP(GenA28,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA29[j]= meanG(GenA29)
  yA29[j]= genicVarG(GenA29)
  
  GenA29 = setPheno(GenA29, varE=f, p=runif(1)) #Sets a phenotyApe using the GxAE model
  GenA30 = selectOP(GenA29,nInd=selection1,nSeeds=selectedSeeds1,probSelf=fabaSelf1,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xA30[j]= meanG(GenA30)
  yA30[j]= genicVarG(GenA30)
}

GGA1_S1=mean(xA1);GGA2_S1=mean(xA2);GGA3_S1=mean(xA3);GGA4_S1=mean(xA4);GGA5_S1=mean(xA5);GGA6_S1=mean(xA6);GGA7_S1=mean(xA7);GGA8_S1=mean(xA8);GGA9_S1=mean(xA9);GGA10_S1=mean(xA10)
GGA11_S1=mean(xA11);GGA12_S1=mean(xA12);GGA13_S1=mean(xA13);GGA14_S1=mean(xA14);GGA15_S1=mean(xA15);GGA16_S1=mean(xA16);GGA17_S1=mean(xA17);GGA18_S1=mean(xA18);GGA19_S1=mean(xA19);GGA20_S1=mean(xA20)
GGA21_S1=mean(xA21);GGA22_S1=mean(xA22);GGA23_S1=mean(xA23);GGA24_S1=mean(xA24);GGA25_S1=mean(xA25);GGA26_S1=mean(xA26);GGA27_S1=mean(xA27);GGA28_S1=mean(xA28);GGA29_S1=mean(xA29);GGA30_S1=mean(xA30)

GVA1_S1=mean(yA1);GVA2_S1=mean(yA2);GVA3_S1=mean(yA3);GVA4_S1=mean(yA4);GVA5_S1=mean(yA5);GVA6_S1=mean(yA6);GVA7_S1=mean(yA7);GVA8_S1=mean(yA8);GVA9_S1=mean(yA9);GVA10_S1=mean(yA10)
GVA11_S1=mean(yA11);GVA12_S1=mean(yA12);GVA13_S1=mean(yA13);GVA14_S1=mean(yA14);GVA15_S1=mean(yA15);GVA16_S1=mean(yA16);GVA17_S1=mean(yA17);GVA18_S1=mean(yA18);GVA19_S1=mean(yA19);GVA20_S1=mean(yA20)
GVA21_S1=mean(yA21);GVA22_S1=mean(yA22);GVA23_S1=mean(yA23);GVA24_S1=mean(yA24);GVA25_S1=mean(yA25);GVA26_S1=mean(yA26);GVA27_S1=mean(yA27);GVA28_S1=mean(yA28);GVA29_S1=mean(yA29);GVA30_S1=mean(yA30)



Genetic_gain_S1<-c(GGA1_S1,GGA2_S1,GGA3_S1,GGA4_S1,GGA5_S1,GGA6_S1,GGA7_S1,GGA8_S1,GGA9_S1,GGA10_S1,GGA11_S1,GGA12_S1,GGA13_S1,GGA14_S1,GGA15_S1,GGA16_S1,GGA17_S1,GGA18_S1,GGA19_S1,GGA20_S1,GGA21_S1,GGA22_S1,GGA23_S1,GGA24_S1,GGA25_S1,GGA26_S1,GGA27_S1,GGA28_S1,GGA29_S1,GGA30_S1)
Genetic_variation_S1<-c(GVA1_S1,GVA2_S1,GVA3_S1,GVA4_S1,GVA5_S1,GVA6_S1,GVA7_S1,GVA8_S1,GVA9_S1,GVA10_S1,GVA11_S1,GVA12_S1,GVA13_S1,GVA14_S1,GVA15_S1,GVA16_S1,GVA17_S1,GVA18_S1,GVA19_S1,GVA20_S1,GVA21_S1,GVA22_S1,GVA23_S1,GVA24_S1,GVA25_S1,GVA26_S1,GVA27_S1,GVA28_S1,GVA29_S1,GVA30_S1)
par(mfrow=c(2,1))
plot(Genetic_gain_S1,main="scenario 1",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S1)
plot(Genetic_variation_S1,main="scenario 1",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S1)
library(lattice)
Scenario1<-c(Genetic_gain_S1,Genetic_variation_S1)
write.csv(Scenario1,"Scenario1.csv")
xA_Scenario1<-data.frame(xA1,xA2,xA3,xA4,xA5,xA6,xA7,xA8,xA9,xA10,xA11,xA12,xA13,xA14,xA15,xA16,xA17,xA18,xA19,xA20,xA21,xA22,xA23,xA24,xA25,xA26,xA27,xA28,xA29,xA30)
write.csv(xA_Scenario1,"xA_scenario1.csv")
yA_Scenario1<-data.frame(yA1,yA2,yA3,yA4,yA5,yA6,yA7,yA8,yA9,yA10,yA11,yA12,yA13,yA14,yA15,yA16,yA17,yA18,yA19,yA20,yA21,yA22,yA23,yA24,yA25,yA26,yA27,yA28,yA29,yA30)
write.csv(yA_Scenario1,"yA_scenario1.csv")


######Scenario 2 for selection of 80 best plants in each cycle with 25 seeds per plant to generate a pop of 2000 for the next cycle#####
#Define variable parameters################################################################
selection2=80 ; selectedSeeds2=25 ; fabaSelf2=0.25

xB1 = rep(0,n); yB1=rep(0,n)
xB2 = rep(0,n); yB2=rep(0,n)
xB3 = rep(0,n); yB3=rep(0,n)
xB4 = rep(0,n); yB4=rep(0,n)
xB5 = rep(0,n); yB5=rep(0,n)
xB6 = rep(0,n); yB6=rep(0,n)
xB7 = rep(0,n); yB7=rep(0,n)
xB8 = rep(0,n); yB8=rep(0,n)
xB9 = rep(0,n); yB9=rep(0,n)
xB10 = rep(0,n); yB10=rep(0,n)
xB11 = rep(0,n); yB11=rep(0,n)
xB12 = rep(0,n); yB12=rep(0,n)
xB13 = rep(0,n); yB13=rep(0,n)
xB14 = rep(0,n); yB14=rep(0,n)
xB15 = rep(0,n); yB15=rep(0,n)
xB16 = rep(0,n); yB16=rep(0,n)
xB17 = rep(0,n); yB17=rep(0,n)
xB18 = rep(0,n); yB18=rep(0,n)
xB19 = rep(0,n); yB19=rep(0,n)
xB20 = rep(0,n); yB20=rep(0,n)
xB21 = rep(0,n); yB21=rep(0,n)
xB22 = rep(0,n); yB22=rep(0,n)
xB23 = rep(0,n); yB23=rep(0,n)
xB24 = rep(0,n); yB24=rep(0,n)
xB25 = rep(0,n); yB25=rep(0,n)
xB26 = rep(0,n); yB26=rep(0,n)
xB27 = rep(0,n); yB27=rep(0,n)
xB28 = rep(0,n); yB28=rep(0,n)
xB29 = rep(0,n); yB29=rep(0,n)
xB30 = rep(0,n); yB30=rep(0,n)
for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB1 = selectOP(BasePop1,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB1[j]= meanG(GenB1)
  yB1[j]= genicVarG(GenB1)
  
  GenB1 = setPheno(GenB1, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB2 = selectOP(GenB1,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB2[j]= meanG(GenB2)
  yB2[j]= genicVarG(GenB2)
  
  GenB2 = setPheno(GenB2, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB3 = selectOP(GenB2,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB3[j]=meanG(GenB3)
  yB3[j]= genicVarG(GenB3)
  
  GenB3 = setPheno(GenB3, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB4 = selectOP(GenB3,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB4[j]=meanG(GenB4)
  yB4[j]= genicVarG(GenB4)
  
  GenB4 = setPheno(GenB4, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB5 = selectOP(GenB4,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB5[j]= meanG(GenB5)
  yB5[j]= genicVarG(GenB5)
  
  GenB5 = setPheno(GenB5, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB6 = selectOP(GenB5,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB6[j]= meanG(GenB6)
  yB6[j]= genicVarG(GenB6)
  
  GenB6 = setPheno(GenB6, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB7 = selectOP(GenB6,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB7[j]= meanG(GenB7)
  yB7[j]= genicVarG(GenB7)
  
  GenB7 = setPheno(GenB7, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB8 = selectOP(GenB7,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB8[j]= meanG(GenB8)
  yB8[j]= genicVarG(GenB8)
  
  GenB8 = setPheno(GenB8, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB9 = selectOP(GenB8,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB9[j]= meanG(GenB9)
  yB9[j]= genicVarG(GenB9)
  
  GenB9 = setPheno(GenB9, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB10 = selectOP(GenB9,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB10[j]= meanG(GenB10)
  yB10[j]= genicVarG(GenB10)
  
  GenB10 = setPheno(GenB10, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB11 = selectOP(GenB10,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB11[j]= meanG(GenB11)
  yB11[j]= genicVarG(GenB11)
  
  GenB11 = setPheno(GenB11, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB12 = selectOP(GenB11,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB12[j]= meanG(GenB12)
  yB12[j]= genicVarG(GenB12)
  
  GenB12 = setPheno(GenB12, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB13 = selectOP(GenB12,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB13[j]= meanG(GenB13)
  yB13[j]= genicVarG(GenB13)
  
  GenB13 = setPheno(GenB13, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB14 = selectOP(GenB13,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB14[j]= meanG(GenB14)
  yB14[j]= genicVarG(GenB14)
  
  GenB14 = setPheno(GenB14, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB15 = selectOP(GenB14,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB15[j]= meanG(GenB15)
  yB15[j]= genicVarG(GenB15)
  
  GenB15 = setPheno(GenB15, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB16 = selectOP(GenB15,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB16[j]= meanG(GenB16)
  yB16[j]= genicVarG(GenB16)
  
  GenB16 = setPheno(GenB16, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB17 = selectOP(GenB16,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB17[j]=meanG(GenB17)
  yB17[j]= genicVarG(GenB17)
  
  GenB17 = setPheno(GenB17, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB18 = selectOP(GenB17,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB18[j]= meanG(GenB18)
  yB18[j]= genicVarG(GenB18)
  
  GenB18 = setPheno(GenB18, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB19 = selectOP(GenB18,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB19[j]= meanG(GenB19)
  yB19[j]= genicVarG(GenB19)
  
  GenB19 = setPheno(GenB19, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB20 = selectOP(GenB19,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB20[j]= meanG(GenB20)
  yB20[j]= genicVarG(GenB20)
  
  GenB20 = setPheno(GenB20, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB21 = selectOP(GenB20,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB21[j]= meanG(GenB21)
  yB21[j]= genicVarG(GenB21)
  
  GenB21 = setPheno(GenB21, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB22 = selectOP(GenB21,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB22[j]= meanG(GenB22)
  yB22[j]= genicVarG(GenB22)
  
  GenB22 = setPheno(GenB22, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB23 = selectOP(GenB22,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB23[j]= meanG(GenB23)
  yB23[j]= genicVarG(GenB23)
  
  GenB23 = setPheno(GenB23, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB24 = selectOP(GenB23,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB24[j]= meanG(GenB24)
  yB24[j]= genicVarG(GenB24)
  
  GenB24 = setPheno(GenB24, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB25 = selectOP(GenB24,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB25[j]= meanG(GenB25)
  yB25[j]= genicVarG(GenB25)
  
  GenB25 = setPheno(GenB25, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB26 = selectOP(GenB25,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB26[j]= meanG(GenB26)
  yB26[j]= genicVarG(GenB26)
  
  GenB26 = setPheno(GenB26, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB27 = selectOP(GenB26,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB27[j]= meanG(GenB27)
  yB27[j]= genicVarG(GenB27)
  
  GenB27 = setPheno(GenB27, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB28 = selectOP(GenB27, nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB28[j]= meanG(GenB28)
  yB28[j]= genicVarG(GenB28)
  
  GenB28 = setPheno(GenB28, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB29 = selectOP(GenB28,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB29[j]= meanG(GenB29)
  yB29[j]= genicVarG(GenB29)
  
  GenB29 = setPheno(GenB29, varE=f, p=runif(1)) #Sets a phenotyBpe using the GxBE model
  GenB30 = selectOP(GenB29,nInd=selection2,nSeeds=selectedSeeds2,probSelf=fabaSelf2,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xB30[j]= meanG(GenB30)
  yB30[j]= genicVarG(GenB30)
}

GGB1_S2=mean(xB1);GGB2_S2=mean(xB2);GGB3_S2=mean(xB3);GGB4_S2=mean(xB4);GGB5_S2=mean(xB5);GGB6_S2=mean(xB6);GGB7_S2=mean(xB7);GGB8_S2=mean(xB8);GGB9_S2=mean(xB9);GGB10_S2=mean(xB10)
GGB11_S2=mean(xB11);GGB12_S2=mean(xB12);GGB13_S2=mean(xB13);GGB14_S2=mean(xB14);GGB15_S2=mean(xB15);GGB16_S2=mean(xB16);GGB17_S2=mean(xB17);GGB18_S2=mean(xB18);GGB19_S2=mean(xB19);GGB20_S2=mean(xB20)
GGB21_S2=mean(xB21);GGB22_S2=mean(xB22);GGB23_S2=mean(xB23);GGB24_S2=mean(xB24);GGB25_S2=mean(xB25);GGB26_S2=mean(xB26);GGB27_S2=mean(xB27);GGB28_S2=mean(xB28);GGB29_S2=mean(xB29);GGB30_S2=mean(xB30)

GVB1_S2=mean(yB1);GVB2_S2=mean(yB2);GVB3_S2=mean(yB3);GVB4_S2=mean(yB4);GVB5_S2=mean(yB5);GVB6_S2=mean(yB6);GVB7_S2=mean(yB7);GVB8_S2=mean(yB8);GVB9_S2=mean(yB9);GVB10_S2=mean(yB10)
GVB11_S2=mean(yB11);GVB12_S2=mean(yB12);GVB13_S2=mean(yB13);GVB14_S2=mean(yB14);GVB15_S2=mean(yB15);GVB16_S2=mean(yB16);GVB17_S2=mean(yB17);GVB18_S2=mean(yB18);GVB19_S2=mean(yB19);GVB20_S2=mean(yB20)
GVB21_S2=mean(yB21);GVB22_S2=mean(yB22);GVB23_S2=mean(yB23);GVB24_S2=mean(yB24);GVB25_S2=mean(yB25);GVB26_S2=mean(yB26);GVB27_S2=mean(yB27);GVB28_S2=mean(yB28);GVB29_S2=mean(yB29);GVB30_S2=mean(yB30)



Genetic_gain_S2<-c(GGB1_S2,GGB2_S2,GGB3_S2,GGB4_S2,GGB5_S2,GGB6_S2,GGB7_S2,GGB8_S2,GGB9_S2,GGB10_S2,GGB11_S2,GGB12_S2,GGB13_S2,GGB14_S2,GGB15_S2,GGB16_S2,GGB17_S2,GGB18_S2,GGB19_S2,GGB20_S2,GGB21_S2,GGB22_S2,GGB23_S2,GGB24_S2,GGB25_S2,GGB26_S2,GGB27_S2,GGB28_S2,GGB29_S2,GGB30_S2)
Genetic_variation_S2<-c(GVB1_S2,GVB2_S2,GVB3_S2,GVB4_S2,GVB5_S2,GVB6_S2,GVB7_S2,GVB8_S2,GVB9_S2,GVB10_S2,GVB11_S2,GVB12_S2,GVB13_S2,GVB14_S2,GVB15_S2,GVB16_S2,GVB17_S2,GVB18_S2,GVB19_S2,GVB20_S2,GVB21_S2,GVB22_S2,GVB23_S2,GVB24_S2,GVB25_S2,GVB26_S2,GVB27_S2,GVB28_S2,GVB29_S2,GVB30_S2)
par(mfrow=c(2,1))
plot(Genetic_gain_S2,main="scenario 2",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S2)
plot(Genetic_variation_S2,main="scenario 2",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S2)
library(lattice)
Scenario2<-c(Genetic_gain_S2,Genetic_variation_S2)
write.csv(Scenario2,"Scenario2.csv")
xB_Scenario2<-data.frame(xB1,xB2,xB3,xB4,xB5,xB6,xB7,xB8,xB9,xB10,xB11,xB12,xB13,xB14,xB15,xB16,xB17,xB18,xB19,xB20,xB21,xB22,xB23,xB24,xB25,xB26,xB27,xB28,xB29,xB30)
write.csv(xB_Scenario2,"xB_scenario2.csv")
yB_Scenario2<-data.frame(yB1,yB2,yB3,yB4,yB5,yB6,yB7,yB8,yB9,yB10,yB11,yB12,yB13,yB14,yB15,yB16,yB17,yB18,yB19,yB20,yB21,yB22,yB23,yB24,yB25,yB26,yB27,yB28,yB29,yB30)
write.csv(yB_Scenario2,"yB_scenario2.csv")

######Scenario 3 for selection of 200 best plants in each cycle with 10 seeds per plant to generate a pop of 2000 for the next cycle#####
selection3=200 ; selectedSeeds3=10 ; fabaSelf3=0.25

xC1 = rep(0,n); yC1=rep(0,n)
xC2 = rep(0,n); yC2=rep(0,n)
xC3 = rep(0,n); yC3=rep(0,n)
xC4 = rep(0,n); yC4=rep(0,n)
xC5 = rep(0,n); yC5=rep(0,n)
xC6 = rep(0,n); yC6=rep(0,n)
xC7 = rep(0,n); yC7=rep(0,n)
xC8 = rep(0,n); yC8=rep(0,n)
xC9 = rep(0,n); yC9=rep(0,n)
xC10 = rep(0,n); yC10=rep(0,n)
xC11 = rep(0,n); yC11=rep(0,n)
xC12 = rep(0,n); yC12=rep(0,n)
xC13 = rep(0,n); yC13=rep(0,n)
xC14 = rep(0,n); yC14=rep(0,n)
xC15 = rep(0,n); yC15=rep(0,n)
xC16 = rep(0,n); yC16=rep(0,n)
xC17 = rep(0,n); yC17=rep(0,n)
xC18 = rep(0,n); yC18=rep(0,n)
xC19 = rep(0,n); yC19=rep(0,n)
xC20 = rep(0,n); yC20=rep(0,n)
xC21 = rep(0,n); yC21=rep(0,n)
xC22 = rep(0,n); yC22=rep(0,n)
xC23 = rep(0,n); yC23=rep(0,n)
xC24 = rep(0,n); yC24=rep(0,n)
xC25 = rep(0,n); yC25=rep(0,n)
xC26 = rep(0,n); yC26=rep(0,n)
xC27 = rep(0,n); yC27=rep(0,n)
xC28 = rep(0,n); yC28=rep(0,n)
xC29 = rep(0,n); yC29=rep(0,n)
xC30 = rep(0,n); yC30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC1 = selectOP(BasePop1,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC1[j]= meanG(GenC1)
  yC1[j]= genicVarG(GenC1)
  
  GenC1 = setPheno(GenC1, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC2 = selectOP(GenC1,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC2[j]= meanG(GenC2)
  yC2[j]= genicVarG(GenC2)
  
  GenC2 = setPheno(GenC2, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC3 = selectOP(GenC2,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC3[j]=meanG(GenC3)
  yC3[j]= genicVarG(GenC3)
  
  GenC3 = setPheno(GenC3, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC4 = selectOP(GenC3,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC4[j]=meanG(GenC4)
  yC4[j]= genicVarG(GenC4)
  
  GenC4 = setPheno(GenC4, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC5 = selectOP(GenC4,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC5[j]= meanG(GenC5)
  yC5[j]= genicVarG(GenC5)
  
  GenC5 = setPheno(GenC5, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC6 = selectOP(GenC5,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC6[j]= meanG(GenC6)
  yC6[j]= genicVarG(GenC6)
  
  GenC6 = setPheno(GenC6, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC7 = selectOP(GenC6,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC7[j]= meanG(GenC7)
  yC7[j]= genicVarG(GenC7)
  
  GenC7 = setPheno(GenC7, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC8 = selectOP(GenC7,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC8[j]= meanG(GenC8)
  yC8[j]= genicVarG(GenC8)
  
  GenC8 = setPheno(GenC8, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC9 = selectOP(GenC8,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC9[j]= meanG(GenC9)
  yC9[j]= genicVarG(GenC9)
  
  GenC9 = setPheno(GenC9, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC10 = selectOP(GenC9,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC10[j]= meanG(GenC10)
  yC10[j]= genicVarG(GenC10)
  
  GenC10 = setPheno(GenC10, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC11 = selectOP(GenC10,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC11[j]= meanG(GenC11)
  yC11[j]= genicVarG(GenC11)
  
  GenC11 = setPheno(GenC11, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC12 = selectOP(GenC11,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC12[j]= meanG(GenC12)
  yC12[j]= genicVarG(GenC12)
  
  GenC12 = setPheno(GenC12, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC13 = selectOP(GenC12,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC13[j]= meanG(GenC13)
  yC13[j]= genicVarG(GenC13)
  
  GenC13 = setPheno(GenC13, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC14 = selectOP(GenC13,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC14[j]= meanG(GenC14)
  yC14[j]= genicVarG(GenC14)
  
  GenC14 = setPheno(GenC14, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC15 = selectOP(GenC14,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC15[j]= meanG(GenC15)
  yC15[j]= genicVarG(GenC15)
  
  GenC15 = setPheno(GenC15, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC16 = selectOP(GenC15,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC16[j]= meanG(GenC16)
  yC16[j]= genicVarG(GenC16)
  
  GenC16 = setPheno(GenC16, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC17 = selectOP(GenC16,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC17[j]=meanG(GenC17)
  yC17[j]= genicVarG(GenC17)
  
  GenC17 = setPheno(GenC17, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC18 = selectOP(GenC17,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC18[j]= meanG(GenC18)
  yC18[j]= genicVarG(GenC18)
  
  GenC18 = setPheno(GenC18, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC19 = selectOP(GenC18,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC19[j]= meanG(GenC19)
  yC19[j]= genicVarG(GenC19)
  
  GenC19 = setPheno(GenC19, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC20 = selectOP(GenC19,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC20[j]= meanG(GenC20)
  yC20[j]= genicVarG(GenC20)
  
  GenC20 = setPheno(GenC20, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC21 = selectOP(GenC20,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC21[j]= meanG(GenC21)
  yC21[j]= genicVarG(GenC21)
  
  GenC21 = setPheno(GenC21, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC22 = selectOP(GenC21,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC22[j]= meanG(GenC22)
  yC22[j]= genicVarG(GenC22)
  
  GenC22 = setPheno(GenC22, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC23 = selectOP(GenC22,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC23[j]= meanG(GenC23)
  yC23[j]= genicVarG(GenC23)
  
  GenC23 = setPheno(GenC23, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC24 = selectOP(GenC23,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC24[j]= meanG(GenC24)
  yC24[j]= genicVarG(GenC24)
  
  GenC24 = setPheno(GenC24, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC25 = selectOP(GenC24,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC25[j]= meanG(GenC25)
  yC25[j]= genicVarG(GenC25)
  
  GenC25 = setPheno(GenC25, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC26 = selectOP(GenC25,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC26[j]= meanG(GenC26)
  yC26[j]= genicVarG(GenC26)
  
  GenC26 = setPheno(GenC26, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC27 = selectOP(GenC26,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC27[j]= meanG(GenC27)
  yC27[j]= genicVarG(GenC27)
  
  GenC27 = setPheno(GenC27, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC28 = selectOP(GenC27, nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC28[j]= meanG(GenC28)
  yC28[j]= genicVarG(GenC28)
  
  GenC28 = setPheno(GenC28, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC29 = selectOP(GenC28,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC29[j]= meanG(GenC29)
  yC29[j]= genicVarG(GenC29)
  
  GenC29 = setPheno(GenC29, varE=f, p=runif(1)) #Sets a phenotyCpe using the GxCE model
  GenC30 = selectOP(GenC29,nInd=selection3,nSeeds=selectedSeeds3,probSelf=fabaSelf3,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xC30[j]= meanG(GenC30)
  yC30[j]= genicVarG(GenC30)
}

GGC1_S3=mean(xC1);GGC2_S3=mean(xC2);GGC3_S3=mean(xC3);GGC4_S3=mean(xC4);GGC5_S3=mean(xC5);GGC6_S3=mean(xC6);GGC7_S3=mean(xC7);GGC8_S3=mean(xC8);GGC9_S3=mean(xC9);GGC10_S3=mean(xC10)
GGC11_S3=mean(xC11);GGC12_S3=mean(xC12);GGC13_S3=mean(xC13);GGC14_S3=mean(xC14);GGC15_S3=mean(xC15);GGC16_S3=mean(xC16);GGC17_S3=mean(xC17);GGC18_S3=mean(xC18);GGC19_S3=mean(xC19);GGC20_S3=mean(xC20)
GGC21_S3=mean(xC21);GGC22_S3=mean(xC22);GGC23_S3=mean(xC23);GGC24_S3=mean(xC24);GGC25_S3=mean(xC25);GGC26_S3=mean(xC26);GGC27_S3=mean(xC27);GGC28_S3=mean(xC28);GGC29_S3=mean(xC29);GGC30_S3=mean(xC30)

GVC1_S3=mean(yC1);GVC2_S3=mean(yC2);GVC3_S3=mean(yC3);GVC4_S3=mean(yC4);GVC5_S3=mean(yC5);GVC6_S3=mean(yC6);GVC7_S3=mean(yC7);GVC8_S3=mean(yC8);GVC9_S3=mean(yC9);GVC10_S3=mean(yC10)
GVC11_S3=mean(yC11);GVC12_S3=mean(yC12);GVC13_S3=mean(yC13);GVC14_S3=mean(yC14);GVC15_S3=mean(yC15);GVC16_S3=mean(yC16);GVC17_S3=mean(yC17);GVC18_S3=mean(yC18);GVC19_S3=mean(yC19);GVC20_S3=mean(yC20)
GVC21_S3=mean(yC21);GVC22_S3=mean(yC22);GVC23_S3=mean(yC23);GVC24_S3=mean(yC24);GVC25_S3=mean(yC25);GVC26_S3=mean(yC26);GVC27_S3=mean(yC27);GVC28_S3=mean(yC28);GVC29_S3=mean(yC29);GVC30_S3=mean(yC30)



Genetic_gain_S3<-c(GGC1_S3,GGC2_S3,GGC3_S3,GGC4_S3,GGC5_S3,GGC6_S3,GGC7_S3,GGC8_S3,GGC9_S3,GGC10_S3,GGC11_S3,GGC12_S3,GGC13_S3,GGC14_S3,GGC15_S3,GGC16_S3,GGC17_S3,GGC18_S3,GGC19_S3,GGC20_S3,GGC21_S3,GGC22_S3,GGC23_S3,GGC24_S3,GGC25_S3,GGC26_S3,GGC27_S3,GGC28_S3,GGC29_S3,GGC30_S3)
Genetic_variation_S3<-c(GVC1_S3,GVC2_S3,GVC3_S3,GVC4_S3,GVC5_S3,GVC6_S3,GVC7_S3,GVC8_S3,GVC9_S3,GVC10_S3,GVC11_S3,GVC12_S3,GVC13_S3,GVC14_S3,GVC15_S3,GVC16_S3,GVC17_S3,GVC18_S3,GVC19_S3,GVC20_S3,GVC21_S3,GVC22_S3,GVC23_S3,GVC24_S3,GVC25_S3,GVC26_S3,GVC27_S3,GVC28_S3,GVC29_S3,GVC30_S3)
par(mfrow=c(2,1))
plot(Genetic_gain_S3,main="scenario 3",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S3)
plot(Genetic_variation_S3,main="scenario 3",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S3)
library(lattice)
Scenario3<-c(Genetic_gain_S3,Genetic_variation_S3)
write.csv(Scenario3,"Scenario3.csv")
xC_Scenario3<-data.frame(xC1,xC2,xC3,xC4,xC5,xC6,xC7,xC8,xC9,xC10,xC11,xC12,xC13,xC14,xC15,xC16,xC17,xC18,xC19,xC20,xC21,xC22,xC23,xC24,xC25,xC26,xC27,xC28,xC29,xC30)
write.csv(xC_Scenario3,"xC_scenario3.csv")
yC_Scenario3<-data.frame(yC1,yC2,yC3,yC4,yC5,yC6,yC7,yC8,yC9,yC10,yC11,yC12,yC13,yC14,yC15,yC16,yC17,yC18,yC19,yC20,yC21,yC22,yC23,yC24,yC25,yC26,yC27,yC28,yC29,yC30)
write.csv(yC_Scenario3,"yC_scenario3.csv")

######Scenario 4 for selection of 200 best plants in each cycle with 50 seeds per plant to generate a pop of 10000 for the next cycle#####
selection4=200 ; selectedSeeds4=50 ; fabaSelf4=0.25

xD1 = rep(0,n); yD1=rep(0,n)
xD2 = rep(0,n); yD2=rep(0,n)
xD3 = rep(0,n); yD3=rep(0,n)
xD4 = rep(0,n); yD4=rep(0,n)
xD5 = rep(0,n); yD5=rep(0,n)
xD6 = rep(0,n); yD6=rep(0,n)
xD7 = rep(0,n); yD7=rep(0,n)
xD8 = rep(0,n); yD8=rep(0,n)
xD9 = rep(0,n); yD9=rep(0,n)
xD10 = rep(0,n); yD10=rep(0,n)
xD11 = rep(0,n); yD11=rep(0,n)
xD12 = rep(0,n); yD12=rep(0,n)
xD13 = rep(0,n); yD13=rep(0,n)
xD14 = rep(0,n); yD14=rep(0,n)
xD15 = rep(0,n); yD15=rep(0,n)
xD16 = rep(0,n); yD16=rep(0,n)
xD17 = rep(0,n); yD17=rep(0,n)
xD18 = rep(0,n); yD18=rep(0,n)
xD19 = rep(0,n); yD19=rep(0,n)
xD20 = rep(0,n); yD20=rep(0,n)
xD21 = rep(0,n); yD21=rep(0,n)
xD22 = rep(0,n); yD22=rep(0,n)
xD23 = rep(0,n); yD23=rep(0,n)
xD24 = rep(0,n); yD24=rep(0,n)
xD25 = rep(0,n); yD25=rep(0,n)
xD26 = rep(0,n); yD26=rep(0,n)
xD27 = rep(0,n); yD27=rep(0,n)
xD28 = rep(0,n); yD28=rep(0,n)
xD29 = rep(0,n); yD29=rep(0,n)
xD30 = rep(0,n); yD30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD1 = selectOP(BasePop1,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD1[j]= meanG(GenD1)
  yD1[j]= genicVarG(GenD1)
  
  GenD1 = setPheno(GenD1, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD2 = selectOP(GenD1,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD2[j]= meanG(GenD2)
  yD2[j]= genicVarG(GenD2)
  
  GenD2 = setPheno(GenD2, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD3 = selectOP(GenD2,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD3[j]=meanG(GenD3)
  yD3[j]= genicVarG(GenD3)
  
  GenD3 = setPheno(GenD3, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD4 = selectOP(GenD3,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD4[j]=meanG(GenD4)
  yD4[j]= genicVarG(GenD4)
  
  GenD4 = setPheno(GenD4, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD5 = selectOP(GenD4,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD5[j]= meanG(GenD5)
  yD5[j]= genicVarG(GenD5)
  
  GenD5 = setPheno(GenD5, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD6 = selectOP(GenD5,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD6[j]= meanG(GenD6)
  yD6[j]= genicVarG(GenD6)
  
  GenD6 = setPheno(GenD6, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD7 = selectOP(GenD6,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD7[j]= meanG(GenD7)
  yD7[j]= genicVarG(GenD7)
  
  GenD7 = setPheno(GenD7, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD8 = selectOP(GenD7,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD8[j]= meanG(GenD8)
  yD8[j]= genicVarG(GenD8)
  
  GenD8 = setPheno(GenD8, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD9 = selectOP(GenD8,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD9[j]= meanG(GenD9)
  yD9[j]= genicVarG(GenD9)
  
  GenD9 = setPheno(GenD9, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD10 = selectOP(GenD9,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD10[j]= meanG(GenD10)
  yD10[j]= genicVarG(GenD10)
  
  GenD10 = setPheno(GenD10, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD11 = selectOP(GenD10,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD11[j]= meanG(GenD11)
  yD11[j]= genicVarG(GenD11)
  
  GenD11 = setPheno(GenD11, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD12 = selectOP(GenD11,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD12[j]= meanG(GenD12)
  yD12[j]= genicVarG(GenD12)
  
  GenD12 = setPheno(GenD12, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD13 = selectOP(GenD12,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD13[j]= meanG(GenD13)
  yD13[j]= genicVarG(GenD13)
  
  GenD13 = setPheno(GenD13, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD14 = selectOP(GenD13,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD14[j]= meanG(GenD14)
  yD14[j]= genicVarG(GenD14)
  
  GenD14 = setPheno(GenD14, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD15 = selectOP(GenD14,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD15[j]= meanG(GenD15)
  yD15[j]= genicVarG(GenD15)
  
  GenD15 = setPheno(GenD15, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD16 = selectOP(GenD15,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD16[j]= meanG(GenD16)
  yD16[j]= genicVarG(GenD16)
  
  GenD16 = setPheno(GenD16, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD17 = selectOP(GenD16,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD17[j]=meanG(GenD17)
  yD17[j]= genicVarG(GenD17)
  
  GenD17 = setPheno(GenD17, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD18 = selectOP(GenD17,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD18[j]= meanG(GenD18)
  yD18[j]= genicVarG(GenD18)
  
  GenD18 = setPheno(GenD18, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD19 = selectOP(GenD18,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD19[j]= meanG(GenD19)
  yD19[j]= genicVarG(GenD19)
  
  GenD19 = setPheno(GenD19, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD20 = selectOP(GenD19,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD20[j]= meanG(GenD20)
  yD20[j]= genicVarG(GenD20)
  
  GenD20 = setPheno(GenD20, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD21 = selectOP(GenD20,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD21[j]= meanG(GenD21)
  yD21[j]= genicVarG(GenD21)
  
  GenD21 = setPheno(GenD21, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD22 = selectOP(GenD21,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD22[j]= meanG(GenD22)
  yD22[j]= genicVarG(GenD22)
  
  GenD22 = setPheno(GenD22, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD23 = selectOP(GenD22,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD23[j]= meanG(GenD23)
  yD23[j]= genicVarG(GenD23)
  
  GenD23 = setPheno(GenD23, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD24 = selectOP(GenD23,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD24[j]= meanG(GenD24)
  yD24[j]= genicVarG(GenD24)
  
  GenD24 = setPheno(GenD24, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD25 = selectOP(GenD24,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD25[j]= meanG(GenD25)
  yD25[j]= genicVarG(GenD25)
  
  GenD25 = setPheno(GenD25, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD26 = selectOP(GenD25,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD26[j]= meanG(GenD26)
  yD26[j]= genicVarG(GenD26)
  
  GenD26 = setPheno(GenD26, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD27 = selectOP(GenD26,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD27[j]= meanG(GenD27)
  yD27[j]= genicVarG(GenD27)
  
  GenD27 = setPheno(GenD27, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD28 = selectOP(GenD27, nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD28[j]= meanG(GenD28)
  yD28[j]= genicVarG(GenD28)
  
  GenD28 = setPheno(GenD28, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD29 = selectOP(GenD28,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD29[j]= meanG(GenD29)
  yD29[j]= genicVarG(GenD29)
  
  GenD29 = setPheno(GenD29, varE=f, p=runif(1)) #Sets a phenotyDpe using the GxDE model
  GenD30 = selectOP(GenD29,nInd=selection4,nSeeds=selectedSeeds4,probSelf=fabaSelf4,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xD30[j]= meanG(GenD30)
  yD30[j]= genicVarG(GenD30)
}

GGD1_S4=mean(xD1);GGD2_S4=mean(xD2);GGD3_S4=mean(xD3);GGD4_S4=mean(xD4);GGD5_S4=mean(xD5);GGD6_S4=mean(xD6);GGD7_S4=mean(xD7);GGD8_S4=mean(xD8);GGD9_S4=mean(xD9);GGD10_S4=mean(xD10)
GGD11_S4=mean(xD11);GGD12_S4=mean(xD12);GGD13_S4=mean(xD13);GGD14_S4=mean(xD14);GGD15_S4=mean(xD15);GGD16_S4=mean(xD16);GGD17_S4=mean(xD17);GGD18_S4=mean(xD18);GGD19_S4=mean(xD19);GGD20_S4=mean(xD20)
GGD21_S4=mean(xD21);GGD22_S4=mean(xD22);GGD23_S4=mean(xD23);GGD24_S4=mean(xD24);GGD25_S4=mean(xD25);GGD26_S4=mean(xD26);GGD27_S4=mean(xD27);GGD28_S4=mean(xD28);GGD29_S4=mean(xD29);GGD30_S4=mean(xD30)

GVD1_S4=mean(yD1);GVD2_S4=mean(yD2);GVD3_S4=mean(yD3);GVD4_S4=mean(yD4);GVD5_S4=mean(yD5);GVD6_S4=mean(yD6);GVD7_S4=mean(yD7);GVD8_S4=mean(yD8);GVD9_S4=mean(yD9);GVD10_S4=mean(yD10)
GVD11_S4=mean(yD11);GVD12_S4=mean(yD12);GVD13_S4=mean(yD13);GVD14_S4=mean(yD14);GVD15_S4=mean(yD15);GVD16_S4=mean(yD16);GVD17_S4=mean(yD17);GVD18_S4=mean(yD18);GVD19_S4=mean(yD19);GVD20_S4=mean(yD20)
GVD21_S4=mean(yD21);GVD22_S4=mean(yD22);GVD23_S4=mean(yD23);GVD24_S4=mean(yD24);GVD25_S4=mean(yD25);GVD26_S4=mean(yD26);GVD27_S4=mean(yD27);GVD28_S4=mean(yD28);GVD29_S4=mean(yD29);GVD30_S4=mean(yD30)



Genetic_gain_S4<-c(GGD1_S4,GGD2_S4,GGD3_S4,GGD4_S4,GGD5_S4,GGD6_S4,GGD7_S4,GGD8_S4,GGD9_S4,GGD10_S4,GGD11_S4,GGD12_S4,GGD13_S4,GGD14_S4,GGD15_S4,GGD16_S4,GGD17_S4,GGD18_S4,GGD19_S4,GGD20_S4,GGD21_S4,GGD22_S4,GGD23_S4,GGD24_S4,GGD25_S4,GGD26_S4,GGD27_S4,GGD28_S4,GGD29_S4,GGD30_S4)
Genetic_variation_S4<-c(GVD1_S4,GVD2_S4,GVD3_S4,GVD4_S4,GVD5_S4,GVD6_S4,GVD7_S4,GVD8_S4,GVD9_S4,GVD10_S4,GVD11_S4,GVD12_S4,GVD13_S4,GVD14_S4,GVD15_S4,GVD16_S4,GVD17_S4,GVD18_S4,GVD19_S4,GVD20_S4,GVD21_S4,GVD22_S4,GVD23_S4,GVD24_S4,GVD25_S4,GVD26_S4,GVD27_S4,GVD28_S4,GVD29_S4,GVD30_S4)
par(mfrow=c(2,1))
plot(Genetic_gain_S4,main="scenario 4",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S4)
plot(Genetic_variation_S4,main="scenario 4",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S4)
library(lattice)
Scenario4<-c(Genetic_gain_S4,Genetic_variation_S4)
write.csv(Scenario4,"Scenario4.csv")
xD_Scenario4<-data.frame(xD1,xD2,xD3,xD4,xD5,xD6,xD7,xD8,xD9,xD10,xD11,xD12,xD13,xD14,xD15,xD16,xD17,xD18,xD19,xD20,xD21,xD22,xD23,xD24,xD25,xD26,xD27,xD28,xD29,xD30)
write.csv(xD_Scenario4,"xD_scenario4.csv")
yD_Scenario4<-data.frame(yD1,yD2,yD3,yD4,yD5,yD6,yD7,yD8,yD9,yD10,yD11,yD12,yD13,yD14,yD15,yD16,yD17,yD18,yD19,yD20,yD21,yD22,yD23,yD24,yD25,yD26,yD27,yD28,yD29,yD30)
write.csv(yD_Scenario4,"yD_scenario4.csv")

######Scenario 5 for selection of 400 best plants in each cycle with 25 seeds per plant to generate a pop of 10000 for the next cycle#####
selection5=400 ; selectedSeeds5=25 ; fabaSelf5=0.25

xE1 = rep(0,n); yE1=rep(0,n)
xE2 = rep(0,n); yE2=rep(0,n)
xE3 = rep(0,n); yE3=rep(0,n)
xE4 = rep(0,n); yE4=rep(0,n)
xE5 = rep(0,n); yE5=rep(0,n)
xE6 = rep(0,n); yE6=rep(0,n)
xE7 = rep(0,n); yE7=rep(0,n)
xE8 = rep(0,n); yE8=rep(0,n)
xE9 = rep(0,n); yE9=rep(0,n)
xE10 = rep(0,n); yE10=rep(0,n)
xE11 = rep(0,n); yE11=rep(0,n)
xE12 = rep(0,n); yE12=rep(0,n)
xE13 = rep(0,n); yE13=rep(0,n)
xE14 = rep(0,n); yE14=rep(0,n)
xE15 = rep(0,n); yE15=rep(0,n)
xE16 = rep(0,n); yE16=rep(0,n)
xE17 = rep(0,n); yE17=rep(0,n)
xE18 = rep(0,n); yE18=rep(0,n)
xE19 = rep(0,n); yE19=rep(0,n)
xE20 = rep(0,n); yE20=rep(0,n)
xE21 = rep(0,n); yE21=rep(0,n)
xE22 = rep(0,n); yE22=rep(0,n)
xE23 = rep(0,n); yE23=rep(0,n)
xE24 = rep(0,n); yE24=rep(0,n)
xE25 = rep(0,n); yE25=rep(0,n)
xE26 = rep(0,n); yE26=rep(0,n)
xE27 = rep(0,n); yE27=rep(0,n)
xE28 = rep(0,n); yE28=rep(0,n)
xE29 = rep(0,n); yE29=rep(0,n)
xE30 = rep(0,n); yE30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE1 = selectOP(BasePop1,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE1[j]= meanG(GenE1)
  yE1[j]= genicVarG(GenE1)
  
  GenE1 = setPheno(GenE1, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE2 = selectOP(GenE1,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE2[j]= meanG(GenE2)
  yE2[j]= genicVarG(GenE2)
  
  GenE2 = setPheno(GenE2, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE3 = selectOP(GenE2,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE3[j]=meanG(GenE3)
  yE3[j]= genicVarG(GenE3)
  
  GenE3 = setPheno(GenE3, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE4 = selectOP(GenE3,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE4[j]=meanG(GenE4)
  yE4[j]= genicVarG(GenE4)
  
  GenE4 = setPheno(GenE4, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE5 = selectOP(GenE4,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE5[j]= meanG(GenE5)
  yE5[j]= genicVarG(GenE5)
  
  GenE5 = setPheno(GenE5, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE6 = selectOP(GenE5,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE6[j]= meanG(GenE6)
  yE6[j]= genicVarG(GenE6)
  
  GenE6 = setPheno(GenE6, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE7 = selectOP(GenE6,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE7[j]= meanG(GenE7)
  yE7[j]= genicVarG(GenE7)
  
  GenE7 = setPheno(GenE7, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE8 = selectOP(GenE7,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE8[j]= meanG(GenE8)
  yE8[j]= genicVarG(GenE8)
  
  GenE8 = setPheno(GenE8, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE9 = selectOP(GenE8,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE9[j]= meanG(GenE9)
  yE9[j]= genicVarG(GenE9)
  
  GenE9 = setPheno(GenE9, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE10 = selectOP(GenE9,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE10[j]= meanG(GenE10)
  yE10[j]= genicVarG(GenE10)
  
  GenE10 = setPheno(GenE10, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE11 = selectOP(GenE10,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE11[j]= meanG(GenE11)
  yE11[j]= genicVarG(GenE11)
  
  GenE11 = setPheno(GenE11, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE12 = selectOP(GenE11,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE12[j]= meanG(GenE12)
  yE12[j]= genicVarG(GenE12)
  
  GenE12 = setPheno(GenE12, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE13 = selectOP(GenE12,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE13[j]= meanG(GenE13)
  yE13[j]= genicVarG(GenE13)
  
  GenE13 = setPheno(GenE13, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE14 = selectOP(GenE13,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE14[j]= meanG(GenE14)
  yE14[j]= genicVarG(GenE14)
  
  GenE14 = setPheno(GenE14, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE15 = selectOP(GenE14,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE15[j]= meanG(GenE15)
  yE15[j]= genicVarG(GenE15)
  
  GenE15 = setPheno(GenE15, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE16 = selectOP(GenE15,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE16[j]= meanG(GenE16)
  yE16[j]= genicVarG(GenE16)
  
  GenE16 = setPheno(GenE16, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE17 = selectOP(GenE16,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE17[j]=meanG(GenE17)
  yE17[j]= genicVarG(GenE17)
  
  GenE17 = setPheno(GenE17, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE18 = selectOP(GenE17,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE18[j]= meanG(GenE18)
  yE18[j]= genicVarG(GenE18)
  
  GenE18 = setPheno(GenE18, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE19 = selectOP(GenE18,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE19[j]= meanG(GenE19)
  yE19[j]= genicVarG(GenE19)
  
  GenE19 = setPheno(GenE19, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE20 = selectOP(GenE19,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE20[j]= meanG(GenE20)
  yE20[j]= genicVarG(GenE20)
  
  GenE20 = setPheno(GenE20, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE21 = selectOP(GenE20,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE21[j]= meanG(GenE21)
  yE21[j]= genicVarG(GenE21)
  
  GenE21 = setPheno(GenE21, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE22 = selectOP(GenE21,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE22[j]= meanG(GenE22)
  yE22[j]= genicVarG(GenE22)
  
  GenE22 = setPheno(GenE22, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE23 = selectOP(GenE22,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE23[j]= meanG(GenE23)
  yE23[j]= genicVarG(GenE23)
  
  GenE23 = setPheno(GenE23, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE24 = selectOP(GenE23,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE24[j]= meanG(GenE24)
  yE24[j]= genicVarG(GenE24)
  
  GenE24 = setPheno(GenE24, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE25 = selectOP(GenE24,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE25[j]= meanG(GenE25)
  yE25[j]= genicVarG(GenE25)
  
  GenE25 = setPheno(GenE25, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE26 = selectOP(GenE25,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE26[j]= meanG(GenE26)
  yE26[j]= genicVarG(GenE26)
  
  GenE26 = setPheno(GenE26, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE27 = selectOP(GenE26,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE27[j]= meanG(GenE27)
  yE27[j]= genicVarG(GenE27)
  
  GenE27 = setPheno(GenE27, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE28 = selectOP(GenE27, nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE28[j]= meanG(GenE28)
  yE28[j]= genicVarG(GenE28)
  
  GenE28 = setPheno(GenE28, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE29 = selectOP(GenE28,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE29[j]= meanG(GenE29)
  yE29[j]= genicVarG(GenE29)
  
  GenE29 = setPheno(GenE29, varE=f, p=runif(1)) #Sets a phenotyEpe using the GxEE model
  GenE30 = selectOP(GenE29,nInd=selection5,nSeeds=selectedSeeds5,probSelf=fabaSelf5,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xE30[j]= meanG(GenE30)
  yE30[j]= genicVarG(GenE30)
}

GGE1_S5=mean(xE1);GGE2_S5=mean(xE2);GGE3_S5=mean(xE3);GGE4_S5=mean(xE4);GGE5_S5=mean(xE5);GGE6_S5=mean(xE6);GGE7_S5=mean(xE7);GGE8_S5=mean(xE8);GGE9_S5=mean(xE9);GGE10_S5=mean(xE10)
GGE11_S5=mean(xE11);GGE12_S5=mean(xE12);GGE13_S5=mean(xE13);GGE14_S5=mean(xE14);GGE15_S5=mean(xE15);GGE16_S5=mean(xE16);GGE17_S5=mean(xE17);GGE18_S5=mean(xE18);GGE19_S5=mean(xE19);GGE20_S5=mean(xE20)
GGE21_S5=mean(xE21);GGE22_S5=mean(xE22);GGE23_S5=mean(xE23);GGE24_S5=mean(xE24);GGE25_S5=mean(xE25);GGE26_S5=mean(xE26);GGE27_S5=mean(xE27);GGE28_S5=mean(xE28);GGE29_S5=mean(xE29);GGE30_S5=mean(xE30)

GVE1_S5=mean(yE1);GVE2_S5=mean(yE2);GVE3_S5=mean(yE3);GVE4_S5=mean(yE4);GVE5_S5=mean(yE5);GVE6_S5=mean(yE6);GVE7_S5=mean(yE7);GVE8_S5=mean(yE8);GVE9_S5=mean(yE9);GVE10_S5=mean(yE10)
GVE11_S5=mean(yE11);GVE12_S5=mean(yE12);GVE13_S5=mean(yE13);GVE14_S5=mean(yE14);GVE15_S5=mean(yE15);GVE16_S5=mean(yE16);GVE17_S5=mean(yE17);GVE18_S5=mean(yE18);GVE19_S5=mean(yE19);GVE20_S5=mean(yE20)
GVE21_S5=mean(yE21);GVE22_S5=mean(yE22);GVE23_S5=mean(yE23);GVE24_S5=mean(yE24);GVE25_S5=mean(yE25);GVE26_S5=mean(yE26);GVE27_S5=mean(yE27);GVE28_S5=mean(yE28);GVE29_S5=mean(yE29);GVE30_S5=mean(yE30)



Genetic_gain_S5<-c(GGE1_S5,GGE2_S5,GGE3_S5,GGE4_S5,GGE5_S5,GGE6_S5,GGE7_S5,GGE8_S5,GGE9_S5,GGE10_S5,GGE11_S5,GGE12_S5,GGE13_S5,GGE14_S5,GGE15_S5,GGE16_S5,GGE17_S5,GGE18_S5,GGE19_S5,GGE20_S5,GGE21_S5,GGE22_S5,GGE23_S5,GGE24_S5,GGE25_S5,GGE26_S5,GGE27_S5,GGE28_S5,GGE29_S5,GGE30_S5)
Genetic_variation_S5<-c(GVE1_S5,GVE2_S5,GVE3_S5,GVE4_S5,GVE5_S5,GVE6_S5,GVE7_S5,GVE8_S5,GVE9_S5,GVE10_S5,GVE11_S5,GVE12_S5,GVE13_S5,GVE14_S5,GVE15_S5,GVE16_S5,GVE17_S5,GVE18_S5,GVE19_S5,GVE20_S5,GVE21_S5,GVE22_S5,GVE23_S5,GVE24_S5,GVE25_S5,GVE26_S5,GVE27_S5,GVE28_S5,GVE29_S5,GVE30_S5)
par(mfrow=c(2,1))
plot(Genetic_gain_S5,main="scenario 5",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S5)
plot(Genetic_variation_S5,main="scenario 5",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S5)
library(lattice)
Scenario5<-c(Genetic_gain_S5,Genetic_variation_S5)
write.csv(Scenario5,"Scenario5.csv")
xE_Scenario5<-data.frame(xE1,xE2,xE3,xE4,xE5,xE6,xE7,xE8,xE9,xE10,xE11,xE12,xE13,xE14,xE15,xE16,xE17,xE18,xE19,xE20,xE21,xE22,xE23,xE24,xE25,xE26,xE27,xE28,xE29,xE30)
write.csv(xE_Scenario5,"xE_scenario5.csv")
yE_Scenario5<-data.frame(yE1,yE2,yE3,yE4,yE5,yE6,yE7,yE8,yE9,yE10,yE11,yE12,yE13,yE14,yE15,yE16,yE17,yE18,yE19,yE20,yE21,yE22,yE23,yE24,yE25,yE26,yE27,yE28,yE29,yE30)
write.csv(yE_Scenario5,"yE_scenario5.csv")

######Scenario 6 for selection of 1000 best plants in each cycle with 10 seeds per plant to generate a pop of 10000 for the next cycle#####
selection6=1000 ; selectedSeeds6=10 ; fabaSelf6=0.25

xF1 = rep(0,n); yF1=rep(0,n)
xF2 = rep(0,n); yF2=rep(0,n)
xF3 = rep(0,n); yF3=rep(0,n)
xF4 = rep(0,n); yF4=rep(0,n)
xF5 = rep(0,n); yF5=rep(0,n)
xF6 = rep(0,n); yF6=rep(0,n)
xF7 = rep(0,n); yF7=rep(0,n)
xF8 = rep(0,n); yF8=rep(0,n)
xF9 = rep(0,n); yF9=rep(0,n)
xF10 = rep(0,n); yF10=rep(0,n)
xF11 = rep(0,n); yF11=rep(0,n)
xF12 = rep(0,n); yF12=rep(0,n)
xF13 = rep(0,n); yF13=rep(0,n)
xF14 = rep(0,n); yF14=rep(0,n)
xF15 = rep(0,n); yF15=rep(0,n)
xF16 = rep(0,n); yF16=rep(0,n)
xF17 = rep(0,n); yF17=rep(0,n)
xF18 = rep(0,n); yF18=rep(0,n)
xF19 = rep(0,n); yF19=rep(0,n)
xF20 = rep(0,n); yF20=rep(0,n)
xF21 = rep(0,n); yF21=rep(0,n)
xF22 = rep(0,n); yF22=rep(0,n)
xF23 = rep(0,n); yF23=rep(0,n)
xF24 = rep(0,n); yF24=rep(0,n)
xF25 = rep(0,n); yF25=rep(0,n)
xF26 = rep(0,n); yF26=rep(0,n)
xF27 = rep(0,n); yF27=rep(0,n)
xF28 = rep(0,n); yF28=rep(0,n)
xF29 = rep(0,n); yF29=rep(0,n)
xF30 = rep(0,n); yF30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF1 = selectOP(BasePop1,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF1[j]= meanG(GenF1)
  yF1[j]= genicVarG(GenF1)
  
  GenF1 = setPheno(GenF1, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF2 = selectOP(GenF1,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF2[j]= meanG(GenF2)
  yF2[j]= genicVarG(GenF2)
  
  GenF2 = setPheno(GenF2, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF3 = selectOP(GenF2,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF3[j]=meanG(GenF3)
  yF3[j]= genicVarG(GenF3)
  
  GenF3 = setPheno(GenF3, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF4 = selectOP(GenF3,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF4[j]=meanG(GenF4)
  yF4[j]= genicVarG(GenF4)
  
  GenF4 = setPheno(GenF4, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF5 = selectOP(GenF4,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF5[j]= meanG(GenF5)
  yF5[j]= genicVarG(GenF5)
  
  GenF5 = setPheno(GenF5, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF6 = selectOP(GenF5,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF6[j]= meanG(GenF6)
  yF6[j]= genicVarG(GenF6)
  
  GenF6 = setPheno(GenF6, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF7 = selectOP(GenF6,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF7[j]= meanG(GenF7)
  yF7[j]= genicVarG(GenF7)
  
  GenF7 = setPheno(GenF7, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF8 = selectOP(GenF7,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF8[j]= meanG(GenF8)
  yF8[j]= genicVarG(GenF8)
  
  GenF8 = setPheno(GenF8, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF9 = selectOP(GenF8,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF9[j]= meanG(GenF9)
  yF9[j]= genicVarG(GenF9)
  
  GenF9 = setPheno(GenF9, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF10 = selectOP(GenF9,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF10[j]= meanG(GenF10)
  yF10[j]= genicVarG(GenF10)
  
  GenF10 = setPheno(GenF10, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF11 = selectOP(GenF10,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF11[j]= meanG(GenF11)
  yF11[j]= genicVarG(GenF11)
  
  GenF11 = setPheno(GenF11, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF12 = selectOP(GenF11,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF12[j]= meanG(GenF12)
  yF12[j]= genicVarG(GenF12)
  
  GenF12 = setPheno(GenF12, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF13 = selectOP(GenF12,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF13[j]= meanG(GenF13)
  yF13[j]= genicVarG(GenF13)
  
  GenF13 = setPheno(GenF13, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF14 = selectOP(GenF13,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF14[j]= meanG(GenF14)
  yF14[j]= genicVarG(GenF14)
  
  GenF14 = setPheno(GenF14, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF15 = selectOP(GenF14,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF15[j]= meanG(GenF15)
  yF15[j]= genicVarG(GenF15)
  
  GenF15 = setPheno(GenF15, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF16 = selectOP(GenF15,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF16[j]= meanG(GenF16)
  yF16[j]= genicVarG(GenF16)
  
  GenF16 = setPheno(GenF16, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF17 = selectOP(GenF16,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF17[j]=meanG(GenF17)
  yF17[j]= genicVarG(GenF17)
  
  GenF17 = setPheno(GenF17, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF18 = selectOP(GenF17,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF18[j]= meanG(GenF18)
  yF18[j]= genicVarG(GenF18)
  
  GenF18 = setPheno(GenF18, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF19 = selectOP(GenF18,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF19[j]= meanG(GenF19)
  yF19[j]= genicVarG(GenF19)
  
  GenF19 = setPheno(GenF19, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF20 = selectOP(GenF19,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF20[j]= meanG(GenF20)
  yF20[j]= genicVarG(GenF20)
  
  GenF20 = setPheno(GenF20, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF21 = selectOP(GenF20,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF21[j]= meanG(GenF21)
  yF21[j]= genicVarG(GenF21)
  
  GenF21 = setPheno(GenF21, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF22 = selectOP(GenF21,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF22[j]= meanG(GenF22)
  yF22[j]= genicVarG(GenF22)
  
  GenF22 = setPheno(GenF22, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF23 = selectOP(GenF22,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF23[j]= meanG(GenF23)
  yF23[j]= genicVarG(GenF23)
  
  GenF23 = setPheno(GenF23, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF24 = selectOP(GenF23,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF24[j]= meanG(GenF24)
  yF24[j]= genicVarG(GenF24)
  
  GenF24 = setPheno(GenF24, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF25 = selectOP(GenF24,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF25[j]= meanG(GenF25)
  yF25[j]= genicVarG(GenF25)
  
  GenF25 = setPheno(GenF25, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF26 = selectOP(GenF25,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF26[j]= meanG(GenF26)
  yF26[j]= genicVarG(GenF26)
  
  GenF26 = setPheno(GenF26, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF27 = selectOP(GenF26,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF27[j]= meanG(GenF27)
  yF27[j]= genicVarG(GenF27)
  
  GenF27 = setPheno(GenF27, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF28 = selectOP(GenF27, nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF28[j]= meanG(GenF28)
  yF28[j]= genicVarG(GenF28)
  
  GenF28 = setPheno(GenF28, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF29 = selectOP(GenF28,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF29[j]= meanG(GenF29)
  yF29[j]= genicVarG(GenF29)
  
  GenF29 = setPheno(GenF29, varE=f, p=runif(1)) #Sets a phenotyFpe using the GxFE model
  GenF30 = selectOP(GenF29,nInd=selection6,nSeeds=selectedSeeds6,probSelf=fabaSelf6,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xF30[j]= meanG(GenF30)
  yF30[j]= genicVarG(GenF30)
}

GGF1_S6=mean(xF1);GGF2_S6=mean(xF2);GGF3_S6=mean(xF3);GGF4_S6=mean(xF4);GGF5_S6=mean(xF5);GGF6_S6=mean(xF6);GGF7_S6=mean(xF7);GGF8_S6=mean(xF8);GGF9_S6=mean(xF9);GGF10_S6=mean(xF10)
GGF11_S6=mean(xF11);GGF12_S6=mean(xF12);GGF13_S6=mean(xF13);GGF14_S6=mean(xF14);GGF15_S6=mean(xF15);GGF16_S6=mean(xF16);GGF17_S6=mean(xF17);GGF18_S6=mean(xF18);GGF19_S6=mean(xF19);GGF20_S6=mean(xF20)
GGF21_S6=mean(xF21);GGF22_S6=mean(xF22);GGF23_S6=mean(xF23);GGF24_S6=mean(xF24);GGF25_S6=mean(xF25);GGF26_S6=mean(xF26);GGF27_S6=mean(xF27);GGF28_S6=mean(xF28);GGF29_S6=mean(xF29);GGF30_S6=mean(xF30)

GVF1_S6=mean(yF1);GVF2_S6=mean(yF2);GVF3_S6=mean(yF3);GVF4_S6=mean(yF4);GVF5_S6=mean(yF5);GVF6_S6=mean(yF6);GVF7_S6=mean(yF7);GVF8_S6=mean(yF8);GVF9_S6=mean(yF9);GVF10_S6=mean(yF10)
GVF11_S6=mean(yF11);GVF12_S6=mean(yF12);GVF13_S6=mean(yF13);GVF14_S6=mean(yF14);GVF15_S6=mean(yF15);GVF16_S6=mean(yF16);GVF17_S6=mean(yF17);GVF18_S6=mean(yF18);GVF19_S6=mean(yF19);GVF20_S6=mean(yF20)
GVF21_S6=mean(yF21);GVF22_S6=mean(yF22);GVF23_S6=mean(yF23);GVF24_S6=mean(yF24);GVF25_S6=mean(yF25);GVF26_S6=mean(yF26);GVF27_S6=mean(yF27);GVF28_S6=mean(yF28);GVF29_S6=mean(yF29);GVF30_S6=mean(yF30)



Genetic_gain_S6<-c(GGF1_S6,GGF2_S6,GGF3_S6,GGF4_S6,GGF5_S6,GGF6_S6,GGF7_S6,GGF8_S6,GGF9_S6,GGF10_S6,GGF11_S6,GGF12_S6,GGF13_S6,GGF14_S6,GGF15_S6,GGF16_S6,GGF17_S6,GGF18_S6,GGF19_S6,GGF20_S6,GGF21_S6,GGF22_S6,GGF23_S6,GGF24_S6,GGF25_S6,GGF26_S6,GGF27_S6,GGF28_S6,GGF29_S6,GGF30_S6)
Genetic_variation_S6<-c(GVF1_S6,GVF2_S6,GVF3_S6,GVF4_S6,GVF5_S6,GVF6_S6,GVF7_S6,GVF8_S6,GVF9_S6,GVF10_S6,GVF11_S6,GVF12_S6,GVF13_S6,GVF14_S6,GVF15_S6,GVF16_S6,GVF17_S6,GVF18_S6,GVF19_S6,GVF20_S6,GVF21_S6,GVF22_S6,GVF23_S6,GVF24_S6,GVF25_S6,GVF26_S6,GVF27_S6,GVF28_S6,GVF29_S6,GVF30_S6)
par(mfrow=c(2,1))
plot(Genetic_gain_S6,main="scenario 6",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S6)
plot(Genetic_variation_S6,main="scenario 6",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S6)
library(lattice)
Scenario6<-c(Genetic_gain_S6,Genetic_variation_S6)
write.csv(Scenario6,"Scenario6.csv")
xF_Scenario6<-data.frame(xF1,xF2,xF3,xF4,xF5,xF6,xF7,xF8,xF9,xF10,xF11,xF12,xF13,xF14,xF15,xF16,xF17,xF18,xF19,xF20,xF21,xF22,xF23,xF24,xF25,xF26,xF27,xF28,xF29,xF30)
write.csv(xF_Scenario6,"xF_scenario6.csv")
yF_Scenario6<-data.frame(yF1,yF2,yF3,yF4,yF5,yF6,yF7,yF8,yF9,yF10,yF11,yF12,yF13,yF14,yF15,yF16,yF17,yF18,yF19,yF20,yF21,yF22,yF23,yF24,yF25,yF26,yF27,yF28,yF29,yF30)
write.csv(yF_Scenario6,"yF_scenario6.csv")

######Scenario 7 for selection of 400 best plants in each cycle with 50 seeds per plant to generate a pop of 20000 for the next cycle#####
selection7=400 ; selectedSeeds7=50 ; fabaSelf7=0.25

xG1 = rep(0,n); yG1=rep(0,n)
xG2 = rep(0,n); yG2=rep(0,n)
xG3 = rep(0,n); yG3=rep(0,n)
xG4 = rep(0,n); yG4=rep(0,n)
xG5 = rep(0,n); yG5=rep(0,n)
xG6 = rep(0,n); yG6=rep(0,n)
xG7 = rep(0,n); yG7=rep(0,n)
xG8 = rep(0,n); yG8=rep(0,n)
xG9 = rep(0,n); yG9=rep(0,n)
xG10 = rep(0,n); yG10=rep(0,n)
xG11 = rep(0,n); yG11=rep(0,n)
xG12 = rep(0,n); yG12=rep(0,n)
xG13 = rep(0,n); yG13=rep(0,n)
xG14 = rep(0,n); yG14=rep(0,n)
xG15 = rep(0,n); yG15=rep(0,n)
xG16 = rep(0,n); yG16=rep(0,n)
xG17 = rep(0,n); yG17=rep(0,n)
xG18 = rep(0,n); yG18=rep(0,n)
xG19 = rep(0,n); yG19=rep(0,n)
xG20 = rep(0,n); yG20=rep(0,n)
xG21 = rep(0,n); yG21=rep(0,n)
xG22 = rep(0,n); yG22=rep(0,n)
xG23 = rep(0,n); yG23=rep(0,n)
xG24 = rep(0,n); yG24=rep(0,n)
xG25 = rep(0,n); yG25=rep(0,n)
xG26 = rep(0,n); yG26=rep(0,n)
xG27 = rep(0,n); yG27=rep(0,n)
xG28 = rep(0,n); yG28=rep(0,n)
xG29 = rep(0,n); yG29=rep(0,n)
xG30 = rep(0,n); yG30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG1 = selectOP(BasePop1,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG1[j]= meanG(GenG1)
  yG1[j]= genicVarG(GenG1)
  
  GenG1 = setPheno(GenG1, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG2 = selectOP(GenG1,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG2[j]= meanG(GenG2)
  yG2[j]= genicVarG(GenG2)
  
  GenG2 = setPheno(GenG2, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG3 = selectOP(GenG2,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG3[j]=meanG(GenG3)
  yG3[j]= genicVarG(GenG3)
  
  GenG3 = setPheno(GenG3, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG4 = selectOP(GenG3,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG4[j]=meanG(GenG4)
  yG4[j]= genicVarG(GenG4)
  
  GenG4 = setPheno(GenG4, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG5 = selectOP(GenG4,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG5[j]= meanG(GenG5)
  yG5[j]= genicVarG(GenG5)
  
  GenG5 = setPheno(GenG5, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG6 = selectOP(GenG5,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG6[j]= meanG(GenG6)
  yG6[j]= genicVarG(GenG6)
  
  GenG6 = setPheno(GenG6, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG7 = selectOP(GenG6,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG7[j]= meanG(GenG7)
  yG7[j]= genicVarG(GenG7)
  
  GenG7 = setPheno(GenG7, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG8 = selectOP(GenG7,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG8[j]= meanG(GenG8)
  yG8[j]= genicVarG(GenG8)
  
  GenG8 = setPheno(GenG8, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG9 = selectOP(GenG8,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG9[j]= meanG(GenG9)
  yG9[j]= genicVarG(GenG9)
  
  GenG9 = setPheno(GenG9, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG10 = selectOP(GenG9,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG10[j]= meanG(GenG10)
  yG10[j]= genicVarG(GenG10)
  
  GenG10 = setPheno(GenG10, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG11 = selectOP(GenG10,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG11[j]= meanG(GenG11)
  yG11[j]= genicVarG(GenG11)
  
  GenG11 = setPheno(GenG11, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG12 = selectOP(GenG11,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG12[j]= meanG(GenG12)
  yG12[j]= genicVarG(GenG12)
  
  GenG12 = setPheno(GenG12, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG13 = selectOP(GenG12,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG13[j]= meanG(GenG13)
  yG13[j]= genicVarG(GenG13)
  
  GenG13 = setPheno(GenG13, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG14 = selectOP(GenG13,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG14[j]= meanG(GenG14)
  yG14[j]= genicVarG(GenG14)
  
  GenG14 = setPheno(GenG14, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG15 = selectOP(GenG14,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG15[j]= meanG(GenG15)
  yG15[j]= genicVarG(GenG15)
  
  GenG15 = setPheno(GenG15, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG16 = selectOP(GenG15,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG16[j]= meanG(GenG16)
  yG16[j]= genicVarG(GenG16)
  
  GenG16 = setPheno(GenG16, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG17 = selectOP(GenG16,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG17[j]=meanG(GenG17)
  yG17[j]= genicVarG(GenG17)
  
  GenG17 = setPheno(GenG17, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG18 = selectOP(GenG17,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG18[j]= meanG(GenG18)
  yG18[j]= genicVarG(GenG18)
  
  GenG18 = setPheno(GenG18, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG19 = selectOP(GenG18,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG19[j]= meanG(GenG19)
  yG19[j]= genicVarG(GenG19)
  
  GenG19 = setPheno(GenG19, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG20 = selectOP(GenG19,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG20[j]= meanG(GenG20)
  yG20[j]= genicVarG(GenG20)
  
  GenG20 = setPheno(GenG20, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG21 = selectOP(GenG20,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG21[j]= meanG(GenG21)
  yG21[j]= genicVarG(GenG21)
  
  GenG21 = setPheno(GenG21, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG22 = selectOP(GenG21,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG22[j]= meanG(GenG22)
  yG22[j]= genicVarG(GenG22)
  
  GenG22 = setPheno(GenG22, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG23 = selectOP(GenG22,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG23[j]= meanG(GenG23)
  yG23[j]= genicVarG(GenG23)
  
  GenG23 = setPheno(GenG23, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG24 = selectOP(GenG23,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG24[j]= meanG(GenG24)
  yG24[j]= genicVarG(GenG24)
  
  GenG24 = setPheno(GenG24, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG25 = selectOP(GenG24,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG25[j]= meanG(GenG25)
  yG25[j]= genicVarG(GenG25)
  
  GenG25 = setPheno(GenG25, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG26 = selectOP(GenG25,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG26[j]= meanG(GenG26)
  yG26[j]= genicVarG(GenG26)
  
  GenG26 = setPheno(GenG26, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG27 = selectOP(GenG26,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG27[j]= meanG(GenG27)
  yG27[j]= genicVarG(GenG27)
  
  GenG27 = setPheno(GenG27, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG28 = selectOP(GenG27, nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG28[j]= meanG(GenG28)
  yG28[j]= genicVarG(GenG28)
  
  GenG28 = setPheno(GenG28, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG29 = selectOP(GenG28,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG29[j]= meanG(GenG29)
  yG29[j]= genicVarG(GenG29)
  
  GenG29 = setPheno(GenG29, varE=f, p=runif(1)) #Sets a phenotyGpe using the GxGE model
  GenG30 = selectOP(GenG29,nInd=selection7,nSeeds=selectedSeeds7,probSelf=fabaSelf7,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xG30[j]= meanG(GenG30)
  yG30[j]= genicVarG(GenG30)
}

GGG1_S7=mean(xG1);GGG2_S7=mean(xG2);GGG3_S7=mean(xG3);GGG4_S7=mean(xG4);GGG5_S7=mean(xG5);GGG6_S7=mean(xG6);GGG7_S7=mean(xG7);GGG8_S7=mean(xG8);GGG9_S7=mean(xG9);GGG10_S7=mean(xG10)
GGG11_S7=mean(xG11);GGG12_S7=mean(xG12);GGG13_S7=mean(xG13);GGG14_S7=mean(xG14);GGG15_S7=mean(xG15);GGG16_S7=mean(xG16);GGG17_S7=mean(xG17);GGG18_S7=mean(xG18);GGG19_S7=mean(xG19);GGG20_S7=mean(xG20)
GGG21_S7=mean(xG21);GGG22_S7=mean(xG22);GGG23_S7=mean(xG23);GGG24_S7=mean(xG24);GGG25_S7=mean(xG25);GGG26_S7=mean(xG26);GGG27_S7=mean(xG27);GGG28_S7=mean(xG28);GGG29_S7=mean(xG29);GGG30_S7=mean(xG30)

GVG1_S7=mean(yG1);GVG2_S7=mean(yG2);GVG3_S7=mean(yG3);GVG4_S7=mean(yG4);GVG5_S7=mean(yG5);GVG6_S7=mean(yG6);GVG7_S7=mean(yG7);GVG8_S7=mean(yG8);GVG9_S7=mean(yG9);GVG10_S7=mean(yG10)
GVG11_S7=mean(yG11);GVG12_S7=mean(yG12);GVG13_S7=mean(yG13);GVG14_S7=mean(yG14);GVG15_S7=mean(yG15);GVG16_S7=mean(yG16);GVG17_S7=mean(yG17);GVG18_S7=mean(yG18);GVG19_S7=mean(yG19);GVG20_S7=mean(yG20)
GVG21_S7=mean(yG21);GVG22_S7=mean(yG22);GVG23_S7=mean(yG23);GVG24_S7=mean(yG24);GVG25_S7=mean(yG25);GVG26_S7=mean(yG26);GVG27_S7=mean(yG27);GVG28_S7=mean(yG28);GVG29_S7=mean(yG29);GVG30_S7=mean(yG30)



Genetic_gain_S7<-c(GGG1_S7,GGG2_S7,GGG3_S7,GGG4_S7,GGG5_S7,GGG6_S7,GGG7_S7,GGG8_S7,GGG9_S7,GGG10_S7,GGG11_S7,GGG12_S7,GGG13_S7,GGG14_S7,GGG15_S7,GGG16_S7,GGG17_S7,GGG18_S7,GGG19_S7,GGG20_S7,GGG21_S7,GGG22_S7,GGG23_S7,GGG24_S7,GGG25_S7,GGG26_S7,GGG27_S7,GGG28_S7,GGG29_S7,GGG30_S7)
Genetic_variation_S7<-c(GVG1_S7,GVG2_S7,GVG3_S7,GVG4_S7,GVG5_S7,GVG6_S7,GVG7_S7,GVG8_S7,GVG9_S7,GVG10_S7,GVG11_S7,GVG12_S7,GVG13_S7,GVG14_S7,GVG15_S7,GVG16_S7,GVG17_S7,GVG18_S7,GVG19_S7,GVG20_S7,GVG21_S7,GVG22_S7,GVG23_S7,GVG24_S7,GVG25_S7,GVG26_S7,GVG27_S7,GVG28_S7,GVG29_S7,GVG30_S7)
par(mfrow=c(2,1))
plot(Genetic_gain_S7,main="scenario 7",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S7)
plot(Genetic_variation_S7,main="scenario 7",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S7)
library(lattice)
Scenario7<-c(Genetic_gain_S7,Genetic_variation_S7)
write.csv(Scenario7,"Scenario7.csv")
xG_Scenario7<-data.frame(xG1,xG2,xG3,xG4,xG5,xG6,xG7,xG8,xG9,xG10,xG11,xG12,xG13,xG14,xG15,xG16,xG17,xG18,xG19,xG20,xG21,xG22,xG23,xG24,xG25,xG26,xG27,xG28,xG29,xG30)
write.csv(xG_Scenario7,"xG_scenario7.csv")
yG_Scenario7<-data.frame(yG1,yG2,yG3,yG4,yG5,yG6,yG7,yG8,yG9,yG10,yG11,yG12,yG13,yG14,yG15,yG16,yG17,yG18,yG19,yG20,yG21,yG22,yG23,yG24,yG25,yG26,yG27,yG28,yG29,yG30)
write.csv(yG_Scenario7,"yG_scenario7.csv")

######Scenario 8 for selection of 800 best plants in each cycle with 25 seeds per plant to generate a pop of 20000 for the next cycle#####
selection8=800 ; selectedSeeds8=25 ; fabaSelf8=0.25

xH1 = rep(0,n); yH1=rep(0,n)
xH2 = rep(0,n); yH2=rep(0,n)
xH3 = rep(0,n); yH3=rep(0,n)
xH4 = rep(0,n); yH4=rep(0,n)
xH5 = rep(0,n); yH5=rep(0,n)
xH6 = rep(0,n); yH6=rep(0,n)
xH7 = rep(0,n); yH7=rep(0,n)
xH8 = rep(0,n); yH8=rep(0,n)
xH9 = rep(0,n); yH9=rep(0,n)
xH10 = rep(0,n); yH10=rep(0,n)
xH11 = rep(0,n); yH11=rep(0,n)
xH12 = rep(0,n); yH12=rep(0,n)
xH13 = rep(0,n); yH13=rep(0,n)
xH14 = rep(0,n); yH14=rep(0,n)
xH15 = rep(0,n); yH15=rep(0,n)
xH16 = rep(0,n); yH16=rep(0,n)
xH17 = rep(0,n); yH17=rep(0,n)
xH18 = rep(0,n); yH18=rep(0,n)
xH19 = rep(0,n); yH19=rep(0,n)
xH20 = rep(0,n); yH20=rep(0,n)
xH21 = rep(0,n); yH21=rep(0,n)
xH22 = rep(0,n); yH22=rep(0,n)
xH23 = rep(0,n); yH23=rep(0,n)
xH24 = rep(0,n); yH24=rep(0,n)
xH25 = rep(0,n); yH25=rep(0,n)
xH26 = rep(0,n); yH26=rep(0,n)
xH27 = rep(0,n); yH27=rep(0,n)
xH28 = rep(0,n); yH28=rep(0,n)
xH29 = rep(0,n); yH29=rep(0,n)
xH30 = rep(0,n); yH30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH1 = selectOP(BasePop1,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH1[j]= meanG(GenH1)
  yH1[j]= genicVarG(GenH1)
  
  GenH1 = setPheno(GenH1, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH2 = selectOP(GenH1,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH2[j]= meanG(GenH2)
  yH2[j]= genicVarG(GenH2)
  
  GenH2 = setPheno(GenH2, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH3 = selectOP(GenH2,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH3[j]=meanG(GenH3)
  yH3[j]= genicVarG(GenH3)
  
  GenH3 = setPheno(GenH3, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH4 = selectOP(GenH3,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH4[j]=meanG(GenH4)
  yH4[j]= genicVarG(GenH4)
  
  GenH4 = setPheno(GenH4, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH5 = selectOP(GenH4,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH5[j]= meanG(GenH5)
  yH5[j]= genicVarG(GenH5)
  
  GenH5 = setPheno(GenH5, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH6 = selectOP(GenH5,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH6[j]= meanG(GenH6)
  yH6[j]= genicVarG(GenH6)
  
  GenH6 = setPheno(GenH6, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH7 = selectOP(GenH6,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH7[j]= meanG(GenH7)
  yH7[j]= genicVarG(GenH7)
  
  GenH7 = setPheno(GenH7, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH8 = selectOP(GenH7,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH8[j]= meanG(GenH8)
  yH8[j]= genicVarG(GenH8)
  
  GenH8 = setPheno(GenH8, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH9 = selectOP(GenH8,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH9[j]= meanG(GenH9)
  yH9[j]= genicVarG(GenH9)
  
  GenH9 = setPheno(GenH9, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH10 = selectOP(GenH9,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH10[j]= meanG(GenH10)
  yH10[j]= genicVarG(GenH10)
  
  GenH10 = setPheno(GenH10, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH11 = selectOP(GenH10,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH11[j]= meanG(GenH11)
  yH11[j]= genicVarG(GenH11)
  
  GenH11 = setPheno(GenH11, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH12 = selectOP(GenH11,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH12[j]= meanG(GenH12)
  yH12[j]= genicVarG(GenH12)
  
  GenH12 = setPheno(GenH12, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH13 = selectOP(GenH12,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH13[j]= meanG(GenH13)
  yH13[j]= genicVarG(GenH13)
  
  GenH13 = setPheno(GenH13, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH14 = selectOP(GenH13,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH14[j]= meanG(GenH14)
  yH14[j]= genicVarG(GenH14)
  
  GenH14 = setPheno(GenH14, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH15 = selectOP(GenH14,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH15[j]= meanG(GenH15)
  yH15[j]= genicVarG(GenH15)
  
  GenH15 = setPheno(GenH15, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH16 = selectOP(GenH15,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH16[j]= meanG(GenH16)
  yH16[j]= genicVarG(GenH16)
  
  GenH16 = setPheno(GenH16, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH17 = selectOP(GenH16,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH17[j]=meanG(GenH17)
  yH17[j]= genicVarG(GenH17)
  
  GenH17 = setPheno(GenH17, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH18 = selectOP(GenH17,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH18[j]= meanG(GenH18)
  yH18[j]= genicVarG(GenH18)
  
  GenH18 = setPheno(GenH18, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH19 = selectOP(GenH18,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH19[j]= meanG(GenH19)
  yH19[j]= genicVarG(GenH19)
  
  GenH19 = setPheno(GenH19, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH20 = selectOP(GenH19,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH20[j]= meanG(GenH20)
  yH20[j]= genicVarG(GenH20)
  
  GenH20 = setPheno(GenH20, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH21 = selectOP(GenH20,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH21[j]= meanG(GenH21)
  yH21[j]= genicVarG(GenH21)
  
  GenH21 = setPheno(GenH21, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH22 = selectOP(GenH21,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH22[j]= meanG(GenH22)
  yH22[j]= genicVarG(GenH22)
  
  GenH22 = setPheno(GenH22, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH23 = selectOP(GenH22,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH23[j]= meanG(GenH23)
  yH23[j]= genicVarG(GenH23)
  
  GenH23 = setPheno(GenH23, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH24 = selectOP(GenH23,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH24[j]= meanG(GenH24)
  yH24[j]= genicVarG(GenH24)
  
  GenH24 = setPheno(GenH24, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH25 = selectOP(GenH24,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH25[j]= meanG(GenH25)
  yH25[j]= genicVarG(GenH25)
  
  GenH25 = setPheno(GenH25, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH26 = selectOP(GenH25,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH26[j]= meanG(GenH26)
  yH26[j]= genicVarG(GenH26)
  
  GenH26 = setPheno(GenH26, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH27 = selectOP(GenH26,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH27[j]= meanG(GenH27)
  yH27[j]= genicVarG(GenH27)
  
  GenH27 = setPheno(GenH27, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH28 = selectOP(GenH27, nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH28[j]= meanG(GenH28)
  yH28[j]= genicVarG(GenH28)
  
  GenH28 = setPheno(GenH28, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH29 = selectOP(GenH28,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH29[j]= meanG(GenH29)
  yH29[j]= genicVarG(GenH29)
  
  GenH29 = setPheno(GenH29, varE=f, p=runif(1)) #Sets a phenotyHpe using the GxHE model
  GenH30 = selectOP(GenH29,nInd=selection8,nSeeds=selectedSeeds8,probSelf=fabaSelf8,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xH30[j]= meanG(GenH30)
  yH30[j]= genicVarG(GenH30)
}

GGH1_S8=mean(xH1);GGH2_S8=mean(xH2);GGH3_S8=mean(xH3);GGH4_S8=mean(xH4);GGH5_S8=mean(xH5);GGH6_S8=mean(xH6);GGH7_S8=mean(xH7);GGH8_S8=mean(xH8);GGH9_S8=mean(xH9);GGH10_S8=mean(xH10)
GGH11_S8=mean(xH11);GGH12_S8=mean(xH12);GGH13_S8=mean(xH13);GGH14_S8=mean(xH14);GGH15_S8=mean(xH15);GGH16_S8=mean(xH16);GGH17_S8=mean(xH17);GGH18_S8=mean(xH18);GGH19_S8=mean(xH19);GGH20_S8=mean(xH20)
GGH21_S8=mean(xH21);GGH22_S8=mean(xH22);GGH23_S8=mean(xH23);GGH24_S8=mean(xH24);GGH25_S8=mean(xH25);GGH26_S8=mean(xH26);GGH27_S8=mean(xH27);GGH28_S8=mean(xH28);GGH29_S8=mean(xH29);GGH30_S8=mean(xH30)

GVH1_S8=mean(yH1);GVH2_S8=mean(yH2);GVH3_S8=mean(yH3);GVH4_S8=mean(yH4);GVH5_S8=mean(yH5);GVH6_S8=mean(yH6);GVH7_S8=mean(yH7);GVH8_S8=mean(yH8);GVH9_S8=mean(yH9);GVH10_S8=mean(yH10)
GVH11_S8=mean(yH11);GVH12_S8=mean(yH12);GVH13_S8=mean(yH13);GVH14_S8=mean(yH14);GVH15_S8=mean(yH15);GVH16_S8=mean(yH16);GVH17_S8=mean(yH17);GVH18_S8=mean(yH18);GVH19_S8=mean(yH19);GVH20_S8=mean(yH20)
GVH21_S8=mean(yH21);GVH22_S8=mean(yH22);GVH23_S8=mean(yH23);GVH24_S8=mean(yH24);GVH25_S8=mean(yH25);GVH26_S8=mean(yH26);GVH27_S8=mean(yH27);GVH28_S8=mean(yH28);GVH29_S8=mean(yH29);GVH30_S8=mean(yH30)



Genetic_gain_S8<-c(GGH1_S8,GGH2_S8,GGH3_S8,GGH4_S8,GGH5_S8,GGH6_S8,GGH7_S8,GGH8_S8,GGH9_S8,GGH10_S8,GGH11_S8,GGH12_S8,GGH13_S8,GGH14_S8,GGH15_S8,GGH16_S8,GGH17_S8,GGH18_S8,GGH19_S8,GGH20_S8,GGH21_S8,GGH22_S8,GGH23_S8,GGH24_S8,GGH25_S8,GGH26_S8,GGH27_S8,GGH28_S8,GGH29_S8,GGH30_S8)
Genetic_variation_S8<-c(GVH1_S8,GVH2_S8,GVH3_S8,GVH4_S8,GVH5_S8,GVH6_S8,GVH7_S8,GVH8_S8,GVH9_S8,GVH10_S8,GVH11_S8,GVH12_S8,GVH13_S8,GVH14_S8,GVH15_S8,GVH16_S8,GVH17_S8,GVH18_S8,GVH19_S8,GVH20_S8,GVH21_S8,GVH22_S8,GVH23_S8,GVH24_S8,GVH25_S8,GVH26_S8,GVH27_S8,GVH28_S8,GVH29_S8,GVH30_S8)
par(mfrow=c(2,1))
plot(Genetic_gain_S8,main="scenario 8",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S8)
plot(Genetic_variation_S8,main="scenario 8",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S8)
library(lattice)
Scenario8<-c(Genetic_gain_S8,Genetic_variation_S8)
write.csv(Scenario8,"Scenario8.csv")
xH_Scenario8<-data.frame(xH1,xH2,xH3,xH4,xH5,xH6,xH7,xH8,xH9,xH10,xH11,xH12,xH13,xH14,xH15,xH16,xH17,xH18,xH19,xH20,xH21,xH22,xH23,xH24,xH25,xH26,xH27,xH28,xH29,xH30)
write.csv(xH_Scenario8,"xH_scenario8.csv")
yH_Scenario8<-data.frame(yH1,yH2,yH3,yH4,yH5,yH6,yH7,yH8,yH9,yH10,yH11,yH12,yH13,yH14,yH15,yH16,yH17,yH18,yH19,yH20,yH21,yH22,yH23,yH24,yH25,yH26,yH27,yH28,yH29,yH30)
write.csv(yH_Scenario8,"yH_scenario8.csv")

######Scenario 9 for selection of 2000 best plants in each cycle with 10 seeds per plant to generate a pop of 20000 for the next cycle#####
selection9=2000 ; selectedSeeds9=10 ; fabaSelf9=0.25

xI1 = rep(0,n); yI1=rep(0,n)
xI2 = rep(0,n); yI2=rep(0,n)
xI3 = rep(0,n); yI3=rep(0,n)
xI4 = rep(0,n); yI4=rep(0,n)
xI5 = rep(0,n); yI5=rep(0,n)
xI6 = rep(0,n); yI6=rep(0,n)
xI7 = rep(0,n); yI7=rep(0,n)
xI8 = rep(0,n); yI8=rep(0,n)
xI9 = rep(0,n); yI9=rep(0,n)
xI10 = rep(0,n); yI10=rep(0,n)
xI11 = rep(0,n); yI11=rep(0,n)
xI12 = rep(0,n); yI12=rep(0,n)
xI13 = rep(0,n); yI13=rep(0,n)
xI14 = rep(0,n); yI14=rep(0,n)
xI15 = rep(0,n); yI15=rep(0,n)
xI16 = rep(0,n); yI16=rep(0,n)
xI17 = rep(0,n); yI17=rep(0,n)
xI18 = rep(0,n); yI18=rep(0,n)
xI19 = rep(0,n); yI19=rep(0,n)
xI20 = rep(0,n); yI20=rep(0,n)
xI21 = rep(0,n); yI21=rep(0,n)
xI22 = rep(0,n); yI22=rep(0,n)
xI23 = rep(0,n); yI23=rep(0,n)
xI24 = rep(0,n); yI24=rep(0,n)
xI25 = rep(0,n); yI25=rep(0,n)
xI26 = rep(0,n); yI26=rep(0,n)
xI27 = rep(0,n); yI27=rep(0,n)
xI28 = rep(0,n); yI28=rep(0,n)
xI29 = rep(0,n); yI29=rep(0,n)
xI30 = rep(0,n); yI30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI1 = selectOP(BasePop1,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI1[j]= meanG(GenI1)
  yI1[j]= genicVarG(GenI1)
  
  GenI1 = setPheno(GenI1, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI2 = selectOP(GenI1,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI2[j]= meanG(GenI2)
  yI2[j]= genicVarG(GenI2)
  
  GenI2 = setPheno(GenI2, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI3 = selectOP(GenI2,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI3[j]=meanG(GenI3)
  yI3[j]= genicVarG(GenI3)
  
  GenI3 = setPheno(GenI3, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI4 = selectOP(GenI3,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI4[j]=meanG(GenI4)
  yI4[j]= genicVarG(GenI4)
  
  GenI4 = setPheno(GenI4, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI5 = selectOP(GenI4,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI5[j]= meanG(GenI5)
  yI5[j]= genicVarG(GenI5)
  
  GenI5 = setPheno(GenI5, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI6 = selectOP(GenI5,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI6[j]= meanG(GenI6)
  yI6[j]= genicVarG(GenI6)
  
  GenI6 = setPheno(GenI6, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI7 = selectOP(GenI6,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI7[j]= meanG(GenI7)
  yI7[j]= genicVarG(GenI7)
  
  GenI7 = setPheno(GenI7, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI8 = selectOP(GenI7,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI8[j]= meanG(GenI8)
  yI8[j]= genicVarG(GenI8)
  
  GenI8 = setPheno(GenI8, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI9 = selectOP(GenI8,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI9[j]= meanG(GenI9)
  yI9[j]= genicVarG(GenI9)
  
  GenI9 = setPheno(GenI9, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI10 = selectOP(GenI9,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI10[j]= meanG(GenI10)
  yI10[j]= genicVarG(GenI10)
  
  GenI10 = setPheno(GenI10, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI11 = selectOP(GenI10,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI11[j]= meanG(GenI11)
  yI11[j]= genicVarG(GenI11)
  
  GenI11 = setPheno(GenI11, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI12 = selectOP(GenI11,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI12[j]= meanG(GenI12)
  yI12[j]= genicVarG(GenI12)
  
  GenI12 = setPheno(GenI12, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI13 = selectOP(GenI12,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI13[j]= meanG(GenI13)
  yI13[j]= genicVarG(GenI13)
  
  GenI13 = setPheno(GenI13, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI14 = selectOP(GenI13,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI14[j]= meanG(GenI14)
  yI14[j]= genicVarG(GenI14)
  
  GenI14 = setPheno(GenI14, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI15 = selectOP(GenI14,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI15[j]= meanG(GenI15)
  yI15[j]= genicVarG(GenI15)
  
  GenI15 = setPheno(GenI15, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI16 = selectOP(GenI15,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI16[j]= meanG(GenI16)
  yI16[j]= genicVarG(GenI16)
  
  GenI16 = setPheno(GenI16, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI17 = selectOP(GenI16,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI17[j]=meanG(GenI17)
  yI17[j]= genicVarG(GenI17)
  
  GenI17 = setPheno(GenI17, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI18 = selectOP(GenI17,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI18[j]= meanG(GenI18)
  yI18[j]= genicVarG(GenI18)
  
  GenI18 = setPheno(GenI18, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI19 = selectOP(GenI18,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI19[j]= meanG(GenI19)
  yI19[j]= genicVarG(GenI19)
  
  GenI19 = setPheno(GenI19, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI20 = selectOP(GenI19,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI20[j]= meanG(GenI20)
  yI20[j]= genicVarG(GenI20)
  
  GenI20 = setPheno(GenI20, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI21 = selectOP(GenI20,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI21[j]= meanG(GenI21)
  yI21[j]= genicVarG(GenI21)
  
  GenI21 = setPheno(GenI21, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI22 = selectOP(GenI21,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI22[j]= meanG(GenI22)
  yI22[j]= genicVarG(GenI22)
  
  GenI22 = setPheno(GenI22, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI23 = selectOP(GenI22,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI23[j]= meanG(GenI23)
  yI23[j]= genicVarG(GenI23)
  
  GenI23 = setPheno(GenI23, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI24 = selectOP(GenI23,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI24[j]= meanG(GenI24)
  yI24[j]= genicVarG(GenI24)
  
  GenI24 = setPheno(GenI24, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI25 = selectOP(GenI24,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI25[j]= meanG(GenI25)
  yI25[j]= genicVarG(GenI25)
  
  GenI25 = setPheno(GenI25, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI26 = selectOP(GenI25,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI26[j]= meanG(GenI26)
  yI26[j]= genicVarG(GenI26)
  
  GenI26 = setPheno(GenI26, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI27 = selectOP(GenI26,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI27[j]= meanG(GenI27)
  yI27[j]= genicVarG(GenI27)
  
  GenI27 = setPheno(GenI27, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI28 = selectOP(GenI27, nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI28[j]= meanG(GenI28)
  yI28[j]= genicVarG(GenI28)
  
  GenI28 = setPheno(GenI28, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI29 = selectOP(GenI28,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI29[j]= meanG(GenI29)
  yI29[j]= genicVarG(GenI29)
  
  GenI29 = setPheno(GenI29, varE=f, p=runif(1)) #Sets a phenotyIpe using the GxIE model
  GenI30 = selectOP(GenI29,nInd=selection9,nSeeds=selectedSeeds9,probSelf=fabaSelf9,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xI30[j]= meanG(GenI30)
  yI30[j]= genicVarG(GenI30)
}

GGI1_S9=mean(xI1);GGI2_S9=mean(xI2);GGI3_S9=mean(xI3);GGI4_S9=mean(xI4);GGI5_S9=mean(xI5);GGI6_S9=mean(xI6);GGI7_S9=mean(xI7);GGI8_S9=mean(xI8);GGI9_S9=mean(xI9);GGI10_S9=mean(xI10)
GGI11_S9=mean(xI11);GGI12_S9=mean(xI12);GGI13_S9=mean(xI13);GGI14_S9=mean(xI14);GGI15_S9=mean(xI15);GGI16_S9=mean(xI16);GGI17_S9=mean(xI17);GGI18_S9=mean(xI18);GGI19_S9=mean(xI19);GGI20_S9=mean(xI20)
GGI21_S9=mean(xI21);GGI22_S9=mean(xI22);GGI23_S9=mean(xI23);GGI24_S9=mean(xI24);GGI25_S9=mean(xI25);GGI26_S9=mean(xI26);GGI27_S9=mean(xI27);GGI28_S9=mean(xI28);GGI29_S9=mean(xI29);GGI30_S9=mean(xI30)

GVI1_S9=mean(yI1);GVI2_S9=mean(yI2);GVI3_S9=mean(yI3);GVI4_S9=mean(yI4);GVI5_S9=mean(yI5);GVI6_S9=mean(yI6);GVI7_S9=mean(yI7);GVI8_S9=mean(yI8);GVI9_S9=mean(yI9);GVI10_S9=mean(yI10)
GVI11_S9=mean(yI11);GVI12_S9=mean(yI12);GVI13_S9=mean(yI13);GVI14_S9=mean(yI14);GVI15_S9=mean(yI15);GVI16_S9=mean(yI16);GVI17_S9=mean(yI17);GVI18_S9=mean(yI18);GVI19_S9=mean(yI19);GVI20_S9=mean(yI20)
GVI21_S9=mean(yI21);GVI22_S9=mean(yI22);GVI23_S9=mean(yI23);GVI24_S9=mean(yI24);GVI25_S9=mean(yI25);GVI26_S9=mean(yI26);GVI27_S9=mean(yI27);GVI28_S9=mean(yI28);GVI29_S9=mean(yI29);GVI30_S9=mean(yI30)



Genetic_gain_S9<-c(GGI1_S9,GGI2_S9,GGI3_S9,GGI4_S9,GGI5_S9,GGI6_S9,GGI7_S9,GGI8_S9,GGI9_S9,GGI10_S9,GGI11_S9,GGI12_S9,GGI13_S9,GGI14_S9,GGI15_S9,GGI16_S9,GGI17_S9,GGI18_S9,GGI19_S9,GGI20_S9,GGI21_S9,GGI22_S9,GGI23_S9,GGI24_S9,GGI25_S9,GGI26_S9,GGI27_S9,GGI28_S9,GGI29_S9,GGI30_S9)
Genetic_variation_S9<-c(GVI1_S9,GVI2_S9,GVI3_S9,GVI4_S9,GVI5_S9,GVI6_S9,GVI7_S9,GVI8_S9,GVI9_S9,GVI10_S9,GVI11_S9,GVI12_S9,GVI13_S9,GVI14_S9,GVI15_S9,GVI16_S9,GVI17_S9,GVI18_S9,GVI19_S9,GVI20_S9,GVI21_S9,GVI22_S9,GVI23_S9,GVI24_S9,GVI25_S9,GVI26_S9,GVI27_S9,GVI28_S9,GVI29_S9,GVI30_S9)
par(mfrow=c(2,1))
plot(Genetic_gain_S9,main="scenario 9",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S9)
plot(Genetic_variation_S9,main="scenario 9",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S9)
library(lattice)
Scenario9<-c(Genetic_gain_S9,Genetic_variation_S9)
write.csv(Scenario9,"Scenario9.csv")
xI_Scenario9<-data.frame(xI1,xI2,xI3,xI4,xI5,xI6,xI7,xI8,xI9,xI10,xI11,xI12,xI13,xI14,xI15,xI16,xI17,xI18,xI19,xI20,xI21,xI22,xI23,xI24,xI25,xI26,xI27,xI28,xI29,xI30)
write.csv(xI_Scenario9,"xI_scenario9.csv")
yI_Scenario9<-data.frame(yI1,yI2,yI3,yI4,yI5,yI6,yI7,yI8,yI9,yI10,yI11,yI12,yI13,yI14,yI15,yI16,yI17,yI18,yI19,yI20,yI21,yI22,yI23,yI24,yI25,yI26,yI27,yI28,yI29,yI30)
write.csv(yI_Scenario9,"yI_scenario9.csv")

######Scenario 10 for selection of 40 best plants in each cycle with 50 seeds per plant to generate a pop of 2000 for the next cycle#####
selection10=40 ; selectedSeeds10=50 ; fabaSelf10=0.7

xJ1 = rep(0,n); yJ1=rep(0,n)
xJ2 = rep(0,n); yJ2=rep(0,n)
xJ3 = rep(0,n); yJ3=rep(0,n)
xJ4 = rep(0,n); yJ4=rep(0,n)
xJ5 = rep(0,n); yJ5=rep(0,n)
xJ6 = rep(0,n); yJ6=rep(0,n)
xJ7 = rep(0,n); yJ7=rep(0,n)
xJ8 = rep(0,n); yJ8=rep(0,n)
xJ9 = rep(0,n); yJ9=rep(0,n)
xJ10 = rep(0,n); yJ10=rep(0,n)
xJ11 = rep(0,n); yJ11=rep(0,n)
xJ12 = rep(0,n); yJ12=rep(0,n)
xJ13 = rep(0,n); yJ13=rep(0,n)
xJ14 = rep(0,n); yJ14=rep(0,n)
xJ15 = rep(0,n); yJ15=rep(0,n)
xJ16 = rep(0,n); yJ16=rep(0,n)
xJ17 = rep(0,n); yJ17=rep(0,n)
xJ18 = rep(0,n); yJ18=rep(0,n)
xJ19 = rep(0,n); yJ19=rep(0,n)
xJ20 = rep(0,n); yJ20=rep(0,n)
xJ21 = rep(0,n); yJ21=rep(0,n)
xJ22 = rep(0,n); yJ22=rep(0,n)
xJ23 = rep(0,n); yJ23=rep(0,n)
xJ24 = rep(0,n); yJ24=rep(0,n)
xJ25 = rep(0,n); yJ25=rep(0,n)
xJ26 = rep(0,n); yJ26=rep(0,n)
xJ27 = rep(0,n); yJ27=rep(0,n)
xJ28 = rep(0,n); yJ28=rep(0,n)
xJ29 = rep(0,n); yJ29=rep(0,n)
xJ30 = rep(0,n); yJ30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ1 = selectOP(BasePop1,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ1[j]= meanG(GenJ1)
  yJ1[j]= genicVarG(GenJ1)
  
  GenJ1 = setPheno(GenJ1, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ2 = selectOP(GenJ1,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ2[j]= meanG(GenJ2)
  yJ2[j]= genicVarG(GenJ2)
  
  GenJ2 = setPheno(GenJ2, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ3 = selectOP(GenJ2,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ3[j]=meanG(GenJ3)
  yJ3[j]= genicVarG(GenJ3)
  
  GenJ3 = setPheno(GenJ3, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ4 = selectOP(GenJ3,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ4[j]=meanG(GenJ4)
  yJ4[j]= genicVarG(GenJ4)
  
  GenJ4 = setPheno(GenJ4, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ5 = selectOP(GenJ4,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ5[j]= meanG(GenJ5)
  yJ5[j]= genicVarG(GenJ5)
  
  GenJ5 = setPheno(GenJ5, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ6 = selectOP(GenJ5,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ6[j]= meanG(GenJ6)
  yJ6[j]= genicVarG(GenJ6)
  
  GenJ6 = setPheno(GenJ6, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ7 = selectOP(GenJ6,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ7[j]= meanG(GenJ7)
  yJ7[j]= genicVarG(GenJ7)
  
  GenJ7 = setPheno(GenJ7, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ8 = selectOP(GenJ7,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ8[j]= meanG(GenJ8)
  yJ8[j]= genicVarG(GenJ8)
  
  GenJ8 = setPheno(GenJ8, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ9 = selectOP(GenJ8,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ9[j]= meanG(GenJ9)
  yJ9[j]= genicVarG(GenJ9)
  
  GenJ9 = setPheno(GenJ9, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ10 = selectOP(GenJ9,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ10[j]= meanG(GenJ10)
  yJ10[j]= genicVarG(GenJ10)
  
  GenJ10 = setPheno(GenJ10, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ11 = selectOP(GenJ10,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ11[j]= meanG(GenJ11)
  yJ11[j]= genicVarG(GenJ11)
  
  GenJ11 = setPheno(GenJ11, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ12 = selectOP(GenJ11,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ12[j]= meanG(GenJ12)
  yJ12[j]= genicVarG(GenJ12)
  
  GenJ12 = setPheno(GenJ12, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ13 = selectOP(GenJ12,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ13[j]= meanG(GenJ13)
  yJ13[j]= genicVarG(GenJ13)
  
  GenJ13 = setPheno(GenJ13, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ14 = selectOP(GenJ13,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ14[j]= meanG(GenJ14)
  yJ14[j]= genicVarG(GenJ14)
  
  GenJ14 = setPheno(GenJ14, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ15 = selectOP(GenJ14,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ15[j]= meanG(GenJ15)
  yJ15[j]= genicVarG(GenJ15)
  
  GenJ15 = setPheno(GenJ15, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ16 = selectOP(GenJ15,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ16[j]= meanG(GenJ16)
  yJ16[j]= genicVarG(GenJ16)
  
  GenJ16 = setPheno(GenJ16, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ17 = selectOP(GenJ16,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ17[j]=meanG(GenJ17)
  yJ17[j]= genicVarG(GenJ17)
  
  GenJ17 = setPheno(GenJ17, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ18 = selectOP(GenJ17,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ18[j]= meanG(GenJ18)
  yJ18[j]= genicVarG(GenJ18)
  
  GenJ18 = setPheno(GenJ18, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ19 = selectOP(GenJ18,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ19[j]= meanG(GenJ19)
  yJ19[j]= genicVarG(GenJ19)
  
  GenJ19 = setPheno(GenJ19, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ20 = selectOP(GenJ19,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ20[j]= meanG(GenJ20)
  yJ20[j]= genicVarG(GenJ20)
  
  GenJ20 = setPheno(GenJ20, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ21 = selectOP(GenJ20,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ21[j]= meanG(GenJ21)
  yJ21[j]= genicVarG(GenJ21)
  
  GenJ21 = setPheno(GenJ21, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ22 = selectOP(GenJ21,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ22[j]= meanG(GenJ22)
  yJ22[j]= genicVarG(GenJ22)
  
  GenJ22 = setPheno(GenJ22, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ23 = selectOP(GenJ22,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ23[j]= meanG(GenJ23)
  yJ23[j]= genicVarG(GenJ23)
  
  GenJ23 = setPheno(GenJ23, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ24 = selectOP(GenJ23,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ24[j]= meanG(GenJ24)
  yJ24[j]= genicVarG(GenJ24)
  
  GenJ24 = setPheno(GenJ24, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ25 = selectOP(GenJ24,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ25[j]= meanG(GenJ25)
  yJ25[j]= genicVarG(GenJ25)
  
  GenJ25 = setPheno(GenJ25, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ26 = selectOP(GenJ25,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ26[j]= meanG(GenJ26)
  yJ26[j]= genicVarG(GenJ26)
  
  GenJ26 = setPheno(GenJ26, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ27 = selectOP(GenJ26,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ27[j]= meanG(GenJ27)
  yJ27[j]= genicVarG(GenJ27)
  
  GenJ27 = setPheno(GenJ27, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ28 = selectOP(GenJ27, nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ28[j]= meanG(GenJ28)
  yJ28[j]= genicVarG(GenJ28)
  
  GenJ28 = setPheno(GenJ28, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ29 = selectOP(GenJ28,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ29[j]= meanG(GenJ29)
  yJ29[j]= genicVarG(GenJ29)
  
  GenJ29 = setPheno(GenJ29, varE=f, p=runif(1)) #Sets a phenotyJpe using the GxJE model
  GenJ30 = selectOP(GenJ29,nInd=selection10,nSeeds=selectedSeeds10,probSelf=fabaSelf10,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xJ30[j]= meanG(GenJ30)
  yJ30[j]= genicVarG(GenJ30)
}

GGJ1_S10=mean(xJ1);GGJ2_S10=mean(xJ2);GGJ3_S10=mean(xJ3);GGJ4_S10=mean(xJ4);GGJ5_S10=mean(xJ5);GGJ6_S10=mean(xJ6);GGJ7_S10=mean(xJ7);GGJ8_S10=mean(xJ8);GGJ9_S10=mean(xJ9);GGJ10_S10=mean(xJ10)
GGJ11_S10=mean(xJ11);GGJ12_S10=mean(xJ12);GGJ13_S10=mean(xJ13);GGJ14_S10=mean(xJ14);GGJ15_S10=mean(xJ15);GGJ16_S10=mean(xJ16);GGJ17_S10=mean(xJ17);GGJ18_S10=mean(xJ18);GGJ19_S10=mean(xJ19);GGJ20_S10=mean(xJ20)
GGJ21_S10=mean(xJ21);GGJ22_S10=mean(xJ22);GGJ23_S10=mean(xJ23);GGJ24_S10=mean(xJ24);GGJ25_S10=mean(xJ25);GGJ26_S10=mean(xJ26);GGJ27_S10=mean(xJ27);GGJ28_S10=mean(xJ28);GGJ29_S10=mean(xJ29);GGJ30_S10=mean(xJ30)

GVJ1_S10=mean(yJ1);GVJ2_S10=mean(yJ2);GVJ3_S10=mean(yJ3);GVJ4_S10=mean(yJ4);GVJ5_S10=mean(yJ5);GVJ6_S10=mean(yJ6);GVJ7_S10=mean(yJ7);GVJ8_S10=mean(yJ8);GVJ9_S10=mean(yJ9);GVJ10_S10=mean(yJ10)
GVJ11_S10=mean(yJ11);GVJ12_S10=mean(yJ12);GVJ13_S10=mean(yJ13);GVJ14_S10=mean(yJ14);GVJ15_S10=mean(yJ15);GVJ16_S10=mean(yJ16);GVJ17_S10=mean(yJ17);GVJ18_S10=mean(yJ18);GVJ19_S10=mean(yJ19);GVJ20_S10=mean(yJ20)
GVJ21_S10=mean(yJ21);GVJ22_S10=mean(yJ22);GVJ23_S10=mean(yJ23);GVJ24_S10=mean(yJ24);GVJ25_S10=mean(yJ25);GVJ26_S10=mean(yJ26);GVJ27_S10=mean(yJ27);GVJ28_S10=mean(yJ28);GVJ29_S10=mean(yJ29);GVJ30_S10=mean(yJ30)



Genetic_gain_S10<-c(GGJ1_S10,GGJ2_S10,GGJ3_S10,GGJ4_S10,GGJ5_S10,GGJ6_S10,GGJ7_S10,GGJ8_S10,GGJ9_S10,GGJ10_S10,GGJ11_S10,GGJ12_S10,GGJ13_S10,GGJ14_S10,GGJ15_S10,GGJ16_S10,GGJ17_S10,GGJ18_S10,GGJ19_S10,GGJ20_S10,GGJ21_S10,GGJ22_S10,GGJ23_S10,GGJ24_S10,GGJ25_S10,GGJ26_S10,GGJ27_S10,GGJ28_S10,GGJ29_S10,GGJ30_S10)
Genetic_variation_S10<-c(GVJ1_S10,GVJ2_S10,GVJ3_S10,GVJ4_S10,GVJ5_S10,GVJ6_S10,GVJ7_S10,GVJ8_S10,GVJ9_S10,GVJ10_S10,GVJ11_S10,GVJ12_S10,GVJ13_S10,GVJ14_S10,GVJ15_S10,GVJ16_S10,GVJ17_S10,GVJ18_S10,GVJ19_S10,GVJ20_S10,GVJ21_S10,GVJ22_S10,GVJ23_S10,GVJ24_S10,GVJ25_S10,GVJ26_S10,GVJ27_S10,GVJ28_S10,GVJ29_S10,GVJ30_S10)
par(mfrow=c(2,1))
plot(Genetic_gain_S10,main="scenario 10",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S10)
plot(Genetic_variation_S10,main="scenario 10",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S10)
library(lattice)
Scenario10<-c(Genetic_gain_S10,Genetic_variation_S10)
write.csv(Scenario10,"Scenario10.csv")
xJ_Scenario10<-data.frame(xJ1,xJ2,xJ3,xJ4,xJ5,xJ6,xJ7,xJ8,xJ9,xJ10,xJ11,xJ12,xJ13,xJ14,xJ15,xJ16,xJ17,xJ18,xJ19,xJ20,xJ21,xJ22,xJ23,xJ24,xJ25,xJ26,xJ27,xJ28,xJ29,xJ30)
write.csv(xJ_Scenario10,"xJ_scenario10.csv")
yJ_Scenario10<-data.frame(yJ1,yJ2,yJ3,yJ4,yJ5,yJ6,yJ7,yJ8,yJ9,yJ10,yJ11,yJ12,yJ13,yJ14,yJ15,yJ16,yJ17,yJ18,yJ19,yJ20,yJ21,yJ22,yJ23,yJ24,yJ25,yJ26,yJ27,yJ28,yJ29,yJ30)
write.csv(yJ_Scenario10,"yJ_scenario10.csv")

######Scenario 11 for selection of 80 best plants in each cycle with 25 seeds per plant to generate a pop of 2000 for the next cycle#####
selection11=80 ; selectedSeeds11=25 ; fabaSelf11=0.7

xK1 = rep(0,n); yK1=rep(0,n)
xK2 = rep(0,n); yK2=rep(0,n)
xK3 = rep(0,n); yK3=rep(0,n)
xK4 = rep(0,n); yK4=rep(0,n)
xK5 = rep(0,n); yK5=rep(0,n)
xK6 = rep(0,n); yK6=rep(0,n)
xK7 = rep(0,n); yK7=rep(0,n)
xK8 = rep(0,n); yK8=rep(0,n)
xK9 = rep(0,n); yK9=rep(0,n)
xK10 = rep(0,n); yK10=rep(0,n)
xK11 = rep(0,n); yK11=rep(0,n)
xK12 = rep(0,n); yK12=rep(0,n)
xK13 = rep(0,n); yK13=rep(0,n)
xK14 = rep(0,n); yK14=rep(0,n)
xK15 = rep(0,n); yK15=rep(0,n)
xK16 = rep(0,n); yK16=rep(0,n)
xK17 = rep(0,n); yK17=rep(0,n)
xK18 = rep(0,n); yK18=rep(0,n)
xK19 = rep(0,n); yK19=rep(0,n)
xK20 = rep(0,n); yK20=rep(0,n)
xK21 = rep(0,n); yK21=rep(0,n)
xK22 = rep(0,n); yK22=rep(0,n)
xK23 = rep(0,n); yK23=rep(0,n)
xK24 = rep(0,n); yK24=rep(0,n)
xK25 = rep(0,n); yK25=rep(0,n)
xK26 = rep(0,n); yK26=rep(0,n)
xK27 = rep(0,n); yK27=rep(0,n)
xK28 = rep(0,n); yK28=rep(0,n)
xK29 = rep(0,n); yK29=rep(0,n)
xK30 = rep(0,n); yK30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK1 = selectOP(BasePop1,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK1[j]= meanG(GenK1)
  yK1[j]= genicVarG(GenK1)
  
  GenK1 = setPheno(GenK1, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK2 = selectOP(GenK1,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK2[j]= meanG(GenK2)
  yK2[j]= genicVarG(GenK2)
  
  GenK2 = setPheno(GenK2, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK3 = selectOP(GenK2,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK3[j]=meanG(GenK3)
  yK3[j]= genicVarG(GenK3)
  
  GenK3 = setPheno(GenK3, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK4 = selectOP(GenK3,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK4[j]=meanG(GenK4)
  yK4[j]= genicVarG(GenK4)
  
  GenK4 = setPheno(GenK4, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK5 = selectOP(GenK4,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK5[j]= meanG(GenK5)
  yK5[j]= genicVarG(GenK5)
  
  GenK5 = setPheno(GenK5, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK6 = selectOP(GenK5,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK6[j]= meanG(GenK6)
  yK6[j]= genicVarG(GenK6)
  
  GenK6 = setPheno(GenK6, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK7 = selectOP(GenK6,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK7[j]= meanG(GenK7)
  yK7[j]= genicVarG(GenK7)
  
  GenK7 = setPheno(GenK7, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK8 = selectOP(GenK7,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK8[j]= meanG(GenK8)
  yK8[j]= genicVarG(GenK8)
  
  GenK8 = setPheno(GenK8, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK9 = selectOP(GenK8,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK9[j]= meanG(GenK9)
  yK9[j]= genicVarG(GenK9)
  
  GenK9 = setPheno(GenK9, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK10 = selectOP(GenK9,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK10[j]= meanG(GenK10)
  yK10[j]= genicVarG(GenK10)
  
  GenK10 = setPheno(GenK10, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK11 = selectOP(GenK10,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK11[j]= meanG(GenK11)
  yK11[j]= genicVarG(GenK11)
  
  GenK11 = setPheno(GenK11, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK12 = selectOP(GenK11,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK12[j]= meanG(GenK12)
  yK12[j]= genicVarG(GenK12)
  
  GenK12 = setPheno(GenK12, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK13 = selectOP(GenK12,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK13[j]= meanG(GenK13)
  yK13[j]= genicVarG(GenK13)
  
  GenK13 = setPheno(GenK13, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK14 = selectOP(GenK13,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK14[j]= meanG(GenK14)
  yK14[j]= genicVarG(GenK14)
  
  GenK14 = setPheno(GenK14, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK15 = selectOP(GenK14,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK15[j]= meanG(GenK15)
  yK15[j]= genicVarG(GenK15)
  
  GenK15 = setPheno(GenK15, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK16 = selectOP(GenK15,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK16[j]= meanG(GenK16)
  yK16[j]= genicVarG(GenK16)
  
  GenK16 = setPheno(GenK16, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK17 = selectOP(GenK16,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK17[j]=meanG(GenK17)
  yK17[j]= genicVarG(GenK17)
  
  GenK17 = setPheno(GenK17, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK18 = selectOP(GenK17,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK18[j]= meanG(GenK18)
  yK18[j]= genicVarG(GenK18)
  
  GenK18 = setPheno(GenK18, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK19 = selectOP(GenK18,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK19[j]= meanG(GenK19)
  yK19[j]= genicVarG(GenK19)
  
  GenK19 = setPheno(GenK19, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK20 = selectOP(GenK19,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK20[j]= meanG(GenK20)
  yK20[j]= genicVarG(GenK20)
  
  GenK20 = setPheno(GenK20, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK21 = selectOP(GenK20,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK21[j]= meanG(GenK21)
  yK21[j]= genicVarG(GenK21)
  
  GenK21 = setPheno(GenK21, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK22 = selectOP(GenK21,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK22[j]= meanG(GenK22)
  yK22[j]= genicVarG(GenK22)
  
  GenK22 = setPheno(GenK22, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK23 = selectOP(GenK22,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK23[j]= meanG(GenK23)
  yK23[j]= genicVarG(GenK23)
  
  GenK23 = setPheno(GenK23, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK24 = selectOP(GenK23,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK24[j]= meanG(GenK24)
  yK24[j]= genicVarG(GenK24)
  
  GenK24 = setPheno(GenK24, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK25 = selectOP(GenK24,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK25[j]= meanG(GenK25)
  yK25[j]= genicVarG(GenK25)
  
  GenK25 = setPheno(GenK25, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK26 = selectOP(GenK25,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK26[j]= meanG(GenK26)
  yK26[j]= genicVarG(GenK26)
  
  GenK26 = setPheno(GenK26, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK27 = selectOP(GenK26,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK27[j]= meanG(GenK27)
  yK27[j]= genicVarG(GenK27)
  
  GenK27 = setPheno(GenK27, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK28 = selectOP(GenK27, nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK28[j]= meanG(GenK28)
  yK28[j]= genicVarG(GenK28)
  
  GenK28 = setPheno(GenK28, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK29 = selectOP(GenK28,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK29[j]= meanG(GenK29)
  yK29[j]= genicVarG(GenK29)
  
  GenK29 = setPheno(GenK29, varE=f, p=runif(1)) #Sets a phenotyKpe using the GxKE model
  GenK30 = selectOP(GenK29,nInd=selection11,nSeeds=selectedSeeds11,probSelf=fabaSelf11,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xK30[j]= meanG(GenK30)
  yK30[j]= genicVarG(GenK30)
}

GGK1_S11=mean(xK1);GGK2_S11=mean(xK2);GGK3_S11=mean(xK3);GGK4_S11=mean(xK4);GGK5_S11=mean(xK5);GGK6_S11=mean(xK6);GGK7_S11=mean(xK7);GGK8_S11=mean(xK8);GGK9_S11=mean(xK9);GGK10_S11=mean(xK10)
GGK11_S11=mean(xK11);GGK12_S11=mean(xK12);GGK13_S11=mean(xK13);GGK14_S11=mean(xK14);GGK15_S11=mean(xK15);GGK16_S11=mean(xK16);GGK17_S11=mean(xK17);GGK18_S11=mean(xK18);GGK19_S11=mean(xK19);GGK20_S11=mean(xK20)
GGK21_S11=mean(xK21);GGK22_S11=mean(xK22);GGK23_S11=mean(xK23);GGK24_S11=mean(xK24);GGK25_S11=mean(xK25);GGK26_S11=mean(xK26);GGK27_S11=mean(xK27);GGK28_S11=mean(xK28);GGK29_S11=mean(xK29);GGK30_S11=mean(xK30)

GVK1_S11=mean(yK1);GVK2_S11=mean(yK2);GVK3_S11=mean(yK3);GVK4_S11=mean(yK4);GVK5_S11=mean(yK5);GVK6_S11=mean(yK6);GVK7_S11=mean(yK7);GVK8_S11=mean(yK8);GVK9_S11=mean(yK9);GVK10_S11=mean(yK10)
GVK11_S11=mean(yK11);GVK12_S11=mean(yK12);GVK13_S11=mean(yK13);GVK14_S11=mean(yK14);GVK15_S11=mean(yK15);GVK16_S11=mean(yK16);GVK17_S11=mean(yK17);GVK18_S11=mean(yK18);GVK19_S11=mean(yK19);GVK20_S11=mean(yK20)
GVK21_S11=mean(yK21);GVK22_S11=mean(yK22);GVK23_S11=mean(yK23);GVK24_S11=mean(yK24);GVK25_S11=mean(yK25);GVK26_S11=mean(yK26);GVK27_S11=mean(yK27);GVK28_S11=mean(yK28);GVK29_S11=mean(yK29);GVK30_S11=mean(yK30)



Genetic_gain_S11<-c(GGK1_S11,GGK2_S11,GGK3_S11,GGK4_S11,GGK5_S11,GGK6_S11,GGK7_S11,GGK8_S11,GGK9_S11,GGK10_S11,GGK11_S11,GGK12_S11,GGK13_S11,GGK14_S11,GGK15_S11,GGK16_S11,GGK17_S11,GGK18_S11,GGK19_S11,GGK20_S11,GGK21_S11,GGK22_S11,GGK23_S11,GGK24_S11,GGK25_S11,GGK26_S11,GGK27_S11,GGK28_S11,GGK29_S11,GGK30_S11)
Genetic_variation_S11<-c(GVK1_S11,GVK2_S11,GVK3_S11,GVK4_S11,GVK5_S11,GVK6_S11,GVK7_S11,GVK8_S11,GVK9_S11,GVK10_S11,GVK11_S11,GVK12_S11,GVK13_S11,GVK14_S11,GVK15_S11,GVK16_S11,GVK17_S11,GVK18_S11,GVK19_S11,GVK20_S11,GVK21_S11,GVK22_S11,GVK23_S11,GVK24_S11,GVK25_S11,GVK26_S11,GVK27_S11,GVK28_S11,GVK29_S11,GVK30_S11)
par(mfrow=c(2,1))
plot(Genetic_gain_S11,main="scenario 11",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S11)
plot(Genetic_variation_S11,main="scenario 11",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S11)
library(lattice)
Scenario11<-c(Genetic_gain_S11,Genetic_variation_S11)
write.csv(Scenario11,"Scenario11.csv")
xK_Scenario11<-data.frame(xK1,xK2,xK3,xK4,xK5,xK6,xK7,xK8,xK9,xK10,xK11,xK12,xK13,xK14,xK15,xK16,xK17,xK18,xK19,xK20,xK21,xK22,xK23,xK24,xK25,xK26,xK27,xK28,xK29,xK30)
write.csv(xK_Scenario11,"xK_scenario11.csv")
yK_Scenario11<-data.frame(yK1,yK2,yK3,yK4,yK5,yK6,yK7,yK8,yK9,yK10,yK11,yK12,yK13,yK14,yK15,yK16,yK17,yK18,yK19,yK20,yK21,yK22,yK23,yK24,yK25,yK26,yK27,yK28,yK29,yK30)
write.csv(yK_Scenario11,"yK_scenario11.csv")

######Scenario 12 for selection of 200 best plants in each cycle with 10 seeds per plant to generate a pop of 2000 for the next cycle#####
selection12=200 ; selectedSeeds12=10 ; fabaSelf12=0.7

xL1 = rep(0,n); yL1=rep(0,n)
xL2 = rep(0,n); yL2=rep(0,n)
xL3 = rep(0,n); yL3=rep(0,n)
xL4 = rep(0,n); yL4=rep(0,n)
xL5 = rep(0,n); yL5=rep(0,n)
xL6 = rep(0,n); yL6=rep(0,n)
xL7 = rep(0,n); yL7=rep(0,n)
xL8 = rep(0,n); yL8=rep(0,n)
xL9 = rep(0,n); yL9=rep(0,n)
xL10 = rep(0,n); yL10=rep(0,n)
xL11 = rep(0,n); yL11=rep(0,n)
xL12 = rep(0,n); yL12=rep(0,n)
xL13 = rep(0,n); yL13=rep(0,n)
xL14 = rep(0,n); yL14=rep(0,n)
xL15 = rep(0,n); yL15=rep(0,n)
xL16 = rep(0,n); yL16=rep(0,n)
xL17 = rep(0,n); yL17=rep(0,n)
xL18 = rep(0,n); yL18=rep(0,n)
xL19 = rep(0,n); yL19=rep(0,n)
xL20 = rep(0,n); yL20=rep(0,n)
xL21 = rep(0,n); yL21=rep(0,n)
xL22 = rep(0,n); yL22=rep(0,n)
xL23 = rep(0,n); yL23=rep(0,n)
xL24 = rep(0,n); yL24=rep(0,n)
xL25 = rep(0,n); yL25=rep(0,n)
xL26 = rep(0,n); yL26=rep(0,n)
xL27 = rep(0,n); yL27=rep(0,n)
xL28 = rep(0,n); yL28=rep(0,n)
xL29 = rep(0,n); yL29=rep(0,n)
xL30 = rep(0,n); yL30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL1 = selectOP(BasePop1,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL1[j]= meanG(GenL1)
  yL1[j]= genicVarG(GenL1)
  
  GenL1 = setPheno(GenL1, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL2 = selectOP(GenL1,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL2[j]= meanG(GenL2)
  yL2[j]= genicVarG(GenL2)
  
  GenL2 = setPheno(GenL2, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL3 = selectOP(GenL2,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL3[j]=meanG(GenL3)
  yL3[j]= genicVarG(GenL3)
  
  GenL3 = setPheno(GenL3, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL4 = selectOP(GenL3,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL4[j]=meanG(GenL4)
  yL4[j]= genicVarG(GenL4)
  
  GenL4 = setPheno(GenL4, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL5 = selectOP(GenL4,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL5[j]= meanG(GenL5)
  yL5[j]= genicVarG(GenL5)
  
  GenL5 = setPheno(GenL5, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL6 = selectOP(GenL5,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL6[j]= meanG(GenL6)
  yL6[j]= genicVarG(GenL6)
  
  GenL6 = setPheno(GenL6, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL7 = selectOP(GenL6,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL7[j]= meanG(GenL7)
  yL7[j]= genicVarG(GenL7)
  
  GenL7 = setPheno(GenL7, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL8 = selectOP(GenL7,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL8[j]= meanG(GenL8)
  yL8[j]= genicVarG(GenL8)
  
  GenL8 = setPheno(GenL8, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL9 = selectOP(GenL8,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL9[j]= meanG(GenL9)
  yL9[j]= genicVarG(GenL9)
  
  GenL9 = setPheno(GenL9, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL10 = selectOP(GenL9,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL10[j]= meanG(GenL10)
  yL10[j]= genicVarG(GenL10)
  
  GenL10 = setPheno(GenL10, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL11 = selectOP(GenL10,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL11[j]= meanG(GenL11)
  yL11[j]= genicVarG(GenL11)
  
  GenL11 = setPheno(GenL11, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL12 = selectOP(GenL11,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL12[j]= meanG(GenL12)
  yL12[j]= genicVarG(GenL12)
  
  GenL12 = setPheno(GenL12, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL13 = selectOP(GenL12,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL13[j]= meanG(GenL13)
  yL13[j]= genicVarG(GenL13)
  
  GenL13 = setPheno(GenL13, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL14 = selectOP(GenL13,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL14[j]= meanG(GenL14)
  yL14[j]= genicVarG(GenL14)
  
  GenL14 = setPheno(GenL14, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL15 = selectOP(GenL14,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL15[j]= meanG(GenL15)
  yL15[j]= genicVarG(GenL15)
  
  GenL15 = setPheno(GenL15, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL16 = selectOP(GenL15,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL16[j]= meanG(GenL16)
  yL16[j]= genicVarG(GenL16)
  
  GenL16 = setPheno(GenL16, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL17 = selectOP(GenL16,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL17[j]=meanG(GenL17)
  yL17[j]= genicVarG(GenL17)
  
  GenL17 = setPheno(GenL17, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL18 = selectOP(GenL17,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL18[j]= meanG(GenL18)
  yL18[j]= genicVarG(GenL18)
  
  GenL18 = setPheno(GenL18, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL19 = selectOP(GenL18,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL19[j]= meanG(GenL19)
  yL19[j]= genicVarG(GenL19)
  
  GenL19 = setPheno(GenL19, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL20 = selectOP(GenL19,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL20[j]= meanG(GenL20)
  yL20[j]= genicVarG(GenL20)
  
  GenL20 = setPheno(GenL20, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL21 = selectOP(GenL20,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL21[j]= meanG(GenL21)
  yL21[j]= genicVarG(GenL21)
  
  GenL21 = setPheno(GenL21, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL22 = selectOP(GenL21,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL22[j]= meanG(GenL22)
  yL22[j]= genicVarG(GenL22)
  
  GenL22 = setPheno(GenL22, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL23 = selectOP(GenL22,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL23[j]= meanG(GenL23)
  yL23[j]= genicVarG(GenL23)
  
  GenL23 = setPheno(GenL23, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL24 = selectOP(GenL23,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL24[j]= meanG(GenL24)
  yL24[j]= genicVarG(GenL24)
  
  GenL24 = setPheno(GenL24, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL25 = selectOP(GenL24,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL25[j]= meanG(GenL25)
  yL25[j]= genicVarG(GenL25)
  
  GenL25 = setPheno(GenL25, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL26 = selectOP(GenL25,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL26[j]= meanG(GenL26)
  yL26[j]= genicVarG(GenL26)
  
  GenL26 = setPheno(GenL26, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL27 = selectOP(GenL26,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL27[j]= meanG(GenL27)
  yL27[j]= genicVarG(GenL27)
  
  GenL27 = setPheno(GenL27, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL28 = selectOP(GenL27, nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL28[j]= meanG(GenL28)
  yL28[j]= genicVarG(GenL28)
  
  GenL28 = setPheno(GenL28, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL29 = selectOP(GenL28,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL29[j]= meanG(GenL29)
  yL29[j]= genicVarG(GenL29)
  
  GenL29 = setPheno(GenL29, varE=f, p=runif(1)) #Sets a phenotyLpe using the GxLE model
  GenL30 = selectOP(GenL29,nInd=selection12,nSeeds=selectedSeeds12,probSelf=fabaSelf12,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xL30[j]= meanG(GenL30)
  yL30[j]= genicVarG(GenL30)
}

GGL1_S12=mean(xL1);GGL2_S12=mean(xL2);GGL3_S12=mean(xL3);GGL4_S12=mean(xL4);GGL5_S12=mean(xL5);GGL6_S12=mean(xL6);GGL7_S12=mean(xL7);GGL8_S12=mean(xL8);GGL9_S12=mean(xL9);GGL10_S12=mean(xL10)
GGL11_S12=mean(xL11);GGL12_S12=mean(xL12);GGL13_S12=mean(xL13);GGL14_S12=mean(xL14);GGL15_S12=mean(xL15);GGL16_S12=mean(xL16);GGL17_S12=mean(xL17);GGL18_S12=mean(xL18);GGL19_S12=mean(xL19);GGL20_S12=mean(xL20)
GGL21_S12=mean(xL21);GGL22_S12=mean(xL22);GGL23_S12=mean(xL23);GGL24_S12=mean(xL24);GGL25_S12=mean(xL25);GGL26_S12=mean(xL26);GGL27_S12=mean(xL27);GGL28_S12=mean(xL28);GGL29_S12=mean(xL29);GGL30_S12=mean(xL30)

GVL1_S12=mean(yL1);GVL2_S12=mean(yL2);GVL3_S12=mean(yL3);GVL4_S12=mean(yL4);GVL5_S12=mean(yL5);GVL6_S12=mean(yL6);GVL7_S12=mean(yL7);GVL8_S12=mean(yL8);GVL9_S12=mean(yL9);GVL10_S12=mean(yL10)
GVL11_S12=mean(yL11);GVL12_S12=mean(yL12);GVL13_S12=mean(yL13);GVL14_S12=mean(yL14);GVL15_S12=mean(yL15);GVL16_S12=mean(yL16);GVL17_S12=mean(yL17);GVL18_S12=mean(yL18);GVL19_S12=mean(yL19);GVL20_S12=mean(yL20)
GVL21_S12=mean(yL21);GVL22_S12=mean(yL22);GVL23_S12=mean(yL23);GVL24_S12=mean(yL24);GVL25_S12=mean(yL25);GVL26_S12=mean(yL26);GVL27_S12=mean(yL27);GVL28_S12=mean(yL28);GVL29_S12=mean(yL29);GVL30_S12=mean(yL30)



Genetic_gain_S12<-c(GGL1_S12,GGL2_S12,GGL3_S12,GGL4_S12,GGL5_S12,GGL6_S12,GGL7_S12,GGL8_S12,GGL9_S12,GGL10_S12,GGL11_S12,GGL12_S12,GGL13_S12,GGL14_S12,GGL15_S12,GGL16_S12,GGL17_S12,GGL18_S12,GGL19_S12,GGL20_S12,GGL21_S12,GGL22_S12,GGL23_S12,GGL24_S12,GGL25_S12,GGL26_S12,GGL27_S12,GGL28_S12,GGL29_S12,GGL30_S12)
Genetic_variation_S12<-c(GVL1_S12,GVL2_S12,GVL3_S12,GVL4_S12,GVL5_S12,GVL6_S12,GVL7_S12,GVL8_S12,GVL9_S12,GVL10_S12,GVL11_S12,GVL12_S12,GVL13_S12,GVL14_S12,GVL15_S12,GVL16_S12,GVL17_S12,GVL18_S12,GVL19_S12,GVL20_S12,GVL21_S12,GVL22_S12,GVL23_S12,GVL24_S12,GVL25_S12,GVL26_S12,GVL27_S12,GVL28_S12,GVL29_S12,GVL30_S12)
par(mfrow=c(2,1))
plot(Genetic_gain_S12,main="scenario 12",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S12)
plot(Genetic_variation_S12,main="scenario 12",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S12)
library(lattice)
Scenario12<-c(Genetic_gain_S12,Genetic_variation_S12)
write.csv(Scenario12,"Scenario12.csv")
xL_Scenario12<-data.frame(xL1,xL2,xL3,xL4,xL5,xL6,xL7,xL8,xL9,xL10,xL11,xL12,xL13,xL14,xL15,xL16,xL17,xL18,xL19,xL20,xL21,xL22,xL23,xL24,xL25,xL26,xL27,xL28,xL29,xL30)
write.csv(xL_Scenario12,"xL_scenario12.csv")
yL_Scenario12<-data.frame(yL1,yL2,yL3,yL4,yL5,yL6,yL7,yL8,yL9,yL10,yL11,yL12,yL13,yL14,yL15,yL16,yL17,yL18,yL19,yL20,yL21,yL22,yL23,yL24,yL25,yL26,yL27,yL28,yL29,yL30)
write.csv(yL_Scenario12,"yL_scenario12.csv")

######Scenario 13 for selection of 200 best plants in each cycle with 50 seeds per plant to generate a pop of 10000 for the next cycle#####
selection13=200 ; selectedSeeds13=50 ; fabaSelf13=0.7

xM1 = rep(0,n); yM1=rep(0,n)
xM2 = rep(0,n); yM2=rep(0,n)
xM3 = rep(0,n); yM3=rep(0,n)
xM4 = rep(0,n); yM4=rep(0,n)
xM5 = rep(0,n); yM5=rep(0,n)
xM6 = rep(0,n); yM6=rep(0,n)
xM7 = rep(0,n); yM7=rep(0,n)
xM8 = rep(0,n); yM8=rep(0,n)
xM9 = rep(0,n); yM9=rep(0,n)
xM10 = rep(0,n); yM10=rep(0,n)
xM11 = rep(0,n); yM11=rep(0,n)
xM12 = rep(0,n); yM12=rep(0,n)
xM13 = rep(0,n); yM13=rep(0,n)
xM14 = rep(0,n); yM14=rep(0,n)
xM15 = rep(0,n); yM15=rep(0,n)
xM16 = rep(0,n); yM16=rep(0,n)
xM17 = rep(0,n); yM17=rep(0,n)
xM18 = rep(0,n); yM18=rep(0,n)
xM19 = rep(0,n); yM19=rep(0,n)
xM20 = rep(0,n); yM20=rep(0,n)
xM21 = rep(0,n); yM21=rep(0,n)
xM22 = rep(0,n); yM22=rep(0,n)
xM23 = rep(0,n); yM23=rep(0,n)
xM24 = rep(0,n); yM24=rep(0,n)
xM25 = rep(0,n); yM25=rep(0,n)
xM26 = rep(0,n); yM26=rep(0,n)
xM27 = rep(0,n); yM27=rep(0,n)
xM28 = rep(0,n); yM28=rep(0,n)
xM29 = rep(0,n); yM29=rep(0,n)
xM30 = rep(0,n); yM30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM1 = selectOP(BasePop1,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM1[j]= meanG(GenM1)
  yM1[j]= genicVarG(GenM1)
  
  GenM1 = setPheno(GenM1, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM2 = selectOP(GenM1,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM2[j]= meanG(GenM2)
  yM2[j]= genicVarG(GenM2)
  
  GenM2 = setPheno(GenM2, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM3 = selectOP(GenM2,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM3[j]=meanG(GenM3)
  yM3[j]= genicVarG(GenM3)
  
  GenM3 = setPheno(GenM3, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM4 = selectOP(GenM3,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM4[j]=meanG(GenM4)
  yM4[j]= genicVarG(GenM4)
  
  GenM4 = setPheno(GenM4, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM5 = selectOP(GenM4,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM5[j]= meanG(GenM5)
  yM5[j]= genicVarG(GenM5)
  
  GenM5 = setPheno(GenM5, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM6 = selectOP(GenM5,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM6[j]= meanG(GenM6)
  yM6[j]= genicVarG(GenM6)
  
  GenM6 = setPheno(GenM6, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM7 = selectOP(GenM6,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM7[j]= meanG(GenM7)
  yM7[j]= genicVarG(GenM7)
  
  GenM7 = setPheno(GenM7, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM8 = selectOP(GenM7,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM8[j]= meanG(GenM8)
  yM8[j]= genicVarG(GenM8)
  
  GenM8 = setPheno(GenM8, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM9 = selectOP(GenM8,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM9[j]= meanG(GenM9)
  yM9[j]= genicVarG(GenM9)
  
  GenM9 = setPheno(GenM9, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM10 = selectOP(GenM9,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM10[j]= meanG(GenM10)
  yM10[j]= genicVarG(GenM10)
  
  GenM10 = setPheno(GenM10, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM11 = selectOP(GenM10,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM11[j]= meanG(GenM11)
  yM11[j]= genicVarG(GenM11)
  
  GenM11 = setPheno(GenM11, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM12 = selectOP(GenM11,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM12[j]= meanG(GenM12)
  yM12[j]= genicVarG(GenM12)
  
  GenM12 = setPheno(GenM12, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM13 = selectOP(GenM12,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM13[j]= meanG(GenM13)
  yM13[j]= genicVarG(GenM13)
  
  GenM13 = setPheno(GenM13, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM14 = selectOP(GenM13,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM14[j]= meanG(GenM14)
  yM14[j]= genicVarG(GenM14)
  
  GenM14 = setPheno(GenM14, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM15 = selectOP(GenM14,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM15[j]= meanG(GenM15)
  yM15[j]= genicVarG(GenM15)
  
  GenM15 = setPheno(GenM15, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM16 = selectOP(GenM15,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM16[j]= meanG(GenM16)
  yM16[j]= genicVarG(GenM16)
  
  GenM16 = setPheno(GenM16, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM17 = selectOP(GenM16,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM17[j]=meanG(GenM17)
  yM17[j]= genicVarG(GenM17)
  
  GenM17 = setPheno(GenM17, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM18 = selectOP(GenM17,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM18[j]= meanG(GenM18)
  yM18[j]= genicVarG(GenM18)
  
  GenM18 = setPheno(GenM18, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM19 = selectOP(GenM18,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM19[j]= meanG(GenM19)
  yM19[j]= genicVarG(GenM19)
  
  GenM19 = setPheno(GenM19, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM20 = selectOP(GenM19,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM20[j]= meanG(GenM20)
  yM20[j]= genicVarG(GenM20)
  
  GenM20 = setPheno(GenM20, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM21 = selectOP(GenM20,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM21[j]= meanG(GenM21)
  yM21[j]= genicVarG(GenM21)
  
  GenM21 = setPheno(GenM21, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM22 = selectOP(GenM21,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM22[j]= meanG(GenM22)
  yM22[j]= genicVarG(GenM22)
  
  GenM22 = setPheno(GenM22, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM23 = selectOP(GenM22,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM23[j]= meanG(GenM23)
  yM23[j]= genicVarG(GenM23)
  
  GenM23 = setPheno(GenM23, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM24 = selectOP(GenM23,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM24[j]= meanG(GenM24)
  yM24[j]= genicVarG(GenM24)
  
  GenM24 = setPheno(GenM24, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM25 = selectOP(GenM24,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM25[j]= meanG(GenM25)
  yM25[j]= genicVarG(GenM25)
  
  GenM25 = setPheno(GenM25, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM26 = selectOP(GenM25,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM26[j]= meanG(GenM26)
  yM26[j]= genicVarG(GenM26)
  
  GenM26 = setPheno(GenM26, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM27 = selectOP(GenM26,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM27[j]= meanG(GenM27)
  yM27[j]= genicVarG(GenM27)
  
  GenM27 = setPheno(GenM27, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM28 = selectOP(GenM27, nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM28[j]= meanG(GenM28)
  yM28[j]= genicVarG(GenM28)
  
  GenM28 = setPheno(GenM28, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM29 = selectOP(GenM28,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM29[j]= meanG(GenM29)
  yM29[j]= genicVarG(GenM29)
  
  GenM29 = setPheno(GenM29, varE=f, p=runif(1)) #Sets a phenotyMpe using the GxME model
  GenM30 = selectOP(GenM29,nInd=selection13,nSeeds=selectedSeeds13,probSelf=fabaSelf13,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xM30[j]= meanG(GenM30)
  yM30[j]= genicVarG(GenM30)
}

GGM1_S13=mean(xM1);GGM2_S13=mean(xM2);GGM3_S13=mean(xM3);GGM4_S13=mean(xM4);GGM5_S13=mean(xM5);GGM6_S13=mean(xM6);GGM7_S13=mean(xM7);GGM8_S13=mean(xM8);GGM9_S13=mean(xM9);GGM10_S13=mean(xM10)
GGM11_S13=mean(xM11);GGM12_S13=mean(xM12);GGM13_S13=mean(xM13);GGM14_S13=mean(xM14);GGM15_S13=mean(xM15);GGM16_S13=mean(xM16);GGM17_S13=mean(xM17);GGM18_S13=mean(xM18);GGM19_S13=mean(xM19);GGM20_S13=mean(xM20)
GGM21_S13=mean(xM21);GGM22_S13=mean(xM22);GGM23_S13=mean(xM23);GGM24_S13=mean(xM24);GGM25_S13=mean(xM25);GGM26_S13=mean(xM26);GGM27_S13=mean(xM27);GGM28_S13=mean(xM28);GGM29_S13=mean(xM29);GGM30_S13=mean(xM30)

GVM1_S13=mean(yM1);GVM2_S13=mean(yM2);GVM3_S13=mean(yM3);GVM4_S13=mean(yM4);GVM5_S13=mean(yM5);GVM6_S13=mean(yM6);GVM7_S13=mean(yM7);GVM8_S13=mean(yM8);GVM9_S13=mean(yM9);GVM10_S13=mean(yM10)
GVM11_S13=mean(yM11);GVM12_S13=mean(yM12);GVM13_S13=mean(yM13);GVM14_S13=mean(yM14);GVM15_S13=mean(yM15);GVM16_S13=mean(yM16);GVM17_S13=mean(yM17);GVM18_S13=mean(yM18);GVM19_S13=mean(yM19);GVM20_S13=mean(yM20)
GVM21_S13=mean(yM21);GVM22_S13=mean(yM22);GVM23_S13=mean(yM23);GVM24_S13=mean(yM24);GVM25_S13=mean(yM25);GVM26_S13=mean(yM26);GVM27_S13=mean(yM27);GVM28_S13=mean(yM28);GVM29_S13=mean(yM29);GVM30_S13=mean(yM30)



Genetic_gain_S13<-c(GGM1_S13,GGM2_S13,GGM3_S13,GGM4_S13,GGM5_S13,GGM6_S13,GGM7_S13,GGM8_S13,GGM9_S13,GGM10_S13,GGM11_S13,GGM12_S13,GGM13_S13,GGM14_S13,GGM15_S13,GGM16_S13,GGM17_S13,GGM18_S13,GGM19_S13,GGM20_S13,GGM21_S13,GGM22_S13,GGM23_S13,GGM24_S13,GGM25_S13,GGM26_S13,GGM27_S13,GGM28_S13,GGM29_S13,GGM30_S13)
Genetic_variation_S13<-c(GVM1_S13,GVM2_S13,GVM3_S13,GVM4_S13,GVM5_S13,GVM6_S13,GVM7_S13,GVM8_S13,GVM9_S13,GVM10_S13,GVM11_S13,GVM12_S13,GVM13_S13,GVM14_S13,GVM15_S13,GVM16_S13,GVM17_S13,GVM18_S13,GVM19_S13,GVM20_S13,GVM21_S13,GVM22_S13,GVM23_S13,GVM24_S13,GVM25_S13,GVM26_S13,GVM27_S13,GVM28_S13,GVM29_S13,GVM30_S13)
par(mfrow=c(2,1))
plot(Genetic_gain_S13,main="scenario 13",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S13)
plot(Genetic_variation_S13,main="scenario 13",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S13)
library(lattice)
Scenario13<-c(Genetic_gain_S13,Genetic_variation_S13)
write.csv(Scenario13,"Scenario13.csv")
xM_Scenario13<-data.frame(xM1,xM2,xM3,xM4,xM5,xM6,xM7,xM8,xM9,xM10,xM11,xM12,xM13,xM14,xM15,xM16,xM17,xM18,xM19,xM20,xM21,xM22,xM23,xM24,xM25,xM26,xM27,xM28,xM29,xM30)
write.csv(xM_Scenario13,"xM_scenario13.csv")
yM_Scenario13<-data.frame(yM1,yM2,yM3,yM4,yM5,yM6,yM7,yM8,yM9,yM10,yM11,yM12,yM13,yM14,yM15,yM16,yM17,yM18,yM19,yM20,yM21,yM22,yM23,yM24,yM25,yM26,yM27,yM28,yM29,yM30)
write.csv(yM_Scenario13,"yM_scenario13.csv")

######Scenario 14 for selection of 400 best plants in each cycle with 25 seeds per plant to generate a pop of 10000 for the next cycle#####
selection14=400 ; selectedSeeds14=25 ; fabaSelf14=0.7


xN1 = rep(0,n); yN1=rep(0,n)
xN2 = rep(0,n); yN2=rep(0,n)
xN3 = rep(0,n); yN3=rep(0,n)
xN4 = rep(0,n); yN4=rep(0,n)
xN5 = rep(0,n); yN5=rep(0,n)
xN6 = rep(0,n); yN6=rep(0,n)
xN7 = rep(0,n); yN7=rep(0,n)
xN8 = rep(0,n); yN8=rep(0,n)
xN9 = rep(0,n); yN9=rep(0,n)
xN10 = rep(0,n); yN10=rep(0,n)
xN11 = rep(0,n); yN11=rep(0,n)
xN12 = rep(0,n); yN12=rep(0,n)
xN13 = rep(0,n); yN13=rep(0,n)
xN14 = rep(0,n); yN14=rep(0,n)
xN15 = rep(0,n); yN15=rep(0,n)
xN16 = rep(0,n); yN16=rep(0,n)
xN17 = rep(0,n); yN17=rep(0,n)
xN18 = rep(0,n); yN18=rep(0,n)
xN19 = rep(0,n); yN19=rep(0,n)
xN20 = rep(0,n); yN20=rep(0,n)
xN21 = rep(0,n); yN21=rep(0,n)
xN22 = rep(0,n); yN22=rep(0,n)
xN23 = rep(0,n); yN23=rep(0,n)
xN24 = rep(0,n); yN24=rep(0,n)
xN25 = rep(0,n); yN25=rep(0,n)
xN26 = rep(0,n); yN26=rep(0,n)
xN27 = rep(0,n); yN27=rep(0,n)
xN28 = rep(0,n); yN28=rep(0,n)
xN29 = rep(0,n); yN29=rep(0,n)
xN30 = rep(0,n); yN30=rep(0,n)


for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN1 = selectOP(BasePop1,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN1[j]= meanG(GenN1)
  yN1[j]= genicVarG(GenN1)
  
  GenN1 = setPheno(GenN1, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN2 = selectOP(GenN1,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN2[j]= meanG(GenN2)
  yN2[j]= genicVarG(GenN2)
  
  GenN2 = setPheno(GenN2, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN3 = selectOP(GenN2,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN3[j]=meanG(GenN3)
  yN3[j]= genicVarG(GenN3)
  
  GenN3 = setPheno(GenN3, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN4 = selectOP(GenN3,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN4[j]=meanG(GenN4)
  yN4[j]= genicVarG(GenN4)
  
  GenN4 = setPheno(GenN4, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN5 = selectOP(GenN4,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN5[j]= meanG(GenN5)
  yN5[j]= genicVarG(GenN5)
  
  GenN5 = setPheno(GenN5, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN6 = selectOP(GenN5,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN6[j]= meanG(GenN6)
  yN6[j]= genicVarG(GenN6)
  
  GenN6 = setPheno(GenN6, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN7 = selectOP(GenN6,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN7[j]= meanG(GenN7)
  yN7[j]= genicVarG(GenN7)
  
  GenN7 = setPheno(GenN7, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN8 = selectOP(GenN7,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN8[j]= meanG(GenN8)
  yN8[j]= genicVarG(GenN8)
  
  GenN8 = setPheno(GenN8, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN9 = selectOP(GenN8,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN9[j]= meanG(GenN9)
  yN9[j]= genicVarG(GenN9)
  
  GenN9 = setPheno(GenN9, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN10 = selectOP(GenN9,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN10[j]= meanG(GenN10)
  yN10[j]= genicVarG(GenN10)
  
  GenN10 = setPheno(GenN10, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN11 = selectOP(GenN10,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN11[j]= meanG(GenN11)
  yN11[j]= genicVarG(GenN11)
  
  GenN11 = setPheno(GenN11, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN12 = selectOP(GenN11,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN12[j]= meanG(GenN12)
  yN12[j]= genicVarG(GenN12)
  
  GenN12 = setPheno(GenN12, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN13 = selectOP(GenN12,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN13[j]= meanG(GenN13)
  yN13[j]= genicVarG(GenN13)
  
  GenN13 = setPheno(GenN13, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN14 = selectOP(GenN13,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN14[j]= meanG(GenN14)
  yN14[j]= genicVarG(GenN14)
  
  GenN14 = setPheno(GenN14, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN15 = selectOP(GenN14,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN15[j]= meanG(GenN15)
  yN15[j]= genicVarG(GenN15)
  
  GenN15 = setPheno(GenN15, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN16 = selectOP(GenN15,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN16[j]= meanG(GenN16)
  yN16[j]= genicVarG(GenN16)
  
  GenN16 = setPheno(GenN16, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN17 = selectOP(GenN16,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN17[j]=meanG(GenN17)
  yN17[j]= genicVarG(GenN17)
  
  GenN17 = setPheno(GenN17, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN18 = selectOP(GenN17,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN18[j]= meanG(GenN18)
  yN18[j]= genicVarG(GenN18)
  
  GenN18 = setPheno(GenN18, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN19 = selectOP(GenN18,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN19[j]= meanG(GenN19)
  yN19[j]= genicVarG(GenN19)
  
  GenN19 = setPheno(GenN19, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN20 = selectOP(GenN19,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN20[j]= meanG(GenN20)
  yN20[j]= genicVarG(GenN20)
  
  GenN20 = setPheno(GenN20, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN21 = selectOP(GenN20,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN21[j]= meanG(GenN21)
  yN21[j]= genicVarG(GenN21)
  
  GenN21 = setPheno(GenN21, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN22 = selectOP(GenN21,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN22[j]= meanG(GenN22)
  yN22[j]= genicVarG(GenN22)
  
  GenN22 = setPheno(GenN22, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN23 = selectOP(GenN22,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN23[j]= meanG(GenN23)
  yN23[j]= genicVarG(GenN23)
  
  GenN23 = setPheno(GenN23, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN24 = selectOP(GenN23,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN24[j]= meanG(GenN24)
  yN24[j]= genicVarG(GenN24)
  
  GenN24 = setPheno(GenN24, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN25 = selectOP(GenN24,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN25[j]= meanG(GenN25)
  yN25[j]= genicVarG(GenN25)
  
  GenN25 = setPheno(GenN25, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN26 = selectOP(GenN25,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN26[j]= meanG(GenN26)
  yN26[j]= genicVarG(GenN26)
  
  GenN26 = setPheno(GenN26, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN27 = selectOP(GenN26,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN27[j]= meanG(GenN27)
  yN27[j]= genicVarG(GenN27)
  
  GenN27 = setPheno(GenN27, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN28 = selectOP(GenN27, nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN28[j]= meanG(GenN28)
  yN28[j]= genicVarG(GenN28)
  
  GenN28 = setPheno(GenN28, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN29 = selectOP(GenN28,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN29[j]= meanG(GenN29)
  yN29[j]= genicVarG(GenN29)
  
  GenN29 = setPheno(GenN29, varE=f, p=runif(1)) #Sets a phenotyNpe using the GxNE model
  GenN30 = selectOP(GenN29,nInd=selection14,nSeeds=selectedSeeds14,probSelf=fabaSelf14,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xN30[j]= meanG(GenN30)
  yN30[j]= genicVarG(GenN30)
}

GGN1_S14=mean(xN1);GGN2_S14=mean(xN2);GGN3_S14=mean(xN3);GGN4_S14=mean(xN4);GGN5_S14=mean(xN5);GGN6_S14=mean(xN6);GGN7_S14=mean(xN7);GGN8_S14=mean(xN8);GGN9_S14=mean(xN9);GGN10_S14=mean(xN10)
GGN11_S14=mean(xN11);GGN12_S14=mean(xN12);GGN13_S14=mean(xN13);GGN14_S14=mean(xN14);GGN15_S14=mean(xN15);GGN16_S14=mean(xN16);GGN17_S14=mean(xN17);GGN18_S14=mean(xN18);GGN19_S14=mean(xN19);GGN20_S14=mean(xN20)
GGN21_S14=mean(xN21);GGN22_S14=mean(xN22);GGN23_S14=mean(xN23);GGN24_S14=mean(xN24);GGN25_S14=mean(xN25);GGN26_S14=mean(xN26);GGN27_S14=mean(xN27);GGN28_S14=mean(xN28);GGN29_S14=mean(xN29);GGN30_S14=mean(xN30)

GVN1_S14=mean(yN1);GVN2_S14=mean(yN2);GVN3_S14=mean(yN3);GVN4_S14=mean(yN4);GVN5_S14=mean(yN5);GVN6_S14=mean(yN6);GVN7_S14=mean(yN7);GVN8_S14=mean(yN8);GVN9_S14=mean(yN9);GVN10_S14=mean(yN10)
GVN11_S14=mean(yN11);GVN12_S14=mean(yN12);GVN13_S14=mean(yN13);GVN14_S14=mean(yN14);GVN15_S14=mean(yN15);GVN16_S14=mean(yN16);GVN17_S14=mean(yN17);GVN18_S14=mean(yN18);GVN19_S14=mean(yN19);GVN20_S14=mean(yN20)
GVN21_S14=mean(yN21);GVN22_S14=mean(yN22);GVN23_S14=mean(yN23);GVN24_S14=mean(yN24);GVN25_S14=mean(yN25);GVN26_S14=mean(yN26);GVN27_S14=mean(yN27);GVN28_S14=mean(yN28);GVN29_S14=mean(yN29);GVN30_S14=mean(yN30)



Genetic_gain_S14<-c(GGN1_S14,GGN2_S14,GGN3_S14,GGN4_S14,GGN5_S14,GGN6_S14,GGN7_S14,GGN8_S14,GGN9_S14,GGN10_S14,GGN11_S14,GGN12_S14,GGN13_S14,GGN14_S14,GGN15_S14,GGN16_S14,GGN17_S14,GGN18_S14,GGN19_S14,GGN20_S14,GGN21_S14,GGN22_S14,GGN23_S14,GGN24_S14,GGN25_S14,GGN26_S14,GGN27_S14,GGN28_S14,GGN29_S14,GGN30_S14)
Genetic_variation_S14<-c(GVN1_S14,GVN2_S14,GVN3_S14,GVN4_S14,GVN5_S14,GVN6_S14,GVN7_S14,GVN8_S14,GVN9_S14,GVN10_S14,GVN11_S14,GVN12_S14,GVN13_S14,GVN14_S14,GVN15_S14,GVN16_S14,GVN17_S14,GVN18_S14,GVN19_S14,GVN20_S14,GVN21_S14,GVN22_S14,GVN23_S14,GVN24_S14,GVN25_S14,GVN26_S14,GVN27_S14,GVN28_S14,GVN29_S14,GVN30_S14)
par(mfrow=c(2,1))
plot(Genetic_gain_S14,main="scenario 14",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S14)
plot(Genetic_variation_S14,main="scenario 14",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S14)
library(lattice)
Scenario14<-c(Genetic_gain_S14,Genetic_variation_S14)
write.csv(Scenario14,"Scenario14.csv")
xN_Scenario14<-data.frame(xN1,xN2,xN3,xN4,xN5,xN6,xN7,xN8,xN9,xN10,xN11,xN12,xN13,xN14,xN15,xN16,xN17,xN18,xN19,xN20,xN21,xN22,xN23,xN24,xN25,xN26,xN27,xN28,xN29,xN30)
write.csv(xN_Scenario14,"xN_scenario14.csv")
yN_Scenario14<-data.frame(yN1,yN2,yN3,yN4,yN5,yN6,yN7,yN8,yN9,yN10,yN11,yN12,yN13,yN14,yN15,yN16,yN17,yN18,yN19,yN20,yN21,yN22,yN23,yN24,yN25,yN26,yN27,yN28,yN29,yN30)
write.csv(yN_Scenario14,"yN_scenario14.csv")

######Scenario 15 for selection of 1000 best plants in each cycle with 10 seeds per plant to generate a pop of 10000 for the next cycle#####
selection15=1000 ; selectedSeeds15=10 ; fabaSelf15=0.7

xO1 = rep(0,n); yO1=rep(0,n)
xO2 = rep(0,n); yO2=rep(0,n)
xO3 = rep(0,n); yO3=rep(0,n)
xO4 = rep(0,n); yO4=rep(0,n)
xO5 = rep(0,n); yO5=rep(0,n)
xO6 = rep(0,n); yO6=rep(0,n)
xO7 = rep(0,n); yO7=rep(0,n)
xO8 = rep(0,n); yO8=rep(0,n)
xO9 = rep(0,n); yO9=rep(0,n)
xO10 = rep(0,n); yO10=rep(0,n)
xO11 = rep(0,n); yO11=rep(0,n)
xO12 = rep(0,n); yO12=rep(0,n)
xO13 = rep(0,n); yO13=rep(0,n)
xO14 = rep(0,n); yO14=rep(0,n)
xO15 = rep(0,n); yO15=rep(0,n)
xO16 = rep(0,n); yO16=rep(0,n)
xO17 = rep(0,n); yO17=rep(0,n)
xO18 = rep(0,n); yO18=rep(0,n)
xO19 = rep(0,n); yO19=rep(0,n)
xO20 = rep(0,n); yO20=rep(0,n)
xO21 = rep(0,n); yO21=rep(0,n)
xO22 = rep(0,n); yO22=rep(0,n)
xO23 = rep(0,n); yO23=rep(0,n)
xO24 = rep(0,n); yO24=rep(0,n)
xO25 = rep(0,n); yO25=rep(0,n)
xO26 = rep(0,n); yO26=rep(0,n)
xO27 = rep(0,n); yO27=rep(0,n)
xO28 = rep(0,n); yO28=rep(0,n)
xO29 = rep(0,n); yO29=rep(0,n)
xO30 = rep(0,n); yO30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO1 = selectOP(BasePop1,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO1[j]= meanG(GenO1)
  yO1[j]= genicVarG(GenO1)
  
  GenO1 = setPheno(GenO1, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO2 = selectOP(GenO1,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO2[j]= meanG(GenO2)
  yO2[j]= genicVarG(GenO2)
  
  GenO2 = setPheno(GenO2, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO3 = selectOP(GenO2,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO3[j]=meanG(GenO3)
  yO3[j]= genicVarG(GenO3)
  
  GenO3 = setPheno(GenO3, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO4 = selectOP(GenO3,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO4[j]=meanG(GenO4)
  yO4[j]= genicVarG(GenO4)
  
  GenO4 = setPheno(GenO4, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO5 = selectOP(GenO4,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO5[j]= meanG(GenO5)
  yO5[j]= genicVarG(GenO5)
  
  GenO5 = setPheno(GenO5, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO6 = selectOP(GenO5,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO6[j]= meanG(GenO6)
  yO6[j]= genicVarG(GenO6)
  
  GenO6 = setPheno(GenO6, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO7 = selectOP(GenO6,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO7[j]= meanG(GenO7)
  yO7[j]= genicVarG(GenO7)
  
  GenO7 = setPheno(GenO7, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO8 = selectOP(GenO7,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO8[j]= meanG(GenO8)
  yO8[j]= genicVarG(GenO8)
  
  GenO8 = setPheno(GenO8, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO9 = selectOP(GenO8,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO9[j]= meanG(GenO9)
  yO9[j]= genicVarG(GenO9)
  
  GenO9 = setPheno(GenO9, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO10 = selectOP(GenO9,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO10[j]= meanG(GenO10)
  yO10[j]= genicVarG(GenO10)
  
  GenO10 = setPheno(GenO10, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO11 = selectOP(GenO10,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO11[j]= meanG(GenO11)
  yO11[j]= genicVarG(GenO11)
  
  GenO11 = setPheno(GenO11, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO12 = selectOP(GenO11,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO12[j]= meanG(GenO12)
  yO12[j]= genicVarG(GenO12)
  
  GenO12 = setPheno(GenO12, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO13 = selectOP(GenO12,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO13[j]= meanG(GenO13)
  yO13[j]= genicVarG(GenO13)
  
  GenO13 = setPheno(GenO13, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO14 = selectOP(GenO13,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO14[j]= meanG(GenO14)
  yO14[j]= genicVarG(GenO14)
  
  GenO14 = setPheno(GenO14, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO15 = selectOP(GenO14,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO15[j]= meanG(GenO15)
  yO15[j]= genicVarG(GenO15)
  
  GenO15 = setPheno(GenO15, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO16 = selectOP(GenO15,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO16[j]= meanG(GenO16)
  yO16[j]= genicVarG(GenO16)
  
  GenO16 = setPheno(GenO16, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO17 = selectOP(GenO16,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO17[j]=meanG(GenO17)
  yO17[j]= genicVarG(GenO17)
  
  GenO17 = setPheno(GenO17, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO18 = selectOP(GenO17,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO18[j]= meanG(GenO18)
  yO18[j]= genicVarG(GenO18)
  
  GenO18 = setPheno(GenO18, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO19 = selectOP(GenO18,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO19[j]= meanG(GenO19)
  yO19[j]= genicVarG(GenO19)
  
  GenO19 = setPheno(GenO19, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO20 = selectOP(GenO19,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO20[j]= meanG(GenO20)
  yO20[j]= genicVarG(GenO20)
  
  GenO20 = setPheno(GenO20, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO21 = selectOP(GenO20,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO21[j]= meanG(GenO21)
  yO21[j]= genicVarG(GenO21)
  
  GenO21 = setPheno(GenO21, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO22 = selectOP(GenO21,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO22[j]= meanG(GenO22)
  yO22[j]= genicVarG(GenO22)
  
  GenO22 = setPheno(GenO22, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO23 = selectOP(GenO22,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO23[j]= meanG(GenO23)
  yO23[j]= genicVarG(GenO23)
  
  GenO23 = setPheno(GenO23, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO24 = selectOP(GenO23,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO24[j]= meanG(GenO24)
  yO24[j]= genicVarG(GenO24)
  
  GenO24 = setPheno(GenO24, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO25 = selectOP(GenO24,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO25[j]= meanG(GenO25)
  yO25[j]= genicVarG(GenO25)
  
  GenO25 = setPheno(GenO25, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO26 = selectOP(GenO25,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO26[j]= meanG(GenO26)
  yO26[j]= genicVarG(GenO26)
  
  GenO26 = setPheno(GenO26, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO27 = selectOP(GenO26,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO27[j]= meanG(GenO27)
  yO27[j]= genicVarG(GenO27)
  
  GenO27 = setPheno(GenO27, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO28 = selectOP(GenO27, nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO28[j]= meanG(GenO28)
  yO28[j]= genicVarG(GenO28)
  
  GenO28 = setPheno(GenO28, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO29 = selectOP(GenO28,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO29[j]= meanG(GenO29)
  yO29[j]= genicVarG(GenO29)
  
  GenO29 = setPheno(GenO29, varE=f, p=runif(1)) #Sets a phenotyOpe using the GxOE model
  GenO30 = selectOP(GenO29,nInd=selection15,nSeeds=selectedSeeds15,probSelf=fabaSelf15,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xO30[j]= meanG(GenO30)
  yO30[j]= genicVarG(GenO30)
}

GGO1_S15=mean(xO1);GGO2_S15=mean(xO2);GGO3_S15=mean(xO3);GGO4_S15=mean(xO4);GGO5_S15=mean(xO5);GGO6_S15=mean(xO6);GGO7_S15=mean(xO7);GGO8_S15=mean(xO8);GGO9_S15=mean(xO9);GGO10_S15=mean(xO10)
GGO11_S15=mean(xO11);GGO12_S15=mean(xO12);GGO13_S15=mean(xO13);GGO14_S15=mean(xO14);GGO15_S15=mean(xO15);GGO16_S15=mean(xO16);GGO17_S15=mean(xO17);GGO18_S15=mean(xO18);GGO19_S15=mean(xO19);GGO20_S15=mean(xO20)
GGO21_S15=mean(xO21);GGO22_S15=mean(xO22);GGO23_S15=mean(xO23);GGO24_S15=mean(xO24);GGO25_S15=mean(xO25);GGO26_S15=mean(xO26);GGO27_S15=mean(xO27);GGO28_S15=mean(xO28);GGO29_S15=mean(xO29);GGO30_S15=mean(xO30)

GVO1_S15=mean(yO1);GVO2_S15=mean(yO2);GVO3_S15=mean(yO3);GVO4_S15=mean(yO4);GVO5_S15=mean(yO5);GVO6_S15=mean(yO6);GVO7_S15=mean(yO7);GVO8_S15=mean(yO8);GVO9_S15=mean(yO9);GVO10_S15=mean(yO10)
GVO11_S15=mean(yO11);GVO12_S15=mean(yO12);GVO13_S15=mean(yO13);GVO14_S15=mean(yO14);GVO15_S15=mean(yO15);GVO16_S15=mean(yO16);GVO17_S15=mean(yO17);GVO18_S15=mean(yO18);GVO19_S15=mean(yO19);GVO20_S15=mean(yO20)
GVO21_S15=mean(yO21);GVO22_S15=mean(yO22);GVO23_S15=mean(yO23);GVO24_S15=mean(yO24);GVO25_S15=mean(yO25);GVO26_S15=mean(yO26);GVO27_S15=mean(yO27);GVO28_S15=mean(yO28);GVO29_S15=mean(yO29);GVO30_S15=mean(yO30)



Genetic_gain_S15<-c(GGO1_S15,GGO2_S15,GGO3_S15,GGO4_S15,GGO5_S15,GGO6_S15,GGO7_S15,GGO8_S15,GGO9_S15,GGO10_S15,GGO11_S15,GGO12_S15,GGO13_S15,GGO14_S15,GGO15_S15,GGO16_S15,GGO17_S15,GGO18_S15,GGO19_S15,GGO20_S15,GGO21_S15,GGO22_S15,GGO23_S15,GGO24_S15,GGO25_S15,GGO26_S15,GGO27_S15,GGO28_S15,GGO29_S15,GGO30_S15)
Genetic_variation_S15<-c(GVO1_S15,GVO2_S15,GVO3_S15,GVO4_S15,GVO5_S15,GVO6_S15,GVO7_S15,GVO8_S15,GVO9_S15,GVO10_S15,GVO11_S15,GVO12_S15,GVO13_S15,GVO14_S15,GVO15_S15,GVO16_S15,GVO17_S15,GVO18_S15,GVO19_S15,GVO20_S15,GVO21_S15,GVO22_S15,GVO23_S15,GVO24_S15,GVO25_S15,GVO26_S15,GVO27_S15,GVO28_S15,GVO29_S15,GVO30_S15)
par(mfrow=c(2,1))
plot(Genetic_gain_S15,main="scenario 15",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S15)
plot(Genetic_variation_S15,main="scenario 15",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S15)
library(lattice)
Scenario15<-c(Genetic_gain_S15,Genetic_variation_S15)
write.csv(Scenario15,"Scenario15.csv")
xO_Scenario15<-data.frame(xO1,xO2,xO3,xO4,xO5,xO6,xO7,xO8,xO9,xO10,xO11,xO12,xO13,xO14,xO15,xO16,xO17,xO18,xO19,xO20,xO21,xO22,xO23,xO24,xO25,xO26,xO27,xO28,xO29,xO30)
write.csv(xO_Scenario15,"xO_scenario15.csv")
yO_Scenario15<-data.frame(yO1,yO2,yO3,yO4,yO5,yO6,yO7,yO8,yO9,yO10,yO11,yO12,yO13,yO14,yO15,yO16,yO17,yO18,yO19,yO20,yO21,yO22,yO23,yO24,yO25,yO26,yO27,yO28,yO29,yO30)
write.csv(yO_Scenario15,"yO_scenario15.csv")

######Scenario 16 for selection of 400 best plants in each cycle with 50 seeds per plant to generate a pop of 20000 for the next cycle#####
selection16=400 ; selectedSeeds16=50 ; fabaSelf16=0.7

xP1 = rep(0,n); yP1=rep(0,n)
xP2 = rep(0,n); yP2=rep(0,n)
xP3 = rep(0,n); yP3=rep(0,n)
xP4 = rep(0,n); yP4=rep(0,n)
xP5 = rep(0,n); yP5=rep(0,n)
xP6 = rep(0,n); yP6=rep(0,n)
xP7 = rep(0,n); yP7=rep(0,n)
xP8 = rep(0,n); yP8=rep(0,n)
xP9 = rep(0,n); yP9=rep(0,n)
xP10 = rep(0,n); yP10=rep(0,n)
xP11 = rep(0,n); yP11=rep(0,n)
xP12 = rep(0,n); yP12=rep(0,n)
xP13 = rep(0,n); yP13=rep(0,n)
xP14 = rep(0,n); yP14=rep(0,n)
xP15 = rep(0,n); yP15=rep(0,n)
xP16 = rep(0,n); yP16=rep(0,n)
xP17 = rep(0,n); yP17=rep(0,n)
xP18 = rep(0,n); yP18=rep(0,n)
xP19 = rep(0,n); yP19=rep(0,n)
xP20 = rep(0,n); yP20=rep(0,n)
xP21 = rep(0,n); yP21=rep(0,n)
xP22 = rep(0,n); yP22=rep(0,n)
xP23 = rep(0,n); yP23=rep(0,n)
xP24 = rep(0,n); yP24=rep(0,n)
xP25 = rep(0,n); yP25=rep(0,n)
xP26 = rep(0,n); yP26=rep(0,n)
xP27 = rep(0,n); yP27=rep(0,n)
xP28 = rep(0,n); yP28=rep(0,n)
xP29 = rep(0,n); yP29=rep(0,n)
xP30 = rep(0,n); yP30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP1 = selectOP(BasePop1,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP1[j]= meanG(GenP1)
  yP1[j]= genicVarG(GenP1)
  
  GenP1 = setPheno(GenP1, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP2 = selectOP(GenP1,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP2[j]= meanG(GenP2)
  yP2[j]= genicVarG(GenP2)
  
  GenP2 = setPheno(GenP2, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP3 = selectOP(GenP2,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP3[j]=meanG(GenP3)
  yP3[j]= genicVarG(GenP3)
  
  GenP3 = setPheno(GenP3, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP4 = selectOP(GenP3,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP4[j]=meanG(GenP4)
  yP4[j]= genicVarG(GenP4)
  
  GenP4 = setPheno(GenP4, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP5 = selectOP(GenP4,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP5[j]= meanG(GenP5)
  yP5[j]= genicVarG(GenP5)
  
  GenP5 = setPheno(GenP5, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP6 = selectOP(GenP5,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP6[j]= meanG(GenP6)
  yP6[j]= genicVarG(GenP6)
  
  GenP6 = setPheno(GenP6, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP7 = selectOP(GenP6,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP7[j]= meanG(GenP7)
  yP7[j]= genicVarG(GenP7)
  
  GenP7 = setPheno(GenP7, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP8 = selectOP(GenP7,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP8[j]= meanG(GenP8)
  yP8[j]= genicVarG(GenP8)
  
  GenP8 = setPheno(GenP8, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP9 = selectOP(GenP8,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP9[j]= meanG(GenP9)
  yP9[j]= genicVarG(GenP9)
  
  GenP9 = setPheno(GenP9, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP10 = selectOP(GenP9,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP10[j]= meanG(GenP10)
  yP10[j]= genicVarG(GenP10)
  
  GenP10 = setPheno(GenP10, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP11 = selectOP(GenP10,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP11[j]= meanG(GenP11)
  yP11[j]= genicVarG(GenP11)
  
  GenP11 = setPheno(GenP11, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP12 = selectOP(GenP11,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP12[j]= meanG(GenP12)
  yP12[j]= genicVarG(GenP12)
  
  GenP12 = setPheno(GenP12, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP13 = selectOP(GenP12,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP13[j]= meanG(GenP13)
  yP13[j]= genicVarG(GenP13)
  
  GenP13 = setPheno(GenP13, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP14 = selectOP(GenP13,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP14[j]= meanG(GenP14)
  yP14[j]= genicVarG(GenP14)
  
  GenP14 = setPheno(GenP14, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP15 = selectOP(GenP14,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP15[j]= meanG(GenP15)
  yP15[j]= genicVarG(GenP15)
  
  GenP15 = setPheno(GenP15, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP16 = selectOP(GenP15,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP16[j]= meanG(GenP16)
  yP16[j]= genicVarG(GenP16)
  
  GenP16 = setPheno(GenP16, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP17 = selectOP(GenP16,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP17[j]=meanG(GenP17)
  yP17[j]= genicVarG(GenP17)
  
  GenP17 = setPheno(GenP17, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP18 = selectOP(GenP17,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP18[j]= meanG(GenP18)
  yP18[j]= genicVarG(GenP18)
  
  GenP18 = setPheno(GenP18, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP19 = selectOP(GenP18,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP19[j]= meanG(GenP19)
  yP19[j]= genicVarG(GenP19)
  
  GenP19 = setPheno(GenP19, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP20 = selectOP(GenP19,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP20[j]= meanG(GenP20)
  yP20[j]= genicVarG(GenP20)
  
  GenP20 = setPheno(GenP20, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP21 = selectOP(GenP20,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP21[j]= meanG(GenP21)
  yP21[j]= genicVarG(GenP21)
  
  GenP21 = setPheno(GenP21, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP22 = selectOP(GenP21,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP22[j]= meanG(GenP22)
  yP22[j]= genicVarG(GenP22)
  
  GenP22 = setPheno(GenP22, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP23 = selectOP(GenP22,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP23[j]= meanG(GenP23)
  yP23[j]= genicVarG(GenP23)
  
  GenP23 = setPheno(GenP23, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP24 = selectOP(GenP23,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP24[j]= meanG(GenP24)
  yP24[j]= genicVarG(GenP24)
  
  GenP24 = setPheno(GenP24, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP25 = selectOP(GenP24,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP25[j]= meanG(GenP25)
  yP25[j]= genicVarG(GenP25)
  
  GenP25 = setPheno(GenP25, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP26 = selectOP(GenP25,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP26[j]= meanG(GenP26)
  yP26[j]= genicVarG(GenP26)
  
  GenP26 = setPheno(GenP26, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP27 = selectOP(GenP26,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP27[j]= meanG(GenP27)
  yP27[j]= genicVarG(GenP27)
  
  GenP27 = setPheno(GenP27, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP28 = selectOP(GenP27, nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP28[j]= meanG(GenP28)
  yP28[j]= genicVarG(GenP28)
  
  GenP28 = setPheno(GenP28, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP29 = selectOP(GenP28,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP29[j]= meanG(GenP29)
  yP29[j]= genicVarG(GenP29)
  
  GenP29 = setPheno(GenP29, varE=f, p=runif(1)) #Sets a phenotyPpe using the GxPE model
  GenP30 = selectOP(GenP29,nInd=selection16,nSeeds=selectedSeeds16,probSelf=fabaSelf16,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xP30[j]= meanG(GenP30)
  yP30[j]= genicVarG(GenP30)
}

GGP1_S16=mean(xP1);GGP2_S16=mean(xP2);GGP3_S16=mean(xP3);GGP4_S16=mean(xP4);GGP5_S16=mean(xP5);GGP6_S16=mean(xP6);GGP7_S16=mean(xP7);GGP8_S16=mean(xP8);GGP9_S16=mean(xP9);GGP10_S16=mean(xP10)
GGP11_S16=mean(xP11);GGP12_S16=mean(xP12);GGP13_S16=mean(xP13);GGP14_S16=mean(xP14);GGP15_S16=mean(xP15);GGP16_S16=mean(xP16);GGP17_S16=mean(xP17);GGP18_S16=mean(xP18);GGP19_S16=mean(xP19);GGP20_S16=mean(xP20)
GGP21_S16=mean(xP21);GGP22_S16=mean(xP22);GGP23_S16=mean(xP23);GGP24_S16=mean(xP24);GGP25_S16=mean(xP25);GGP26_S16=mean(xP26);GGP27_S16=mean(xP27);GGP28_S16=mean(xP28);GGP29_S16=mean(xP29);GGP30_S16=mean(xP30)

GVP1_S16=mean(yP1);GVP2_S16=mean(yP2);GVP3_S16=mean(yP3);GVP4_S16=mean(yP4);GVP5_S16=mean(yP5);GVP6_S16=mean(yP6);GVP7_S16=mean(yP7);GVP8_S16=mean(yP8);GVP9_S16=mean(yP9);GVP10_S16=mean(yP10)
GVP11_S16=mean(yP11);GVP12_S16=mean(yP12);GVP13_S16=mean(yP13);GVP14_S16=mean(yP14);GVP15_S16=mean(yP15);GVP16_S16=mean(yP16);GVP17_S16=mean(yP17);GVP18_S16=mean(yP18);GVP19_S16=mean(yP19);GVP20_S16=mean(yP20)
GVP21_S16=mean(yP21);GVP22_S16=mean(yP22);GVP23_S16=mean(yP23);GVP24_S16=mean(yP24);GVP25_S16=mean(yP25);GVP26_S16=mean(yP26);GVP27_S16=mean(yP27);GVP28_S16=mean(yP28);GVP29_S16=mean(yP29);GVP30_S16=mean(yP30)



Genetic_gain_S16<-c(GGP1_S16,GGP2_S16,GGP3_S16,GGP4_S16,GGP5_S16,GGP6_S16,GGP7_S16,GGP8_S16,GGP9_S16,GGP10_S16,GGP11_S16,GGP12_S16,GGP13_S16,GGP14_S16,GGP15_S16,GGP16_S16,GGP17_S16,GGP18_S16,GGP19_S16,GGP20_S16,GGP21_S16,GGP22_S16,GGP23_S16,GGP24_S16,GGP25_S16,GGP26_S16,GGP27_S16,GGP28_S16,GGP29_S16,GGP30_S16)
Genetic_variation_S16<-c(GVP1_S16,GVP2_S16,GVP3_S16,GVP4_S16,GVP5_S16,GVP6_S16,GVP7_S16,GVP8_S16,GVP9_S16,GVP10_S16,GVP11_S16,GVP12_S16,GVP13_S16,GVP14_S16,GVP15_S16,GVP16_S16,GVP17_S16,GVP18_S16,GVP19_S16,GVP20_S16,GVP21_S16,GVP22_S16,GVP23_S16,GVP24_S16,GVP25_S16,GVP26_S16,GVP27_S16,GVP28_S16,GVP29_S16,GVP30_S16)
par(mfrow=c(2,1))
plot(Genetic_gain_S16,main="scenario 16",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S16)
plot(Genetic_variation_S16,main="scenario 16",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S16)
library(lattice)
Scenario16<-c(Genetic_gain_S16,Genetic_variation_S16)
write.csv(Scenario16,"Scenario16.csv")
xP_Scenario16<-data.frame(xP1,xP2,xP3,xP4,xP5,xP6,xP7,xP8,xP9,xP10,xP11,xP12,xP13,xP14,xP15,xP16,xP17,xP18,xP19,xP20,xP21,xP22,xP23,xP24,xP25,xP26,xP27,xP28,xP29,xP30)
write.csv(xP_Scenario16,"xP_scenario16.csv")
yP_Scenario16<-data.frame(yP1,yP2,yP3,yP4,yP5,yP6,yP7,yP8,yP9,yP10,yP11,yP12,yP13,yP14,yP15,yP16,yP17,yP18,yP19,yP20,yP21,yP22,yP23,yP24,yP25,yP26,yP27,yP28,yP29,yP30)
write.csv(yP_Scenario16,"yP_scenario16.csv")


######Scenario 17 for selection of 800 best plants in each cycle with 25 seeds per plant to generate a pop of 20000 for the next cycle#####
selection17=800 ; selectedSeeds17=25 ; fabaSelf17=0.7

xQ1 = rep(0,n); yQ1=rep(0,n)
xQ2 = rep(0,n); yQ2=rep(0,n)
xQ3 = rep(0,n); yQ3=rep(0,n)
xQ4 = rep(0,n); yQ4=rep(0,n)
xQ5 = rep(0,n); yQ5=rep(0,n)
xQ6 = rep(0,n); yQ6=rep(0,n)
xQ7 = rep(0,n); yQ7=rep(0,n)
xQ8 = rep(0,n); yQ8=rep(0,n)
xQ9 = rep(0,n); yQ9=rep(0,n)
xQ10 = rep(0,n); yQ10=rep(0,n)
xQ11 = rep(0,n); yQ11=rep(0,n)
xQ12 = rep(0,n); yQ12=rep(0,n)
xQ13 = rep(0,n); yQ13=rep(0,n)
xQ14 = rep(0,n); yQ14=rep(0,n)
xQ15 = rep(0,n); yQ15=rep(0,n)
xQ16 = rep(0,n); yQ16=rep(0,n)
xQ17 = rep(0,n); yQ17=rep(0,n)
xQ18 = rep(0,n); yQ18=rep(0,n)
xQ19 = rep(0,n); yQ19=rep(0,n)
xQ20 = rep(0,n); yQ20=rep(0,n)
xQ21 = rep(0,n); yQ21=rep(0,n)
xQ22 = rep(0,n); yQ22=rep(0,n)
xQ23 = rep(0,n); yQ23=rep(0,n)
xQ24 = rep(0,n); yQ24=rep(0,n)
xQ25 = rep(0,n); yQ25=rep(0,n)
xQ26 = rep(0,n); yQ26=rep(0,n)
xQ27 = rep(0,n); yQ27=rep(0,n)
xQ28 = rep(0,n); yQ28=rep(0,n)
xQ29 = rep(0,n); yQ29=rep(0,n)
xQ30 = rep(0,n); yQ30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ1 = selectOP(BasePop1,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ1[j]= meanG(GenQ1)
  yQ1[j]= genicVarG(GenQ1)
  
  GenQ1 = setPheno(GenQ1, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ2 = selectOP(GenQ1,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ2[j]= meanG(GenQ2)
  yQ2[j]= genicVarG(GenQ2)
  
  GenQ2 = setPheno(GenQ2, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ3 = selectOP(GenQ2,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ3[j]=meanG(GenQ3)
  yQ3[j]= genicVarG(GenQ3)
  
  GenQ3 = setPheno(GenQ3, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ4 = selectOP(GenQ3,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ4[j]=meanG(GenQ4)
  yQ4[j]= genicVarG(GenQ4)
  
  GenQ4 = setPheno(GenQ4, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ5 = selectOP(GenQ4,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ5[j]= meanG(GenQ5)
  yQ5[j]= genicVarG(GenQ5)
  
  GenQ5 = setPheno(GenQ5, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ6 = selectOP(GenQ5,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ6[j]= meanG(GenQ6)
  yQ6[j]= genicVarG(GenQ6)
  
  GenQ6 = setPheno(GenQ6, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ7 = selectOP(GenQ6,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ7[j]= meanG(GenQ7)
  yQ7[j]= genicVarG(GenQ7)
  
  GenQ7 = setPheno(GenQ7, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ8 = selectOP(GenQ7,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ8[j]= meanG(GenQ8)
  yQ8[j]= genicVarG(GenQ8)
  
  GenQ8 = setPheno(GenQ8, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ9 = selectOP(GenQ8,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ9[j]= meanG(GenQ9)
  yQ9[j]= genicVarG(GenQ9)
  
  GenQ9 = setPheno(GenQ9, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ10 = selectOP(GenQ9,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ10[j]= meanG(GenQ10)
  yQ10[j]= genicVarG(GenQ10)
  
  GenQ10 = setPheno(GenQ10, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ11 = selectOP(GenQ10,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ11[j]= meanG(GenQ11)
  yQ11[j]= genicVarG(GenQ11)
  
  GenQ11 = setPheno(GenQ11, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ12 = selectOP(GenQ11,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ12[j]= meanG(GenQ12)
  yQ12[j]= genicVarG(GenQ12)
  
  GenQ12 = setPheno(GenQ12, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ13 = selectOP(GenQ12,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ13[j]= meanG(GenQ13)
  yQ13[j]= genicVarG(GenQ13)
  
  GenQ13 = setPheno(GenQ13, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ14 = selectOP(GenQ13,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ14[j]= meanG(GenQ14)
  yQ14[j]= genicVarG(GenQ14)
  
  GenQ14 = setPheno(GenQ14, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ15 = selectOP(GenQ14,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ15[j]= meanG(GenQ15)
  yQ15[j]= genicVarG(GenQ15)
  
  GenQ15 = setPheno(GenQ15, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ16 = selectOP(GenQ15,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ16[j]= meanG(GenQ16)
  yQ16[j]= genicVarG(GenQ16)
  
  GenQ16 = setPheno(GenQ16, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ17 = selectOP(GenQ16,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ17[j]=meanG(GenQ17)
  yQ17[j]= genicVarG(GenQ17)
  
  GenQ17 = setPheno(GenQ17, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ18 = selectOP(GenQ17,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ18[j]= meanG(GenQ18)
  yQ18[j]= genicVarG(GenQ18)
  
  GenQ18 = setPheno(GenQ18, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ19 = selectOP(GenQ18,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ19[j]= meanG(GenQ19)
  yQ19[j]= genicVarG(GenQ19)
  
  GenQ19 = setPheno(GenQ19, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ20 = selectOP(GenQ19,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ20[j]= meanG(GenQ20)
  yQ20[j]= genicVarG(GenQ20)
  
  GenQ20 = setPheno(GenQ20, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ21 = selectOP(GenQ20,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ21[j]= meanG(GenQ21)
  yQ21[j]= genicVarG(GenQ21)
  
  GenQ21 = setPheno(GenQ21, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ22 = selectOP(GenQ21,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ22[j]= meanG(GenQ22)
  yQ22[j]= genicVarG(GenQ22)
  
  GenQ22 = setPheno(GenQ22, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ23 = selectOP(GenQ22,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ23[j]= meanG(GenQ23)
  yQ23[j]= genicVarG(GenQ23)
  
  GenQ23 = setPheno(GenQ23, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ24 = selectOP(GenQ23,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ24[j]= meanG(GenQ24)
  yQ24[j]= genicVarG(GenQ24)
  
  GenQ24 = setPheno(GenQ24, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ25 = selectOP(GenQ24,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ25[j]= meanG(GenQ25)
  yQ25[j]= genicVarG(GenQ25)
  
  GenQ25 = setPheno(GenQ25, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ26 = selectOP(GenQ25,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ26[j]= meanG(GenQ26)
  yQ26[j]= genicVarG(GenQ26)
  
  GenQ26 = setPheno(GenQ26, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ27 = selectOP(GenQ26,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ27[j]= meanG(GenQ27)
  yQ27[j]= genicVarG(GenQ27)
  
  GenQ27 = setPheno(GenQ27, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ28 = selectOP(GenQ27, nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ28[j]= meanG(GenQ28)
  yQ28[j]= genicVarG(GenQ28)
  
  GenQ28 = setPheno(GenQ28, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ29 = selectOP(GenQ28,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ29[j]= meanG(GenQ29)
  yQ29[j]= genicVarG(GenQ29)
  
  GenQ29 = setPheno(GenQ29, varE=f, p=runif(1)) #Sets a phenotyQpe using the GxQE model
  GenQ30 = selectOP(GenQ29,nInd=selection17,nSeeds=selectedSeeds17,probSelf=fabaSelf17,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xQ30[j]= meanG(GenQ30)
  yQ30[j]= genicVarG(GenQ30)
}

GGQ1_S17=mean(xQ1);GGQ2_S17=mean(xQ2);GGQ3_S17=mean(xQ3);GGQ4_S17=mean(xQ4);GGQ5_S17=mean(xQ5);GGQ6_S17=mean(xQ6);GGQ7_S17=mean(xQ7);GGQ8_S17=mean(xQ8);GGQ9_S17=mean(xQ9);GGQ10_S17=mean(xQ10)
GGQ11_S17=mean(xQ11);GGQ12_S17=mean(xQ12);GGQ13_S17=mean(xQ13);GGQ14_S17=mean(xQ14);GGQ15_S17=mean(xQ15);GGQ16_S17=mean(xQ16);GGQ17_S17=mean(xQ17);GGQ18_S17=mean(xQ18);GGQ19_S17=mean(xQ19);GGQ20_S17=mean(xQ20)
GGQ21_S17=mean(xQ21);GGQ22_S17=mean(xQ22);GGQ23_S17=mean(xQ23);GGQ24_S17=mean(xQ24);GGQ25_S17=mean(xQ25);GGQ26_S17=mean(xQ26);GGQ27_S17=mean(xQ27);GGQ28_S17=mean(xQ28);GGQ29_S17=mean(xQ29);GGQ30_S17=mean(xQ30)

GVQ1_S17=mean(yQ1);GVQ2_S17=mean(yQ2);GVQ3_S17=mean(yQ3);GVQ4_S17=mean(yQ4);GVQ5_S17=mean(yQ5);GVQ6_S17=mean(yQ6);GVQ7_S17=mean(yQ7);GVQ8_S17=mean(yQ8);GVQ9_S17=mean(yQ9);GVQ10_S17=mean(yQ10)
GVQ11_S17=mean(yQ11);GVQ12_S17=mean(yQ12);GVQ13_S17=mean(yQ13);GVQ14_S17=mean(yQ14);GVQ15_S17=mean(yQ15);GVQ16_S17=mean(yQ16);GVQ17_S17=mean(yQ17);GVQ18_S17=mean(yQ18);GVQ19_S17=mean(yQ19);GVQ20_S17=mean(yQ20)
GVQ21_S17=mean(yQ21);GVQ22_S17=mean(yQ22);GVQ23_S17=mean(yQ23);GVQ24_S17=mean(yQ24);GVQ25_S17=mean(yQ25);GVQ26_S17=mean(yQ26);GVQ27_S17=mean(yQ27);GVQ28_S17=mean(yQ28);GVQ29_S17=mean(yQ29);GVQ30_S17=mean(yQ30)



Genetic_gain_S17<-c(GGQ1_S17,GGQ2_S17,GGQ3_S17,GGQ4_S17,GGQ5_S17,GGQ6_S17,GGQ7_S17,GGQ8_S17,GGQ9_S17,GGQ10_S17,GGQ11_S17,GGQ12_S17,GGQ13_S17,GGQ14_S17,GGQ15_S17,GGQ16_S17,GGQ17_S17,GGQ18_S17,GGQ19_S17,GGQ20_S17,GGQ21_S17,GGQ22_S17,GGQ23_S17,GGQ24_S17,GGQ25_S17,GGQ26_S17,GGQ27_S17,GGQ28_S17,GGQ29_S17,GGQ30_S17)
Genetic_variation_S17<-c(GVQ1_S17,GVQ2_S17,GVQ3_S17,GVQ4_S17,GVQ5_S17,GVQ6_S17,GVQ7_S17,GVQ8_S17,GVQ9_S17,GVQ10_S17,GVQ11_S17,GVQ12_S17,GVQ13_S17,GVQ14_S17,GVQ15_S17,GVQ16_S17,GVQ17_S17,GVQ18_S17,GVQ19_S17,GVQ20_S17,GVQ21_S17,GVQ22_S17,GVQ23_S17,GVQ24_S17,GVQ25_S17,GVQ26_S17,GVQ27_S17,GVQ28_S17,GVQ29_S17,GVQ30_S17)
par(mfrow=c(2,1))
plot(Genetic_gain_S17,main="scenario 17",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S17)
plot(Genetic_variation_S17,main="scenario 17",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S17)
library(lattice)
Scenario17<-c(Genetic_gain_S17,Genetic_variation_S17)
write.csv(Scenario17,"Scenario17.csv")
xQ_Scenario17<-data.frame(xQ1,xQ2,xQ3,xQ4,xQ5,xQ6,xQ7,xQ8,xQ9,xQ10,xQ11,xQ12,xQ13,xQ14,xQ15,xQ16,xQ17,xQ18,xQ19,xQ20,xQ21,xQ22,xQ23,xQ24,xQ25,xQ26,xQ27,xQ28,xQ29,xQ30)
write.csv(xQ_Scenario17,"xQ_scenario17.csv")
yQ_Scenario17<-data.frame(yQ1,yQ2,yQ3,yQ4,yQ5,yQ6,yQ7,yQ8,yQ9,yQ10,yQ11,yQ12,yQ13,yQ14,yQ15,yQ16,yQ17,yQ18,yQ19,yQ20,yQ21,yQ22,yQ23,yQ24,yQ25,yQ26,yQ27,yQ28,yQ29,yQ30)
write.csv(yQ_Scenario17,"yQ_scenario17.csv")


######Scenario 18 for selection of 2000 best plants in each cycle with 10 seeds per plant to generate a pop of 20000 for the next cycle#####
selection18=2000 ; selectedSeeds18=10 ; fabaSelf18=0.7

xR1 = rep(0,n); yR1=rep(0,n)
xR2 = rep(0,n); yR2=rep(0,n)
xR3 = rep(0,n); yR3=rep(0,n)
xR4 = rep(0,n); yR4=rep(0,n)
xR5 = rep(0,n); yR5=rep(0,n)
xR6 = rep(0,n); yR6=rep(0,n)
xR7 = rep(0,n); yR7=rep(0,n)
xR8 = rep(0,n); yR8=rep(0,n)
xR9 = rep(0,n); yR9=rep(0,n)
xR10 = rep(0,n); yR10=rep(0,n)
xR11 = rep(0,n); yR11=rep(0,n)
xR12 = rep(0,n); yR12=rep(0,n)
xR13 = rep(0,n); yR13=rep(0,n)
xR14 = rep(0,n); yR14=rep(0,n)
xR15 = rep(0,n); yR15=rep(0,n)
xR16 = rep(0,n); yR16=rep(0,n)
xR17 = rep(0,n); yR17=rep(0,n)
xR18 = rep(0,n); yR18=rep(0,n)
xR19 = rep(0,n); yR19=rep(0,n)
xR20 = rep(0,n); yR20=rep(0,n)
xR21 = rep(0,n); yR21=rep(0,n)
xR22 = rep(0,n); yR22=rep(0,n)
xR23 = rep(0,n); yR23=rep(0,n)
xR24 = rep(0,n); yR24=rep(0,n)
xR25 = rep(0,n); yR25=rep(0,n)
xR26 = rep(0,n); yR26=rep(0,n)
xR27 = rep(0,n); yR27=rep(0,n)
xR28 = rep(0,n); yR28=rep(0,n)
xR29 = rep(0,n); yR29=rep(0,n)
xR30 = rep(0,n); yR30=rep(0,n)

for (j in 1:n)
{
  BasePop1 = setPheno(BasePop1, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR1 = selectOP(BasePop1,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR1[j]= meanG(GenR1)
  yR1[j]= genicVarG(GenR1)
  
  GenR1 = setPheno(GenR1, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR2 = selectOP(GenR1,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR2[j]= meanG(GenR2)
  yR2[j]= genicVarG(GenR2)
  
  GenR2 = setPheno(GenR2, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR3 = selectOP(GenR2,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR3[j]=meanG(GenR3)
  yR3[j]= genicVarG(GenR3)
  
  GenR3 = setPheno(GenR3, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR4 = selectOP(GenR3,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR4[j]=meanG(GenR4)
  yR4[j]= genicVarG(GenR4)
  
  GenR4 = setPheno(GenR4, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR5 = selectOP(GenR4,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR5[j]= meanG(GenR5)
  yR5[j]= genicVarG(GenR5)
  
  GenR5 = setPheno(GenR5, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR6 = selectOP(GenR5,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR6[j]= meanG(GenR6)
  yR6[j]= genicVarG(GenR6)
  
  GenR6 = setPheno(GenR6, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR7 = selectOP(GenR6,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR7[j]= meanG(GenR7)
  yR7[j]= genicVarG(GenR7)
  
  GenR7 = setPheno(GenR7, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR8 = selectOP(GenR7,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR8[j]= meanG(GenR8)
  yR8[j]= genicVarG(GenR8)
  
  GenR8 = setPheno(GenR8, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR9 = selectOP(GenR8,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR9[j]= meanG(GenR9)
  yR9[j]= genicVarG(GenR9)
  
  GenR9 = setPheno(GenR9, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR10 = selectOP(GenR9,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR10[j]= meanG(GenR10)
  yR10[j]= genicVarG(GenR10)
  
  GenR10 = setPheno(GenR10, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR11 = selectOP(GenR10,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR11[j]= meanG(GenR11)
  yR11[j]= genicVarG(GenR11)
  
  GenR11 = setPheno(GenR11, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR12 = selectOP(GenR11,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR12[j]= meanG(GenR12)
  yR12[j]= genicVarG(GenR12)
  
  GenR12 = setPheno(GenR12, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR13 = selectOP(GenR12,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR13[j]= meanG(GenR13)
  yR13[j]= genicVarG(GenR13)
  
  GenR13 = setPheno(GenR13, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR14 = selectOP(GenR13,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR14[j]= meanG(GenR14)
  yR14[j]= genicVarG(GenR14)
  
  GenR14 = setPheno(GenR14, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR15 = selectOP(GenR14,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR15[j]= meanG(GenR15)
  yR15[j]= genicVarG(GenR15)
  
  GenR15 = setPheno(GenR15, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR16 = selectOP(GenR15,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR16[j]= meanG(GenR16)
  yR16[j]= genicVarG(GenR16)
  
  GenR16 = setPheno(GenR16, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR17 = selectOP(GenR16,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR17[j]=meanG(GenR17)
  yR17[j]= genicVarG(GenR17)
  
  GenR17 = setPheno(GenR17, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR18 = selectOP(GenR17,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR18[j]= meanG(GenR18)
  yR18[j]= genicVarG(GenR18)
  
  GenR18 = setPheno(GenR18, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR19 = selectOP(GenR18,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR19[j]= meanG(GenR19)
  yR19[j]= genicVarG(GenR19)
  
  GenR19 = setPheno(GenR19, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR20 = selectOP(GenR19,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR20[j]= meanG(GenR20)
  yR20[j]= genicVarG(GenR20)
  
  GenR20 = setPheno(GenR20, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR21 = selectOP(GenR20,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR21[j]= meanG(GenR21)
  yR21[j]= genicVarG(GenR21)
  
  GenR21 = setPheno(GenR21, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR22 = selectOP(GenR21,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR22[j]= meanG(GenR22)
  yR22[j]= genicVarG(GenR22)
  
  GenR22 = setPheno(GenR22, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR23 = selectOP(GenR22,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR23[j]= meanG(GenR23)
  yR23[j]= genicVarG(GenR23)
  
  GenR23 = setPheno(GenR23, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR24 = selectOP(GenR23,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR24[j]= meanG(GenR24)
  yR24[j]= genicVarG(GenR24)
  
  GenR24 = setPheno(GenR24, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR25 = selectOP(GenR24,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR25[j]= meanG(GenR25)
  yR25[j]= genicVarG(GenR25)
  
  GenR25 = setPheno(GenR25, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR26 = selectOP(GenR25,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR26[j]= meanG(GenR26)
  yR26[j]= genicVarG(GenR26)
  
  GenR26 = setPheno(GenR26, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR27 = selectOP(GenR26,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR27[j]= meanG(GenR27)
  yR27[j]= genicVarG(GenR27)
  
  GenR27 = setPheno(GenR27, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR28 = selectOP(GenR27, nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR28[j]= meanG(GenR28)
  yR28[j]= genicVarG(GenR28)
  
  GenR28 = setPheno(GenR28, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR29 = selectOP(GenR28,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR29[j]= meanG(GenR29)
  yR29[j]= genicVarG(GenR29)
  
  GenR29 = setPheno(GenR29, varE=f, p=runif(1)) #Sets a phenotyRpe using the GxRE model
  GenR30 = selectOP(GenR29,nInd=selection18,nSeeds=selectedSeeds18,probSelf=fabaSelf18,pollenControl = FALSE, trait = 1, use ="pheno" ,selectTop = TRUE, simParam = SP )
  xR30[j]= meanG(GenR30)
  yR30[j]= genicVarG(GenR30)
}

GGR1_S18=mean(xR1);GGR2_S18=mean(xR2);GGR3_S18=mean(xR3);GGR4_S18=mean(xR4);GGR5_S18=mean(xR5);GGR6_S18=mean(xR6);GGR7_S18=mean(xR7);GGR8_S18=mean(xR8);GGR9_S18=mean(xR9);GGR10_S18=mean(xR10)
GGR11_S18=mean(xR11);GGR12_S18=mean(xR12);GGR13_S18=mean(xR13);GGR14_S18=mean(xR14);GGR15_S18=mean(xR15);GGR16_S18=mean(xR16);GGR17_S18=mean(xR17);GGR18_S18=mean(xR18);GGR19_S18=mean(xR19);GGR20_S18=mean(xR20)
GGR21_S18=mean(xR21);GGR22_S18=mean(xR22);GGR23_S18=mean(xR23);GGR24_S18=mean(xR24);GGR25_S18=mean(xR25);GGR26_S18=mean(xR26);GGR27_S18=mean(xR27);GGR28_S18=mean(xR28);GGR29_S18=mean(xR29);GGR30_S18=mean(xR30)

GVR1_S18=mean(yR1);GVR2_S18=mean(yR2);GVR3_S18=mean(yR3);GVR4_S18=mean(yR4);GVR5_S18=mean(yR5);GVR6_S18=mean(yR6);GVR7_S18=mean(yR7);GVR8_S18=mean(yR8);GVR9_S18=mean(yR9);GVR10_S18=mean(yR10)
GVR11_S18=mean(yR11);GVR12_S18=mean(yR12);GVR13_S18=mean(yR13);GVR14_S18=mean(yR14);GVR15_S18=mean(yR15);GVR16_S18=mean(yR16);GVR17_S18=mean(yR17);GVR18_S18=mean(yR18);GVR19_S18=mean(yR19);GVR20_S18=mean(yR20)
GVR21_S18=mean(yR21);GVR22_S18=mean(yR22);GVR23_S18=mean(yR23);GVR24_S18=mean(yR24);GVR25_S18=mean(yR25);GVR26_S18=mean(yR26);GVR27_S18=mean(yR27);GVR28_S18=mean(yR28);GVR29_S18=mean(yR29);GVR30_S18=mean(yR30)



Genetic_gain_S18<-c(GGR1_S18,GGR2_S18,GGR3_S18,GGR4_S18,GGR5_S18,GGR6_S18,GGR7_S18,GGR8_S18,GGR9_S18,GGR10_S18,GGR11_S18,GGR12_S18,GGR13_S18,GGR14_S18,GGR15_S18,GGR16_S18,GGR17_S18,GGR18_S18,GGR19_S18,GGR20_S18,GGR21_S18,GGR22_S18,GGR23_S18,GGR24_S18,GGR25_S18,GGR26_S18,GGR27_S18,GGR28_S18,GGR29_S18,GGR30_S18)
Genetic_variation_S18<-c(GVR1_S18,GVR2_S18,GVR3_S18,GVR4_S18,GVR5_S18,GVR6_S18,GVR7_S18,GVR8_S18,GVR9_S18,GVR10_S18,GVR11_S18,GVR12_S18,GVR13_S18,GVR14_S18,GVR15_S18,GVR16_S18,GVR17_S18,GVR18_S18,GVR19_S18,GVR20_S18,GVR21_S18,GVR22_S18,GVR23_S18,GVR24_S18,GVR25_S18,GVR26_S18,GVR27_S18,GVR28_S18,GVR29_S18,GVR30_S18)
par(mfrow=c(2,1))
plot(Genetic_gain_S18,main="scenario 18",
     xlab="Generations", ylab="Genetic Gain",
     xlim=c(0, 30), ylim=c(0, 5),pch=20)
lines(Genetic_gain_S18)
plot(Genetic_variation_S18,main="scenario 18",
     xlab="Generations", ylab="Genetic Variation",
     xlim=c(0, 30), ylim=c(0, 0.5),pch=20)
lines(Genetic_variation_S18)
library(lattice)
Scenario18<-c(Genetic_gain_S18,Genetic_variation_S18)
write.csv(Scenario18,"Scenario18.csv")
xR_Scenario18<-data.frame(xR1,xR2,xR3,xR4,xR5,xR6,xR7,xR8,xR9,xR10,xR11,xR12,xR13,xR14,xR15,xR16,xR17,xR18,xR19,xR20,xR21,xR22,xR23,xR24,xR25,xR26,xR27,xR28,xR29,xR30)
write.csv(xR_Scenario18,"xR_scenario18.csv")
yR_Scenario18<-data.frame(yR1,yR2,yR3,yR4,yR5,yR6,yR7,yR8,yR9,yR10,yR11,yR12,yR13,yR14,yR15,yR16,yR17,yR18,yR19,yR20,yR21,yR22,yR23,yR24,yR25,yR26,yR27,yR28,yR29,yR30)
write.csv(yR_Scenario18,"yR_scenario18.csv")

